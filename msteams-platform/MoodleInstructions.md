---
title: Microsoft Teams との Moodle の統合をインストールする
description: Microsoft Teams 用の Moodle 統合アプリをインストールして構成する方法
keywords: Teams Moodle app integration plugin
ms.date: 01/31/2019
ms.openlocfilehash: 012d6e9c979386e892b5a47b7655208eca95e11a
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674595"
---
# <a name="installing-the-moodle-integration-with-microsoft-teams"></a><span data-ttu-id="02aa8-104">Microsoft Teams との Moodle の統合をインストールする</span><span class="sxs-lookup"><span data-stu-id="02aa8-104">Installing the Moodle integration with Microsoft Teams</span></span>

> [!VIDEO https://www.youtube.com/embed/OHlPt22nKoE]

<span data-ttu-id="02aa8-105">世界で最も人気の[ある、および](https://moodle.org/)オープンソースの学習管理システム (LMS) は、Microsoft Teams と統合されました。</span><span class="sxs-lookup"><span data-stu-id="02aa8-105">[Moodle](https://moodle.org/), the most popular and open-source Learning Management System (LMS) in the world, is now integrated with Microsoft Teams!</span></span> <span data-ttu-id="02aa8-106">この統合により、教育者や教師が Moodle のコースに関する質問を行ったり、成績や課題について質問したり、Teams 内で通知を更新したりすることができます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-106">This integration helps educators and teachers collaborate around Moodle courses, ask questions about their grades and assignments and stay updated with notifications -- right within Teams!</span></span>

<span data-ttu-id="02aa8-107">IT 管理者がこの統合を簡単に設定できるようにするため、次の機能を使用して、オープンソースの Office 365 Moodle プラグインを更新しました。</span><span class="sxs-lookup"><span data-stu-id="02aa8-107">To help IT admins easily set this integration up, we have updated our open-source Office 365 Moodle Plugin with the following capabilities:</span></span>

* <span data-ttu-id="02aa8-108">Azure AD での Moodle サーバーの自動登録。</span><span class="sxs-lookup"><span data-stu-id="02aa8-108">Auto-registration of your Moodle server with Azure AD.</span></span>
* <span data-ttu-id="02aa8-109">Moodle Assistant bot を Azure に1回クリックして展開します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-109">One-click deployment of your Moodle Assistant bot to Azure.</span></span>
* <span data-ttu-id="02aa8-110">すべてのまたは選択した Moodle のコースに対して、teams の自動プロビジョニングとチーム登録の自動同期を行います。</span><span class="sxs-lookup"><span data-stu-id="02aa8-110">Auto-provisioning of teams and auto-synchronization of team enrollments for all or select Moodle courses.</span></span>
* <span data-ttu-id="02aa8-111">同期された各チームへの Moodle タブと Moodle アシスタントの自動インストール。</span><span class="sxs-lookup"><span data-stu-id="02aa8-111">Auto-installation of the Moodle tab and the Moodle Assistant bot into each synchronized team.</span></span> <span data-ttu-id="02aa8-112">(近日中)</span><span class="sxs-lookup"><span data-stu-id="02aa8-112">(Coming soon)</span></span>
* <span data-ttu-id="02aa8-113">ワンクリックで Moodle アプリをプライベート Teams アプリストアに発行します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-113">One-click publishing of the Moodle app into your private Teams App Store.</span></span> <span data-ttu-id="02aa8-114">(近日中)</span><span class="sxs-lookup"><span data-stu-id="02aa8-114">(Coming soon)</span></span>

<span data-ttu-id="02aa8-115">この統合によって提供される機能の詳細については、[ここ](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02aa8-115">To learn more about the functionality this integration provides, go [here](https://education.microsoft.com/courses-and-resources/resources/microsoft-teams-moodle).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="02aa8-116">前提条件</span><span class="sxs-lookup"><span data-stu-id="02aa8-116">Prerequisites</span></span>

<span data-ttu-id="02aa8-117">このアプリケーションをインストールして構成するには、次のものが必要になります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-117">In order to install and configure this application you'll need:</span></span>

1. <span data-ttu-id="02aa8-118">Moodle 管理者の資格情報</span><span class="sxs-lookup"><span data-stu-id="02aa8-118">Moodle administrator credentials</span></span>
2. <span data-ttu-id="02aa8-119">Azure AD 管理者の資格情報</span><span class="sxs-lookup"><span data-stu-id="02aa8-119">Azure AD administrator credentials</span></span>
3. <span data-ttu-id="02aa8-120">Azure サブスクリプションでは、新しいリソースを作成できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-120">An Azure subscription you can create new resources in</span></span>

## <a name="step-1-install-the-office-365-moodle-plugin"></a><span data-ttu-id="02aa8-121">手順 1: Office 365 Moodle プラグインをインストールする</span><span class="sxs-lookup"><span data-stu-id="02aa8-121">Step 1: Install the Office 365 Moodle Plugin</span></span>

> [!VIDEO https://www.youtube.com/embed/SETEC5nzMgk]

<span data-ttu-id="02aa8-122">Microsoft Teams の Moodle の統合は、オープンソースの[Office 365 Moodle プラグインセット](https://github.com/Microsoft/o365-moodle)によって提供されています。</span><span class="sxs-lookup"><span data-stu-id="02aa8-122">The Moodle integration in Microsoft Teams is powered by the open source [Office 365 Moodle plugin set](https://github.com/Microsoft/o365-moodle).</span></span> <span data-ttu-id="02aa8-123">Moodle サーバーにプラグインをインストールするには、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-123">To install the plugin in your Moodle server:</span></span>

1. <span data-ttu-id="02aa8-124">最初に、 [Office 365 プラグインセット](https://moodle.org/plugins/pluginversions.php?plugin=local_o365)をダウンロードして、ローカルコンピューターに保存します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-124">First, download the [Office 365 plugin set](https://moodle.org/plugins/pluginversions.php?plugin=local_o365) and save it to your local computer.</span></span> <span data-ttu-id="02aa8-125">バージョン3.5 以降を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-125">You'll need to use version 3.5 or newer.</span></span>
    * <span data-ttu-id="02aa8-126">Local_o365 プラグインをインストールすると、 [auth_oidc](https://moodle.org/plugins/auth_oidc)と[boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams)プラグインもインストールされます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-126">Installing the local_o365 plugin will also install the [auth_oidc](https://moodle.org/plugins/auth_oidc) and [boost_o365Teams](https://moodle.org/plugins/pluginversions.php?plugin=theme_boost_o365teams) plugins.</span></span>
1. <span data-ttu-id="02aa8-127">Moodle サーバーに管理者としてログインし、左側のナビゲーションパネルから [**サイトの管理**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-127">Login to your Moodle server as an administrator, and select **Site administration** from the left navigation panel.</span></span>
1. <span data-ttu-id="02aa8-128">[**プラグイン**] タブを選択し、[**プラグインのインストール**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-128">Select the **Plugins** tab, and then click **Install plugins**.</span></span>
1. <span data-ttu-id="02aa8-129">[ **ZIP ファイルからプラグインをインストール**する] セクションで、[**ファイルの選択**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-129">Under the **Install plugin from ZIP file** section click the **Choose a file** button.</span></span>
1. <span data-ttu-id="02aa8-130">左側のナビゲーションから [**ファイルのアップロード**] オプションを選択し、上記の手順でダウンロードしたファイルを参照して、[**このファイルをアップロード**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-130">Select the **Upload a file** options from the left navigation, browse for the file you downloaded above and click **Upload this file**.</span></span>
1. <span data-ttu-id="02aa8-131">左側のナビゲーションパネルからもう一度 [**サイトの管理**] オプションを選択して、管理者ダッシュボードに戻ります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-131">Select the **Site administration** option from the left navigation panel again to return to your admin dashboard.</span></span> <span data-ttu-id="02aa8-132">**ローカルプラグイン**までスクロールし、[ **Microsoft Office 365 統合**] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-132">Scroll down to the **Local plugins** and click the **Microsoft Office 365 Integration** link.</span></span> <span data-ttu-id="02aa8-133">この構成ページは、このプロセスの残りの部分で使用するのと同じように、別のブラウザーのタブで開いたままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-133">Keep this configuration page open in a separate browser tab as you'll be using it throughout the rest of this process.</span></span>

<span data-ttu-id="02aa8-134">Moodle プラグインをインストールする方法の詳細については、 [Moodle のドキュメント](https://docs.moodle.org/34/en/Installing_plugins)を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02aa8-134">You can find more information on how to install Moodle plugins in the [Moodle documentation](https://docs.moodle.org/34/en/Installing_plugins).</span></span>

<span data-ttu-id="02aa8-135">**重要な注意事項:** このプロセス全体を通してこのページセットに戻るように、Office 365 Moodle Plugin 構成ページは別のブラウザータブで開いたままにしておきます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-135">**Important Note:** Keep your Office 365 Moodle Plugin configuration page open in a separate browser tab as you will be returning to this set of pages throughout this process.</span></span>

<span data-ttu-id="02aa8-136">*Moodle サイトを既に持っていない場合*</span><span class="sxs-lookup"><span data-stu-id="02aa8-136">*Don't have a Moodle site already?*</span></span> <span data-ttu-id="02aa8-137">Moodle インスタンスを Azure にすばやく展開して、ニーズに合わせてカスタマイズできる Azure[リポジトリ](https://github.com/azure/moodle)で Moodle を確認することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-137">You might want to check out our Moodle on Azure [repo](https://github.com/azure/moodle) where you can quickly deploy a Moodle instance on Azure and customize it to your needs.</span></span>

## <a name="step-2-configure-the-connection-between-the-office-365-plugin-and-azure-active-directory"></a><span data-ttu-id="02aa8-138">手順 2: Office 365 プラグインと Azure Active Directory との間の接続を構成する</span><span class="sxs-lookup"><span data-stu-id="02aa8-138">Step 2: Configure the connection between the Office 365 plugin and Azure Active Directory</span></span>

> [!VIDEO https://www.youtube.com/embed/FpGEezaJ3SA]

<span data-ttu-id="02aa8-139">次に、Azure Active Directory のアプリケーションとして Moodle を登録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-139">Next you'll need to register Moodle as an application in your Azure Active Directory.</span></span> <span data-ttu-id="02aa8-140">このプロセスを完了するために役立つ PowerShell スクリプトが提供されています。</span><span class="sxs-lookup"><span data-stu-id="02aa8-140">We've provided a PowerShell script to help you complete this process.</span></span> <span data-ttu-id="02aa8-141">PowerShell スクリプトは、office 365 Moodle プラグインによって使用される Office 365 テナント用に新しい Azure AD アプリケーションをプロビジョニングします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-141">The PowerShell Script provisions a new Azure AD application for your Office 365 tenant, which will be used by the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="02aa8-142">このスクリプトは、O365 テナント用のアプリを準備し、プロビジョニングされたアプリに必要な応答 Url とアクセス許可をすべて設定し、AppID とキーを返します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-142">The script will provision the app for your O365 tenant, set up all the required Reply URLs and Permissions for the provisioned app and return the AppID and Key.</span></span> <span data-ttu-id="02aa8-143">O365 Moodle Plugin セットアップページで生成された AppID とキーを使用して、Moodle サーバーを Azure AD で構成できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-143">You can use the generated AppID and Key in your O365 Moodle Plugin Setup Page to configure your Moodle server with Azure AD.</span></span> <span data-ttu-id="02aa8-144">PowerShell スクリプトによって自動化される詳細な手動手順については、「[プラグインの](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application)完全なドキュメント」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="02aa8-144">If you want to see the detailed manual steps that the PowerShell script is automating, you can find them in the full [documentation for the plugin](https://docs.moodle.org/34/en/Office365#Register_your_Moodle_instance_as_an_Application).</span></span>

### <a name="moodle-tab-for-microsoft-teams-information-flow"></a><span data-ttu-id="02aa8-145">Microsoft Teams の情報フローの Moodle タブ</span><span class="sxs-lookup"><span data-stu-id="02aa8-145">Moodle tab for Microsoft Teams information flow</span></span>

<img width="530px" src="~/assets/images/MoodleTabInformationFlow.png" title="Microsoft Teams の情報フローの Moodle タブ" />

1. <span data-ttu-id="02aa8-147">[Microsoft Office 365 Integration plugin] ページで、[**セットアップ**] タブを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-147">From the Microsoft Office 365 Integration plugin page select the **Setup** tab.</span></span>
1. <span data-ttu-id="02aa8-148">[ **PowerShell スクリプトをダウンロード**] ボタンをクリックして、ローカルコンピューターに保存します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-148">Click the **Download PowerShell Script** button and save it to your local computer.</span></span>
1. <span data-ttu-id="02aa8-149">この ZIP ファイルから PowerShell スクリプトを準備する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-149">You'll need to prepare the PowerShell script from the ZIP file.</span></span> <span data-ttu-id="02aa8-150">これを行うには、以下のようにします:</span><span class="sxs-lookup"><span data-stu-id="02aa8-150">To do so:</span></span>
    * <span data-ttu-id="02aa8-151">ファイルを`Moodle-AzureAD-Powershell.zip`ダウンロードして展開します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-151">Download and extract the `Moodle-AzureAD-Powershell.zip` file.</span></span>
    * <span data-ttu-id="02aa8-152">抽出したフォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-152">Open the extracted folder.</span></span>
    * <span data-ttu-id="02aa8-153">`Moodle-AzureAD-Script.ps1`ファイルを右クリックし、[**プロパティ**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-153">Right-click on the `Moodle-AzureAD-Script.ps1` file and select **Properties**.</span></span>
    * <span data-ttu-id="02aa8-154">[プロパティ] ウィンドウの [**全般**] タブで、 `Unblock`下部にある [ **Security** ] 属性の横のチェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-154">Under the **General** tab of the Properties window, check the `Unblock` box next to the **Security** attribute at the bottom.</span></span>
    * <span data-ttu-id="02aa8-155">**[OK]** をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-155">Click **OK**.</span></span>
    * <span data-ttu-id="02aa8-156">抽出したフォルダーのディレクトリパスをコピーします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-156">Copy the directory path of the extracted folder.</span></span>
1. <span data-ttu-id="02aa8-157">次に、PowerShell を管理者として実行します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-157">Next you'll run PowerShell as an administrator:</span></span>
    * <span data-ttu-id="02aa8-158">[開始] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-158">Click Start.</span></span>
    * <span data-ttu-id="02aa8-159">PowerShell と入力します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-159">Type PowerShell.</span></span>
    * <span data-ttu-id="02aa8-160">[Windows PowerShell] を右クリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-160">Right-click Windows PowerShell.</span></span>
    * <span data-ttu-id="02aa8-161">[管理者として実行] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-161">Click "Run as Administrator".</span></span>
1. <span data-ttu-id="02aa8-162">フォルダーへのパスを入力`cd ...\...\Moodle-AzureAD-Powershell` `...\...`して、解凍後のディレクトリに移動します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-162">Navigate to the unzipped directory by typing `cd ...\...\Moodle-AzureAD-Powershell` where `...\...` is the path to the directory.</span></span>
1. <span data-ttu-id="02aa8-163">次の方法で PowerShell スクリプトを実行します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-163">Execute the PowerShell script by:</span></span>
    * <span data-ttu-id="02aa8-164">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`キーを押します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-164">Enter `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`.</span></span>
    * <span data-ttu-id="02aa8-165">Enter `.\Moodle-AzureAD-Script.ps1`キーを押します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-165">Enter `.\Moodle-AzureAD-Script.ps1`.</span></span>
    * <span data-ttu-id="02aa8-166">ポップアップウィンドウで、O365 管理者アカウントにログインします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-166">Login to your O365 Administrator account in the pop-up window.</span></span>
    * <span data-ttu-id="02aa8-167">Azure AD アプリケーションの名前を入力します (例、</span><span class="sxs-lookup"><span data-stu-id="02aa8-167">Enter the name of the Azure AD Application (Ex.</span></span> <span data-ttu-id="02aa8-168">Moodle/Moodle プラグイン)。</span><span class="sxs-lookup"><span data-stu-id="02aa8-168">Moodle/Moodle plugin).</span></span>
    * <span data-ttu-id="02aa8-169">Moodle サーバーの URL を入力します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-169">Enter the URL of your Moodle server.</span></span>
    * <span data-ttu-id="02aa8-170">スクリプトによって生成された**アプリケーション ID**と**アプリケーションキー**をコピーして保存します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-170">Copy the **Application ID** and **Application Key** generated by the script and save them.</span></span>
1. <span data-ttu-id="02aa8-171">次に、Office 365 Moodle プラグインに Id とキーを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-171">Next you'll need to add the Id and Key to the Office 365 Moodle Plugin.</span></span> <span data-ttu-id="02aa8-172">[プラグインの管理] ページ ([サイトの管理 > プラグイン > Microsoft Office 365 統合) に戻ります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-172">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration).</span></span>
1. <span data-ttu-id="02aa8-173">[**セットアップ**] タブで、先ほどコピーした**アプリケーション Id**と**アプリケーションキー**を追加し、[**変更の保存**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-173">On the **Setup** tab add the **Application Id** and **Application Key** you copied previously, then click **Save changes**.</span></span>
1. <span data-ttu-id="02aa8-174">ページが更新されると、 **[connection メソッドの選択**] という新しいセクションが表示されるようになります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-174">Once the page refreshes you should now see a new section **Choose connection method**.</span></span> <span data-ttu-id="02aa8-175">[**既定**] のチェックボックスをオンにし、[**変更の保存**] をもう一度クリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-175">Click the checkbox labeled **Default** and then click **Save changes** again.</span></span>
1. <span data-ttu-id="02aa8-176">ページが更新されると、[管理者の同意] という別の新しいセクションが**追加情報 &** 表示されます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-176">Once the page refreshes you will see another new section **Admin consent & additional information**.</span></span>
    * <span data-ttu-id="02aa8-177">[**管理者の同意を提供**する] リンクをクリックして、Office3 365 のグローバル管理者の資格情報を入力し、**同意**してアクセス許可を付与します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-177">Click the **Provide Admin Consent** link, enter your Office3 365 Global Administrator credentials, then **Accept** to grant the permissions.</span></span>
    * <span data-ttu-id="02aa8-178">[ **AZURE AD テナント**] フィールドの横にある [**検出**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-178">Next to the **Azure AD Tenant** field click the **Detect** button.</span></span>
    * <span data-ttu-id="02aa8-179">[ **OneDrive For business の URL** ] の横にある [**検出**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-179">Next to the **OneDrive for Business URL** click the **Detect** button.</span></span>
    * <span data-ttu-id="02aa8-180">フィールドが読み込まれたら、[**変更の保存**] ボタンをもう一度クリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-180">Once the fields populate, click the **Save changes** button again.</span></span>
1. <span data-ttu-id="02aa8-181">[**更新**] ボタンをクリックしてインストールを確認し、**変更を保存**します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-181">Click the **Update** button to verify the installation, then **Save changes**.</span></span>
1. <span data-ttu-id="02aa8-182">次に、Moodle サーバーと Azure Active Directory の間でユーザーを同期する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-182">Next you'll need to synchronize users between your Moodle server and Azure Active Directory.</span></span> <span data-ttu-id="02aa8-183">ご使用の環境によっては、この段階でさまざまなオプションを選択できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-183">Depending on your environment, you may select different options during this stage.</span></span> <span data-ttu-id="02aa8-184">ここで設定した構成は、各 Moodle cron 実行 (通常は1日に1回) によって実行され、すべてが同期状態に保たれることに注意してください。まず、次のようにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-184">Note that the configuration you set here will run with each Moodle cron run (typically once a day) to keep everything in sync. To get started:</span></span>
    * <span data-ttu-id="02aa8-185">[同期の**設定] タブ**に切り替える</span><span class="sxs-lookup"><span data-stu-id="02aa8-185">Switch to the **Sync Settings tab**</span></span>
    * <span data-ttu-id="02aa8-186">[ **AZURE AD とのユーザーの同期**] セクションで、環境に適用するチェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-186">In the **Sync users with Azure AD** section, select the checkboxes that apply to your environment.</span></span> <span data-ttu-id="02aa8-187">通常は、少なくとも次のものを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-187">Typically you would select at least:</span></span>
        * <span data-ttu-id="02aa8-188">Azure AD のユーザー用に Moodle でアカウントを作成する</span><span class="sxs-lookup"><span data-stu-id="02aa8-188">Create accounts in Moodle for users in Azure AD</span></span>
        * <span data-ttu-id="02aa8-189">Azure AD のユーザー用に Moodle のすべてのアカウントを更新する</span><span class="sxs-lookup"><span data-stu-id="02aa8-189">Update all accounts in Moodle for users in Azure AD</span></span>
    * <span data-ttu-id="02aa8-190">[**ユーザーの作成の制限**] セクションでは、Moodle に同期することによって Azure AD ユーザーを制限するためのフィルターを設定できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-190">In the **User Creation Restriction** section you can setup a filter to limit the Azure AD users that will by synced to Moodle.</span></span>
    * <span data-ttu-id="02aa8-191">[**ユーザーフィールドマッピング**] セクションでは、Azure AD を Moodle のユーザープロファイルフィールドマッピングにカスタマイズできます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-191">The **User Field Mapping** section will allow you to customize the Azure AD to Moodle User Profile field mapping.</span></span>
    * <span data-ttu-id="02aa8-192">[ **Teams Sync** ] セクションでは、既存の Moodle コースの一部または全部に対してグループ (Teams) を自動的に作成することを選択できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-192">In the **Teams Sync** section you can choose to automatically create Groups (i.e. Teams) for some, or all, of your existing Moodle courses.</span></span>
1. <span data-ttu-id="02aa8-193">Cron ジョブを検証する (初回実行時に必要に応じて手動で実行する場合) には、[**ユーザーを AZURE AD と同期**する] セクションの [**タスク管理ページ**] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-193">To validate the cron jobs (and run them manually if you wish to for the first run) click the **Scheduled tasks management page** link in the **Sync users with Azure AD** section.</span></span> <span data-ttu-id="02aa8-194">これにより、[**タスクのスケジュール**] ページに移動します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-194">This will take you to the **Scheduled Tasks** page.</span></span>
    * <span data-ttu-id="02aa8-195">下にスクロールして、[ **AZURE AD ジョブを使用**してユーザーを同期します] ジョブを見つけ、[**今すぐ実行**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-195">Scroll down and find the job **Sync users with Azure AD** job and click **Run now**.</span></span>
    * <span data-ttu-id="02aa8-196">既存のコースに基づいてグループを作成することを選択した場合は、 **Office 365 ジョブで [ユーザーグループの作成**] を実行することもできます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-196">If you chose to create Groups based on existing courses, you can also run the **Create user groups in Office 365** job.</span></span>
1. <span data-ttu-id="02aa8-197">[プラグインの管理] ページ ([サイトの管理 > プラグイン > Microsoft Office 365 統合]) に戻り、[ **Teams の設定**] ページを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-197">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** page.</span></span> <span data-ttu-id="02aa8-198">Teams アプリの統合を有効にするには、いくつかのセキュリティ設定を構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-198">You'll need to configure some security settings to enable the Teams app integration.</span></span>
    * <span data-ttu-id="02aa8-199">OpenID Connect を有効にするには、[**認証の管理**] リンクをクリックして、 **openid connect**行が淡色で設定されている場合は、[目] アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-199">To enable OpenID Connect, click the **Manage Authentication** link, and click the eye icon on the **OpenId Connect** line if it is greyed out.</span></span>
    * <span data-ttu-id="02aa8-200">次に、フレームの埋め込みを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-200">Next you'll need to enable frame embedding.</span></span> <span data-ttu-id="02aa8-201">[ **HTTP セキュリティ**] リンクをクリックして、[**フレームの埋め込みを許可**する] の横にあるチェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-201">Click the **HTTP Security** link, then click the checkbox next to **Allow frame embedding**.</span></span>
    * <span data-ttu-id="02aa8-202">次の手順では、Moodle API の機能を有効にする web サービスを有効にします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-202">The next step is to enable web services which will enable the Moodle API features.</span></span> <span data-ttu-id="02aa8-203">[**高度な機能**] リンクをクリックし、[ **Web サービスを有効**にする] の横にあるチェックボックスがオンになっていることを確認します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-203">Click the **Advanced Features** link, then make sure the checkbox next to **Enable web services** is checked.</span></span>
    * <span data-ttu-id="02aa8-204">最後に、Office 365 の外部サービスを有効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-204">Finally you'll need to enabled the external services for Office 365.</span></span> <span data-ttu-id="02aa8-205">[**外部サービス**] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-205">Click the **External services** link then:</span></span>
        * <span data-ttu-id="02aa8-206">**Moodle Office 365**の [アプリケーション] 行の [**編集**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-206">Click **Edit** on the **Moodle Office 365 Webservices** row.</span></span>
        * <span data-ttu-id="02aa8-207">チェックボックスに [**有効**] をマークし、[**変更の保存**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-207">Mark the checkbox next to **Enabled**, then click **Save Changes**</span></span>
    * <span data-ttu-id="02aa8-208">次に、認証済みユーザーのアクセス許可を編集して、web サービストークンを作成できるようにする必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-208">Next you'll need to edit your authenticated user permissions to allow them to create web service tokens.</span></span> <span data-ttu-id="02aa8-209">[**役割の認証済みユーザーの編集**] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-209">Click the **Editing role 'Authenticated user'** link.</span></span> <span data-ttu-id="02aa8-210">下にスクロールして [ **web サービストークンの作成**] 機能を見つけ、[**許可**] チェックボックスをオンにします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-210">Scroll down and find the **Create a web service token** capability and mark the **Allow** checkbox.</span></span>

## <a name="step-3-deploy-the-moodle-assistant-bot-to-azure"></a><span data-ttu-id="02aa8-211">手順 3: Moodle Assistant Bot を Azure に展開する</span><span class="sxs-lookup"><span data-stu-id="02aa8-211">Step 3: Deploy the Moodle Assistant Bot to Azure</span></span>

> [!VIDEO https://www.youtube.com/embed/gbkJxf8FlfY]

<span data-ttu-id="02aa8-212">Microsoft Teams 用の無料の Moodle アシスタント Bot は、教師や学生が Moodle のコース、課題、成績、その他の情報についての質問に答える際に役立てることができます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-212">The free Moodle Assistant Bot for Microsoft Teams helps teachers and students answer questions about their courses, assignments, grades and other information in Moodle.</span></span> <span data-ttu-id="02aa8-213">Bot は、Teams 内で Moodle 通知を学生と教師にも送信します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-213">The bot also sends Moodle notifications to students and teachers right within Teams.</span></span> <span data-ttu-id="02aa8-214">この bot は、Microsoft によって管理されているオープンソースプロジェクトであり、 [GitHub で利用でき](https://github.com/microsoft/Moodle-Teams-Bot)ます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-214">This bot is an open source project maintained by Microsoft, and is [available on GitHub](https://github.com/microsoft/Moodle-Teams-Bot).</span></span>

> [!NOTE]
> <span data-ttu-id="02aa8-215">このセクションでは、Azure サブスクリプションにリソースを展開し、すべてのリソースを**free**層を使用して構成します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-215">In this section you will deploy resources to your Azure subscription, and all resources will be configured using the **free** tier.</span></span> <span data-ttu-id="02aa8-216">Bot の使用状況によっては、これらのリソースを拡張する必要がある場合があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-216">Depending on the usage of your bot, you may need to scale these resources.</span></span>
> <span data-ttu-id="02aa8-217">Bot を使用せずに Moodle タブのみを使用する場合は、[手順 4](#step-4-deploy-your-microsoft-teams-app)に進みます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-217">If you want to just use the Moodle tab without the bot, skip to [step 4](#step-4-deploy-your-microsoft-teams-app).</span></span>

### <a name="moodle-bot-information-flow"></a><span data-ttu-id="02aa8-218">Moodle bot 情報フロー</span><span class="sxs-lookup"><span data-stu-id="02aa8-218">Moodle bot information flow</span></span>

<img width="530px" src="~/assets/images/MoodleBotInformationFlow.png" title="Moodle bot for Microsoft Teams 情報フロー" />

<span data-ttu-id="02aa8-220">Bot をインストールするには、最初に[Microsoft Identity Platform](https://identity.microsoft.com/Landing)に登録する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-220">To install the bot, you'll first need to register it on the [Microsoft Identity Platform](https://identity.microsoft.com/Landing).</span></span> <span data-ttu-id="02aa8-221">これにより、ボットは Microsoft エンドポイントに対して認証を受けることができます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-221">This allows your Bot to authenticate against your Microsoft endpoints.</span></span> <span data-ttu-id="02aa8-222">Bot を登録するには</span><span class="sxs-lookup"><span data-stu-id="02aa8-222">To register your bot:</span></span>

1. <span data-ttu-id="02aa8-223">[プラグインの管理] ページ ([サイトの管理 > プラグイン > Microsoft Office 365 統合]) に戻り、[ **Teams の設定**] タブを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-223">Return to the plugin administration page (Site administration > Plugins > Microsoft Office 365 Integration) and select the **Teams Settings** tab.</span></span>
1. <span data-ttu-id="02aa8-224">**Microsoft アプリケーション登録ポータル**のリンクをクリックして、microsoft Id でログインします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-224">Click the **Microsoft Application Registration Portal** link and login with your Microsoft Id.</span></span>
1. <span data-ttu-id="02aa8-225">アプリの名前を入力します (例:</span><span class="sxs-lookup"><span data-stu-id="02aa8-225">Enter a name for your app (Eg.</span></span> <span data-ttu-id="02aa8-226">MoodleBot) をクリックし、[**作成**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-226">MoodleBot) and click the **Create** button.</span></span>
1. <span data-ttu-id="02aa8-227">**アプリケーション id**をコピーして、[**チーム設定**] ページの [ **Bot アプリケーション id** ] フィールドに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-227">Copy the **Application Id** and paste it into the **Bot Application ID** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="02aa8-228">[**新しいパスワードの生成**] ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-228">Click the **Generate New Password** button.</span></span> <span data-ttu-id="02aa8-229">生成されたパスワードをコピーして、[**チーム設定**] ページの [ **Bot アプリケーションパスワード**] フィールドに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-229">Copy the generated password and and paste it into the **Bot Application Password** field on the **Team Settings** page.</span></span>
1. <span data-ttu-id="02aa8-230">フォームの一番下までスクロールし、[**変更の保存**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-230">Scroll to the bottom of the form and click **Save Changes**.</span></span>

<span data-ttu-id="02aa8-231">アプリケーション Id とパスワードが生成されたので、ボットを Azure に展開します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-231">Now that you've generated your Application Id and Password, it's time to deploy your bot to Azure.</span></span> <span data-ttu-id="02aa8-232">[ **Azure に展開する**] ボタンをクリックして、フォームに必要な情報 (Bot アプリケーション Id、Bot アプリケーションパスワード、および Moodle シークレットが [**チーム設定**] ページにあり、Azure information が [**セットアップ**] ページにあります) を入力します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-232">Click on the **Deploy to Azure** button and fill out the form with the necessary information (the Bot Application Id, Bot Application Password and the Moodle Secret are on the **Team Settings** page, and the Azure information is on the **Setup** page).</span></span> <span data-ttu-id="02aa8-233">フォームに入力したら、使用条件に同意するには、チェックボックスをクリックして、[**購入**] ボタンをクリックします (すべての Azure リソースは free 層に展開されます)。</span><span class="sxs-lookup"><span data-stu-id="02aa8-233">Once you've got the form filled out, click the check box to agree to the terms and conditions then click the **Purchase** button (all Azure resources are deployed to the free tier).</span></span>

<span data-ttu-id="02aa8-234">Azure へのリソースの展開が終了したら、そのメッセージングエンドポイントを使用して Office 365 Moodle プラグインを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-234">Once the resources are finished deploying to Azure, you'll need to configure the Office 365 Moodle plugin with it's messaging endpoint.</span></span> <span data-ttu-id="02aa8-235">最初に、Azure の Bot からエンドポイントを取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-235">First, you'll need to get the endpoint from you Bot in Azure.</span></span> <span data-ttu-id="02aa8-236">そのためには、次の操作を行います。</span><span class="sxs-lookup"><span data-stu-id="02aa8-236">To do that:</span></span>

1. <span data-ttu-id="02aa8-237">まだサインインしていない場合は、 [Azure portal](https://portal.azure.com)にログインします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-237">If you aren't already, log into the [Azure portal](https://portal.azure.com).</span></span>
2. <span data-ttu-id="02aa8-238">左側のウィンドウで、[**リソースグループ**] を選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-238">In the left pane select **Resource groups**.</span></span>
3. <span data-ttu-id="02aa8-239">リストから、Bot を展開するときに使用した (または作成した) リソースグループを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-239">From the list select the resource group you just used (or created) while deploying your Bot.</span></span>
4. <span data-ttu-id="02aa8-240">グループ内のリソースのリストから**WebApp Bot**リソースを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-240">Select the **WebApp Bot** resource from the list of resources in the group.</span></span>
5. <span data-ttu-id="02aa8-241">[**概要**] セクションから**メッセージングエンドポイント**をコピーします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-241">Copy the **Messaging Endpoint** from the **Overview** section.</span></span>
6. <span data-ttu-id="02aa8-242">Moodle で、Office 365 Moodle プラグインの [**チーム設定**] ページを開きます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-242">In Moodle, open the **Team Settings** page of your Office 365 Moodle Plugin.</span></span>
7. <span data-ttu-id="02aa8-243">**Bot エンドポイント**フィールドにコピーした URL を貼り付け、word*メッセージ*を*webhook*に変更します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-243">In the **Bot Endpoint** field paste the URL you just copied and change the word *messages* to *webhook*.</span></span> <span data-ttu-id="02aa8-244">URL は次のようになります。`https://botname.azurewebsites.net/api/webhook`</span><span class="sxs-lookup"><span data-stu-id="02aa8-244">The URL should now look like `https://botname.azurewebsites.net/api/webhook`</span></span>
8. <span data-ttu-id="02aa8-245">[**変更の保存**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-245">Click **Save Changes**</span></span>
9. <span data-ttu-id="02aa8-246">変更を保存したら、[**チームの設定**] タブに戻り、[**マニフェストファイルのダウンロード**] ボタンをクリックして、マニフェストパッケージをコンピューターに保存します (次のセクションで使用します)。</span><span class="sxs-lookup"><span data-stu-id="02aa8-246">Once your changes have saved, go back to the **Team Settings** tab, click the **Download manifest file** button and save the manifest package to your computer (you'll use it in the next section).</span></span>

## <a name="step-4-deploy-your-microsoft-teams-app"></a><span data-ttu-id="02aa8-247">手順 4: Microsoft Teams アプリを展開する</span><span class="sxs-lookup"><span data-stu-id="02aa8-247">Step 4: Deploy your Microsoft Teams app</span></span>

> [!VIDEO https://www.youtube.com/embed/2rMb7gtM_ZM]

<span data-ttu-id="02aa8-248">Bot を Azure に展開して、Moodle サーバーと通信するように構成したので、今度は Microsoft Teams アプリを展開します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-248">Now that you have your Bot deployed to Azure and configured to talk to your Moodle server, it's time to deploy your Microsoft Teams app.</span></span> <span data-ttu-id="02aa8-249">これを行うには、前の手順の「Office 365 Moodle Plugin Team Settings」ページからダウンロードしたマニフェストファイルを読み込みます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-249">To do this you'll load the manifest file you downloaded from the Office 365 Moodle Plugin Team Settings page in the previous step.</span></span>

<span data-ttu-id="02aa8-250">アプリをインストールする前に、外部アプリとアプリのアップロードが有効になっていることを確認する必要があります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-250">Before you can install the app you'll need to make sure external apps and uploading of apps is enabled.</span></span> <span data-ttu-id="02aa8-251">そのためには、次[の手順](https://docs.microsoft.com/microsoftteams/platform/get-started/get-started-tenant)を実行します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-251">To do so you can follow [these steps](https://docs.microsoft.com/microsoftteams/platform/get-started/get-started-tenant).</span></span> <span data-ttu-id="02aa8-252">外部アプリが有効になっていることを確認したら、次の手順に従ってアプリを展開できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-252">Once you've ensured that external apps are enabled, you can follow the steps below to deploy your app.</span></span>

1. <span data-ttu-id="02aa8-253">Microsoft Teams を開きます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-253">Open Microsoft Teams.</span></span>
2. <span data-ttu-id="02aa8-254">ナビゲーションバーの左下にある [**ストア**] アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-254">Click the **Store** icon on the lower-left of the navigation bar.</span></span>
3. <span data-ttu-id="02aa8-255">オプションの一覧から [**カスタムアプリのアップロード**] リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-255">Click the **Upload a custom app** link from the list of options.</span></span> <span data-ttu-id="02aa8-256">*注:* グローバル管理者としてログインしている場合は、組織のアプリストアにアプリをアップロードするオプションがあります。そうしないと、自分がメンバーになっているチームに対してのみアプリを読み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-256">*Note:* If you're logged in as a global administer you'll have the option of uploading the app to your organization's app store, otherwise you'll only be able to load the app for a team of which you are a member.</span></span>
4. <span data-ttu-id="02aa8-257">以前に`manifest.zip`ダウンロードしたパッケージを選択し、[**保存**] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="02aa8-257">Select the `manifest.zip` package you downloaded previously and click **Save**.</span></span> <span data-ttu-id="02aa8-258">マニフェストパッケージをまだダウンロードしていない場合は、Moodle の [プラグインの構成] ページの [**チームの設定**] タブから実行できます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-258">If you haven't yet downloaded the manifest package, you can do so from the **Team Settings** tab of the plugin configuration page in Moodle.</span></span>

<span data-ttu-id="02aa8-259">これで、アプリがインストールされました。これで、アクセスできるチャネルにタブを追加することができます。</span><span class="sxs-lookup"><span data-stu-id="02aa8-259">Now that you have the app installed you can add the tab to any channel that you have access to.</span></span> <span data-ttu-id="02aa8-260">これを行うには、チャネルに移動し**+** 、シンボルをクリックして、リストからアプリを選択します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-260">To do so navigate to the channel, click the **+** symbol and select your app from the list.</span></span> <span data-ttu-id="02aa8-261">画面に表示される指示に従って、チャネルへの Moodle コースタブの追加を完了します。</span><span class="sxs-lookup"><span data-stu-id="02aa8-261">Follow the prompts to finish adding your Moodle course tab to a channel.</span></span>

<span data-ttu-id="02aa8-262">するだけです。</span><span class="sxs-lookup"><span data-stu-id="02aa8-262">That's it!</span></span> <span data-ttu-id="02aa8-263">お客様とチームは、Microsoft Teams から直接 Moodle コースで作業を開始できるようになります。</span><span class="sxs-lookup"><span data-stu-id="02aa8-263">You and your team, can now start working with your Moodle courses directly from Microsoft Teams.</span></span>

<span data-ttu-id="02aa8-264">機能の要求やフィードバックをお客様と共有するには、[ユーザーの音声ページ](https://microsoftteams.uservoice.com/forums/916759-moodle)にアクセスしてください。</span><span class="sxs-lookup"><span data-stu-id="02aa8-264">To share any feature requests or feedback with us, please visit our [User Voice page](https://microsoftteams.uservoice.com/forums/916759-moodle).</span></span>
