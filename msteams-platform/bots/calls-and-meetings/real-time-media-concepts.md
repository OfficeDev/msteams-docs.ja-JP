---
title: Microsoft Teams とのリアルタイムのメディア通話とオンライン会議
description: リアルタイムの音声およびビデオ通話やオンライン会議を行うボットを構築する上での重要な概念を理解します。
ms.topic: conceptual
localization_priority: Normal
keywords: オーディオ ストリーム ビデオ ストリーム オーディオ/ビデオ通話会議リアルタイム メディア アプリケーションホスト型メディア サービスホスト型メディア
ms.openlocfilehash: deedc47f67fe6848cf7f84457247d2271257e3f0
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020156"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a>Microsoft Teams とのリアルタイムのメディア通話と会議

リアルタイム メディア プラットフォームを使用すると、ボットはリアルタイムの音声、ビデオ、画面共有を使用して Microsoft Teams の通話や会議を操作できます。 これは、ボットが音声およびビデオ コンテンツ フレームをフレーム別に送受信できる高度な機能です。 ボットは、音声、ビデオ、および画面共有メディア ストリームへの生のアクセス権を持っています。 すべてのメディア処理に対してリアルタイム メディア プラットフォームに依存する、サービスホスト型メディア ボットが簡単です。 メディア自体を処理するボットは、アプリケーションホスト型メディア ボットと呼ばれる。

たとえば、ボットを使用した 1:1 の呼び出しでは、ユーザーが話す通り、ボットは 1 秒あたり 50 のオーディオ フレームを受信し、各フレームには 20 ミリ秒 (ms) のオーディオが含まれる。 アプリケーションホスト型メディア ボットは、音声フレームの受信時にリアルタイムの音声認識を実行できます。ユーザーが話し始めた後に録音を待つ必要が生じなくなった場合。 ボットは、ビデオ ベースの画面共有コンテンツを含む高解像度ビデオを送受信できます。

プラットフォームは、ボットがメディアを送受信する単純なソケットのような API を提供します。 オーディオ用の SILK や G.722、ビデオ用 H.264 などのコーデックを使用して、オーディオまたはビデオ パケットのリアルタイム エンコードとデコードを処理します。 プラットフォームでは、すべてのメディア パケットの暗号化または復号化、およびパケット ネットワークの送信も自動的に処理されます。 ボットは、実際のオーディオまたはビデオ コンテンツにのみ関係します。 リアルタイムのメディア ボットは、1:1 の呼び出しと複数の参加者との会議に参加します。

## <a name="media-session"></a>メディア セッション

リアルタイム メディア ボットが着信呼び出しに応答するか、Teams 会議に参加する場合、サポートする必要があるモダリティを宣言する必要があります。 サポートされているモダリティごとに、ボットはメディアの送受信、受信のみ、または送信のみ可能かどうかを宣言します。 たとえば、1:1 Teams 呼び出しを処理するように設計されたボットでは、音声の送受信の両方が必要ですが、呼び出し元のビデオを受信する必要はなさらないのでビデオのみを送信します。 ボットと Teams の発信者または会議の間に確立された一連の音声およびビデオモダリティは、メディア セッションと呼ばれる。

メイン ビデオとビデオ ベースの画面共有という 2 種類のビデオ モダリティがサポートされています。 メイン ビデオは、ユーザーの Web カメラからビデオを転送するために使用されます。 ビデオ ベースの画面共有を使用すると、ユーザーは自分の画面をビデオ ストリームとして共有できます。 このプラットフォームを使用すると、ボットは両方の種類のビデオを送受信できます。

Teams 会議に参加すると、ボットはメディア セッションごとに最大 10 個までの複数のメイン ビデオ ストリームを同時に受信できます。 これにより、ボットは会議に複数の参加者を表示できます。

次のセクションでは、一連のフレームとしてメディアを送受信するボットの詳細について説明します。

## <a name="frames-and-frame-rate"></a>フレームとフレーム レート

リアルタイム メディア ボットは、メディア セッションのオーディオモダリティとビデオ モダリティを直接操作します。 つまり、ボットは一連のフレームとしてメディアを送受信しています。各フレームはコンテンツの単位を表します。 オーディオの 1 秒は 50 フレームのシーケンスとして送信され、各フレームには 1 秒の音声コンテンツの 1/50 分の 1 である 20 ミリ秒が含まれる。 ビデオの 1 秒は 30 の画像のシーケンスとして送信され、それぞれが次のビデオ フレームが表示される前に 1/30 秒の 33.3 ミリ秒だけ表示される予定です。 1 秒あたりに送信またはレンダリングされるフレームの数をフレーム レートと呼ぶ。

次のセクションでは、リアルタイムのメディア通話と会議で使用されるオーディオとビデオの形式の詳細について説明します。

## <a name="audio-and-video-format"></a>オーディオとビデオの形式

オーディオ形式では、オーディオの各秒は 16,000 サンプルとして表され、各サンプルには 16 ビットのデータが含まれています。 20 ミリ秒のオーディオ フレームには、640 バイトのデータである 320 サンプルが含まれます。

ビデオ形式では、複数の形式がサポートされています。 ビデオ形式の 2 つの主要なプロパティは、そのフレーム サイズと色の形式です。 サポートされるフレーム サイズには、360 ピクセルの 640x360、720 ピクセルの 1280x720、1920x1080 (1080 ピクセル) が含まれます。 サポートされるカラー形式には、1 ピクセルあたり 12 ビットの NV12 と、1 ピクセルあたり 24 ビットの RGB24 が含まれます。

720p ビデオ フレームには、1280 回 720 の 921,600 ピクセルが含まれています。 RGB24 カラー形式では、各ピクセルは 3 バイトとして表され、各ピクセルは、赤、緑、青の各色コンポーネントの 1 バイトで構成される 24 ビットです。 したがって、1 つの 720p RGB24 ビデオ フレームには、1 ピクセルあたり 921,600 ピクセルの 3 バイトの 2,764,800 バイトのデータが必要です。 フレーム レートが 30 fps の場合、720p RGB24 ビデオ フレームを送信すると、約 80 MB/秒のコンテンツが処理され、ネットワーク伝送前に H.264 ビデオ コーデックによって実質的に圧縮されます。

プラットフォームの高度な機能により、ボットはエンコードされた H.264 フレームとしてビデオを送受信できます。 これは、独自の H.264 エンコーダーまたはデコーダーを提供するボット、または RAW RGB24 または NV12 ビットマップにデコードされたビデオ ストリームを必要としないボットをサポートします。

次のセクションでは、どの会議参加者が話しているのか、どの会議参加者がアクティブで優勢なスピーカーかについて詳しくは説明します。

## <a name="active-and-dominant-speakers"></a>アクティブスピーカーとドミナント スピーカー

複数の参加者で構成される Teams 会議に参加すると、ボットはどの会議参加者が現在話しているのか識別できます。 アクティブなスピーカーは、受信した各オーディオ フレームで聞こえる参加者を識別します。 主要なスピーカーは、すべてのオーディオ フレームで音声が聞こえない場合でも、グループ会話で現在最もアクティブまたは支配的な参加者を識別します。 参加者が交代で話すので、一連の優勢なスピーカーが変わる可能性があります。

次のセクションでは、ボットによって行われたビデオ サブスクリプション要求の詳細を示します。

## <a name="video-subscription"></a>ビデオサブスクリプション

1:1 呼び出しでは、ボットがビデオの受信を有効にしている場合、ボットは発信者のビデオを自動的に受信します。 Teams 会議では、ボットはプラットフォームに対して、表示する参加者を示す必要があります。 ビデオ サブスクリプションは、ボットが参加者のメイン ビデオまたは画面共有コンテンツを受信する要求です。 会議の参加者が会話を行う中で、ボットは、主要なスピーカー セットの更新や、現在画面共有中の参加者を示す通知に基づいて、目的のビデオ サブスクリプションを変更します。

次のセクションでは、インストールする必要がある内容と、アプリケーションホスト型メディア ボットを開発する要件の詳細について説明します。

## <a name="developer-resources"></a>開発者向けリソース

アプリケーションホスト型メディア ボットを開発するには [、Microsoft.Graph.Calls.Media .NET](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) ライブラリ NuGet パッケージをプロジェクト内にインストールVisual Studioがあります。

アプリケーションホスト型メディア ボットには、.NET または windows Server C#が必要です。 詳細については、「アプリケーションホスト型メディア ボットの要件と考慮事項 [」を参照してください](requirements-considerations-application-hosted-media-bots.md#c-or-net-and-windows-server-for-development)。

## <a name="next-step"></a>次の手順

> [!div class="nextstepaction"]
> [通話ボットを登録する](~/bots/calls-and-meetings/registering-calling-bot.md)
