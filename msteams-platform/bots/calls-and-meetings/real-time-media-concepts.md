---
title: Microsoft Teams を使用したリアルタイムメディア通話とオンライン会議
description: リアルタイムの音声通話とビデオ通話、オンライン会議を実行できる bot の主要な概念について説明します。
keywords: 音声ストリームのビデオストリーム音声/ビデオ通話のリアルタイムメディアアプリケーション-ホストされているメディアサービスでホストされるメディア
ms.openlocfilehash: 0ec99d1caa8810d292170c7c70a1518de7301873
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674787"
---
# <a name="real-time-media-calls-and-meetings-with-microsoft-teams"></a><span data-ttu-id="9e486-104">Microsoft Teams でのリアルタイムメディア通話と会議</span><span class="sxs-lookup"><span data-stu-id="9e486-104">Real-time media calls and meetings with Microsoft Teams</span></span>

<span data-ttu-id="9e486-105">リアルタイムメディアプラットフォームを使用すると、bot がリアルタイムの音声、ビデオ、画面共有を使用して Microsoft Teams の通話と会議を操作することができます。</span><span class="sxs-lookup"><span data-stu-id="9e486-105">The Real-time Media Platform enables bots to interact with Microsoft Teams calls and meetings using real-time voice, video, and screen sharing.</span></span> <span data-ttu-id="9e486-106">これは、ボットが、*フレームごと*に音声およびビデオコンテンツフレームを送受信できる高度な機能です。</span><span class="sxs-lookup"><span data-stu-id="9e486-106">This is an advanced capability which allows the bot to send and receive voice and video content *frame by frame*.</span></span> <span data-ttu-id="9e486-107">Bot は、音声、ビデオ、画面共有メディアストリームへの "生の" アクセス権を持っています。</span><span class="sxs-lookup"><span data-stu-id="9e486-107">The bot has "raw" access to the voice, video, and screen sharing media streams.</span></span> <span data-ttu-id="9e486-108">(すべてのメディア処理に対してリアルタイムメディアプラットフォームを使用する_サービスホスト型メディア_の簡単なものではなく、_アプリケーションに_よってホストされているメディアの bot と呼ばれる)。</span><span class="sxs-lookup"><span data-stu-id="9e486-108">(Bots which process media themselves are called _application-hosted media_ bots, as opposed to simpler _service-hosted media_ bots that rely on the Real-time Media platform for all media processing.)</span></span>

<span data-ttu-id="9e486-109">たとえば、bot による1:1 呼び出しでは、ユーザーが話すときに、bot は20ミリ秒 (ms) のオーディオを含む各フレームを使用して、1秒間に50オーディオフレームを受信します。</span><span class="sxs-lookup"><span data-stu-id="9e486-109">For example, in a 1:1 call with a bot, as the user speaks, the bot will receive 50 audio frames per second, with each frame containing 20 milliseconds (ms) of audio.</span></span> <span data-ttu-id="9e486-110">アプリケーションによってホストされているメディアボットは、ユーザーが読み上げを停止した後に録音を待つことなく、オーディオフレームの受信時にリアルタイムの音声認識を実行できます。</span><span class="sxs-lookup"><span data-stu-id="9e486-110">An application-hosted media bot can perform real-time speech recognition as the audio frames are received, rather than having to wait for a recording after the user has stopped speaking.</span></span> <span data-ttu-id="9e486-111">Bot は、ビデオベースの画面共有コンテンツを含む高解像度のビデオを送受信することもできます。</span><span class="sxs-lookup"><span data-stu-id="9e486-111">The bot can also send and receive high-definition-resolution video, including video-based screen sharing content.</span></span>

<span data-ttu-id="9e486-112">このプラットフォームは、bot がメディアを送受信するための簡単なソケットに似た API を提供し、ビデオの SILK (や g.722 などのコーデックを使用した音声/ビデオパケットのリアルタイムでのエンコードとデコードを処理します。</span><span class="sxs-lookup"><span data-stu-id="9e486-112">The platform provides a simple socket-like API for the bot to send and receive media, and handles the real-time encoding and decoding of audio/video packets using codecs such as SILK and G.722 for audio and H.264 for video.</span></span> <span data-ttu-id="9e486-113">また、このプラットフォームは、すべてのメディアパケットの暗号化/暗号化解除とパケットネットワーク転送を自動的に処理するので、この bot は、実際の音声/ビデオコンテンツについてのみ考慮する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-113">The platform also handles all media packet encryption/decryption and packet network transmission automatically, so the bot just needs to concern itself with the actual audio/video content.</span></span> <span data-ttu-id="9e486-114">リアルタイムメディアボットは、複数の参加者との会議に加えて、1:1 通話に参加できます。</span><span class="sxs-lookup"><span data-stu-id="9e486-114">A real-time media bot may participate in 1:1 calls as well as meetings with multiple participants.</span></span>

<span data-ttu-id="9e486-115">この記事では、Microsoft Teams を使用してリアルタイムの音声ビデオ通話を行うボットの構築に関連する主要な概念について説明します。</span><span class="sxs-lookup"><span data-stu-id="9e486-115">This article introduces key concepts related to building a bot that can conduct real-time audio/video calls with Microsoft Teams.</span></span>

## <a name="media-session"></a><span data-ttu-id="9e486-116">メディアセッション</span><span class="sxs-lookup"><span data-stu-id="9e486-116">Media session</span></span>

<span data-ttu-id="9e486-117">リアルタイムメディアボットが着信呼び出しに応答したり、Microsoft Teams 会議に参加したりする場合は、サポートする予定のモダリティを宣言する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-117">When a real-time media bot answers an incoming call or joins a Microsoft Teams meeting, it must declare what modalities it intends to support.</span></span> <span data-ttu-id="9e486-118">サポートされている各モダリティに対して、ボットは、メディアの送受信、受信のみ、または送信のみができるかどうかを宣言します。</span><span class="sxs-lookup"><span data-stu-id="9e486-118">For each supported modality, the bot declares whether it can send and receive media, receive only, or send only.</span></span> <span data-ttu-id="9e486-119">たとえば、1:1 Teams 呼び出しを処理するように設計された bot は、オーディオの送受信を行うことができますが、ビデオを*送信*することはできません (発信者のビデオを受信する必要はありません)。</span><span class="sxs-lookup"><span data-stu-id="9e486-119">For example, a bot designed to handle 1:1 Teams calls may wish to both send and receive audio, but only *send* video (as it does not need to receive the video of the caller).</span></span> <span data-ttu-id="9e486-120">Bot と Teams の間で確立される音声およびビデオモダリティのセットは、**メディアセッション**と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="9e486-120">The set of audio and video modalities established between the bot and the Teams caller or meeting is called the **media session**.</span></span>

<span data-ttu-id="9e486-121">次の2種類のビデオモダリティがサポートされています。**メインビデオ**および**ビデオベースの画面共有**。</span><span class="sxs-lookup"><span data-stu-id="9e486-121">Two types of video modalities are supported: **main video** and **video-based screen sharing**.</span></span> <span data-ttu-id="9e486-122">メインビデオは、ユーザーの webcam からビデオを転送するために使用されます。</span><span class="sxs-lookup"><span data-stu-id="9e486-122">Main video is used to transport the video from a user's webcam.</span></span> <span data-ttu-id="9e486-123">ビデオベースの画面共有では、ユーザーは画面をビデオストリームとして共有できます。</span><span class="sxs-lookup"><span data-stu-id="9e486-123">Video-based screen sharing allows a user to share his or her screen as a video stream.</span></span> <span data-ttu-id="9e486-124">このプラットフォームでは、ボットが*両方*のビデオタイプを送受信することができます。</span><span class="sxs-lookup"><span data-stu-id="9e486-124">The platform allows a bot to send and/or receive *both* video types.</span></span>

<span data-ttu-id="9e486-125">Teams 会議に参加すると、ボットは複数のメインビデオストリームを同時に受信できます。メディアセッションあたり最大10個。</span><span class="sxs-lookup"><span data-stu-id="9e486-125">When joined to a Teams meeting, a bot can receive multiple main video streams simultaneously — up to 10 per media session.</span></span> <span data-ttu-id="9e486-126">これにより、ボットは会議で複数の参加者を「表示」することができます。</span><span class="sxs-lookup"><span data-stu-id="9e486-126">This allows the bot to "see" more than one participant in the meeting.</span></span>

## <a name="frames-and-frame-rate"></a><span data-ttu-id="9e486-127">フレームとフレームレート</span><span class="sxs-lookup"><span data-stu-id="9e486-127">Frames and frame rate</span></span>

<span data-ttu-id="9e486-128">リアルタイムメディアボットは、メディアセッションの音声およびビデオモダリティと直接対話します。</span><span class="sxs-lookup"><span data-stu-id="9e486-128">A real-time media bot interacts directly with the audio and video modalities of a media session.</span></span> <span data-ttu-id="9e486-129">これは、ボットが一連の**フレーム**としてメディアを送信または受信していることを意味します。各フレームは、コンテンツの単位を表します。</span><span class="sxs-lookup"><span data-stu-id="9e486-129">This means the bot is sending and/or receiving media as a sequence of **frames**, where each frame represents a unit of content.</span></span> <span data-ttu-id="9e486-130">1秒間のオーディオは50フレームのシーケンスとして送信され、各フレームには20ミリ秒 (ms)-1/50 パーの音声コンテンツが含まれます。</span><span class="sxs-lookup"><span data-stu-id="9e486-130">One second of audio may be transmitted as a sequence of 50 frames, with each frame containing 20 milliseconds (ms) —1/50th of a second — of speech content.</span></span> <span data-ttu-id="9e486-131">1秒あたりのビデオの数は30個の静止画のシーケンスとしてスライスされており、それぞれのビデオフレームが表示される前に、33.3 ms (1/30 秒) で表示されるようになっています。</span><span class="sxs-lookup"><span data-stu-id="9e486-131">One second worth of video may be sliced as a sequence of 30 still images, each intended to be viewed for just 33.3ms — 1/30th of a second — before the next video frame is displayed.</span></span> <span data-ttu-id="9e486-132">1秒あたりに送信またはレンダリングされるフレーム数は**フレームレート**と呼ばれます。</span><span class="sxs-lookup"><span data-stu-id="9e486-132">The number of frames transmitted or rendered per second is called the **frame rate**.</span></span> <span data-ttu-id="9e486-133">"30fps" は、1秒間に30フレームを示します。</span><span class="sxs-lookup"><span data-stu-id="9e486-133">"30fps" indicates 30 frames per second.</span></span>

## <a name="audio-format"></a><span data-ttu-id="9e486-134">オーディオ形式</span><span class="sxs-lookup"><span data-stu-id="9e486-134">Audio format</span></span>

<span data-ttu-id="9e486-135">各音声の秒は、16000**サンプル**として表され、各サンプルには16ビットのデータが含まれています。</span><span class="sxs-lookup"><span data-stu-id="9e486-135">Each second of audio is represented as 16,000 **samples**, with each sample containing 16-bits of data.</span></span> <span data-ttu-id="9e486-136">20ミリ秒 audio フレームには320サンプル (640 バイトのデータ) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="9e486-136">A 20ms audio frame contains 320 samples (640 bytes of data).</span></span>

## <a name="video-format"></a><span data-ttu-id="9e486-137">ビデオの形式</span><span class="sxs-lookup"><span data-stu-id="9e486-137">Video format</span></span>

<span data-ttu-id="9e486-138">ビデオでは、複数の形式がサポートされています。</span><span class="sxs-lookup"><span data-stu-id="9e486-138">There are several formats supported for video.</span></span> <span data-ttu-id="9e486-139">ビデオ形式の2つの重要なプロパティは、**フレームのサイズ**と**色の形式**です。</span><span class="sxs-lookup"><span data-stu-id="9e486-139">Two key properties of a video format are its **frame size** and **color format**.</span></span> <span data-ttu-id="9e486-140">サポートされているフレームサイズには、640x360 ("360p")、1280x720 ("720p")、1920x1080 ("1080p") があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-140">Supported frame sizes include 640x360 ("360p"), 1280x720 ("720p"), and 1920x1080 ("1080p").</span></span> <span data-ttu-id="9e486-141">サポートされているカラー形式には、NV12 (12 ビット/ピクセル) と RGB24 (24 ビット/ピクセル) があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-141">Supported color formats include NV12 (12 bits per pixel) and RGB24 (24 bits per pixel).</span></span>

<span data-ttu-id="9e486-142">「720p」ビデオフレームには921600ピクセル (1280 × 720) が含まれます。</span><span class="sxs-lookup"><span data-stu-id="9e486-142">A "720p" video frame contains 921,600 pixels (1280 times 720).</span></span> <span data-ttu-id="9e486-143">RGB24 の色の書式では、各ピクセルが、赤、緑、青の各カラーコンポーネントの1バイトで構成される3バイト (24 ビット) として表されます。</span><span class="sxs-lookup"><span data-stu-id="9e486-143">In the RGB24 color format, each pixel is represented as 3 bytes (24-bits) comprised of one byte each of red, green, and blue color components.</span></span> <span data-ttu-id="9e486-144">そのため、1つの 720p RGB24 ビデオフレームでは2764800バイトのデータ (921600 ピクセル×3バイト/ピクセル) が必要です。</span><span class="sxs-lookup"><span data-stu-id="9e486-144">Therefore, a single 720p RGB24 video frame requires 2,764,800 bytes of data (921,600 pixels times 3 bytes/pixel).</span></span> <span data-ttu-id="9e486-145">30 fps のフレームレートでは、720p RGB24 ビデオフレームを送信すると、約 80 MB/秒のコンテンツが処理されます (これは、ネットワーク転送の前に、ビデオコーデックによって大幅に圧縮されます)。</span><span class="sxs-lookup"><span data-stu-id="9e486-145">At a frame rate of 30fps, sending 720p RGB24 video frames means processing approximately 80 MB/s of content (which is substantially compressed by the H.264 video codec before network transmission).</span></span>

<span data-ttu-id="9e486-146">プラットフォームの高度な機能により、bot は、**エンコード**された .h フレームとしてビデオを送受信することができます。</span><span class="sxs-lookup"><span data-stu-id="9e486-146">An advanced capability of the platform allows a bot to send/receive video as **encoded** H.264 frames.</span></span> <span data-ttu-id="9e486-147">これは、独自の RGB24 エンコーダー/デコーダーを提供するボットをサポートしているか、raw または NV12 ビットマップにデコードされたビデオストリームを必要としません。</span><span class="sxs-lookup"><span data-stu-id="9e486-147">This supports bots which provide their own H.264 encoder/decoder, or do not need the video stream decoded into raw RGB24 or NV12 bitmaps.</span></span>

## <a name="active-and-dominant-speakers"></a><span data-ttu-id="9e486-148">アクティブで主要なスピーカー</span><span class="sxs-lookup"><span data-stu-id="9e486-148">Active and dominant speakers</span></span>

<span data-ttu-id="9e486-149">複数の参加者で構成されている Teams 会議に参加する場合、bot は現在会話しているミーティング参加者を特定できます。</span><span class="sxs-lookup"><span data-stu-id="9e486-149">When joined to a Teams meeting consisting of multiple participants, a bot can identify which meeting participants are currently speaking.</span></span> <span data-ttu-id="9e486-150">**アクティブなスピーカー**は、受信した各オーディオフレームでどの参加者が聞こえるかを識別します。</span><span class="sxs-lookup"><span data-stu-id="9e486-150">**Active speakers** identify which participants are being heard in each received audio frame.</span></span> <span data-ttu-id="9e486-151">**主要な講演**者は、すべてのオーディオフレームで音声が聞こえない場合でも、グループ会話で現在最もアクティブな (または「優先度の高い) 参加者を特定します。</span><span class="sxs-lookup"><span data-stu-id="9e486-151">**Dominant speakers** identify which participants are currently most active (or "dominant") in the group conversation, even though their voice may not be heard in every audio frame.</span></span> <span data-ttu-id="9e486-152">主要なスピーカーのセットは、参加者が話すことができるように変更されます。</span><span class="sxs-lookup"><span data-stu-id="9e486-152">The set of dominant speakers can change as different participants take turns speaking.</span></span>

## <a name="video-subscription"></a><span data-ttu-id="9e486-153">ビデオ購読</span><span class="sxs-lookup"><span data-stu-id="9e486-153">Video subscription</span></span>

<span data-ttu-id="9e486-154">1:1 通話では、ボットがビデオを受信するように設定されている場合、ボットは発信者のビデオを自動的に受け取ります。</span><span class="sxs-lookup"><span data-stu-id="9e486-154">In a 1:1 call, the bot will automatically receive the video of the caller if the bot is enabled to receive video.</span></span> <span data-ttu-id="9e486-155">Teams 会議では、ボットは、表示する参加者をプラットフォームに示す必要があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-155">In a Teams meeting, the bot must indicate to the platform which participants it wants to see.</span></span> <span data-ttu-id="9e486-156">**ビデオサブスクリプション**とは、参加者のメインビデオまたは画面共有コンテンツを受信するためのボットによる要求です。</span><span class="sxs-lookup"><span data-stu-id="9e486-156">A **video subscription** is a request by the bot to receive a participant’s main video or screen-sharing content.</span></span> <span data-ttu-id="9e486-157">会議の参加者が会話を開催する際に、ボットは主要なスピーカーセットの更新に基づいて、目的のビデオ講読を変更することがあります。また、どの参加者が現在画面を共有しているかを示す通知があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-157">As the participants in the meeting conduct their conversation, the bot may modify its desired video subscriptions based on updates of the dominant speaker set or notifications indicating which participant is currently screen sharing.</span></span>

## <a name="developer-resources"></a><span data-ttu-id="9e486-158">開発者向けリソース</span><span class="sxs-lookup"><span data-stu-id="9e486-158">Developer resources</span></span>

<span data-ttu-id="9e486-159">アプリケーションホスト型メディア bot を開発するには、Visual Studio プロジェクト内に次の NuGet パッケージをインストールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="9e486-159">To develop an application-hosted media bot, you must install the following NuGet package within your Visual Studio project:</span></span>

- [<span data-ttu-id="9e486-160">Microsoft Graph の .NET ライブラリ</span><span class="sxs-lookup"><span data-stu-id="9e486-160">Microsoft.Graph.Calls.Media .NET library</span></span>](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)

<span data-ttu-id="9e486-161">アプリケーションホスト型メディアのボットには、.NET/C# および Windows Server が必要です。詳細については、「[要件」および「アプリケーションホスト型メディアのボットの考慮事項](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="9e486-161">Application-hosted media bots require .NET/C# and Windows Server, as described in detail in [Requirements and considerations for application-hosted media bots](requirements-considerations-application-hosted-media-bots.md#application-hosted-media-bot-development-requires-cnet-and-windows-server).</span></span>
