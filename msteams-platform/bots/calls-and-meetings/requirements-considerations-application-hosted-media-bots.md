---
title: アプリケーションホスト型メディア ボットの要件と考慮事項
description: アプリケーションホスト型メディア ボットの作成に関連する重要な要件と考慮事項をMicrosoft Teams。
ms.topic: conceptual
localization_priority: Normal
keywords: アプリケーションホスト型メディア Windows サーバー azure vm
ms.date: 11/16/2018
ms.openlocfilehash: 731cc53573d5c2b65eaed36d75793901fde86e54
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020057"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a><span data-ttu-id="cae9d-104">アプリケーションホスト型メディア ボットの要件と考慮事項</span><span class="sxs-lookup"><span data-stu-id="cae9d-104">Requirements and considerations for application-hosted media bots</span></span>

<span data-ttu-id="cae9d-105">アプリケーションホスト型メディア ボットでは、音声およびビデオ メディア ストリーム[ `Microsoft.Graph.Communications.Calls.Media` にアクセスするために .NET](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)ライブラリが必要です。</span><span class="sxs-lookup"><span data-stu-id="cae9d-105">An application-hosted media bot requires the [`Microsoft.Graph.Communications.Calls.Media` .NET library](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) to access the audio and video media streams.</span></span> <span data-ttu-id="cae9d-106">ボットは、Azure のサーバー コンピューター Windowsサーバー ゲスト オペレーティング システム (OS) Windows展開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-106">The bot must be deployed on a Windows Server machine or Windows Server guest Operating System (OS) in Azure.</span></span>

> [!NOTE]
> * <span data-ttu-id="cae9d-107">メッセージングおよび対話型音声応答 (IVR) ボットを開発するためのガイダンスは、アプリケーションホスト型メディア ボットの構築には完全には適用されません。</span><span class="sxs-lookup"><span data-stu-id="cae9d-107">The guidance for developing messaging and Interactive Voice Response (IVR) bots does not completely apply to building application-hosted media bots.</span></span>
> * <span data-ttu-id="cae9d-108">Microsoft Real-time Media Platform for bots は開発者向けプレビューに含まれるので、このドキュメントのガイダンスは変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-108">As the Microsoft Real-time Media Platform for bots is in developer preview, the guidance in this document is subject to change.</span></span>

## <a name="c-or-net-and-windows-server-for-development"></a><span data-ttu-id="cae9d-109">C#または .NET および Windows サーバーの開発</span><span class="sxs-lookup"><span data-stu-id="cae9d-109">C# or .NET and Windows Server for development</span></span>

<span data-ttu-id="cae9d-110">アプリケーションホスト型メディア ボットには、次の情報が必要です。</span><span class="sxs-lookup"><span data-stu-id="cae9d-110">An application-hosted media bot requires the following:</span></span>

- <span data-ttu-id="cae9d-111">ボットは、C#および標準.NET Frameworkで開発し、Microsoft Azure。</span><span class="sxs-lookup"><span data-stu-id="cae9d-111">The bot must be developed in C# and the standard .NET Framework and deployed in Microsoft Azure.</span></span> <span data-ttu-id="cae9d-112">C++ API または Node.js API を使用してリアルタイム メディアにアクセスすることはできません。アプリケーションホスト型メディア ボットでは .NET Core はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="cae9d-112">You cannot use C++ or Node.js APIs to access real-time media and .NET Core is not supported for an application-hosted media bot.</span></span>

- <span data-ttu-id="cae9d-113">ボットは、次のいずれかの Azure サービス環境内でホストできます。</span><span class="sxs-lookup"><span data-stu-id="cae9d-113">The bot can be hosted within one of the following Azure service environments:</span></span>
    - <span data-ttu-id="cae9d-114">クラウド サービス。</span><span class="sxs-lookup"><span data-stu-id="cae9d-114">Cloud Service.</span></span>
    - <span data-ttu-id="cae9d-115">Service Fabricスケール セット (VMSS) を使用します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-115">Service Fabric with Virtual Machine Scale Sets (VMSS).</span></span>
    - <span data-ttu-id="cae9d-116">サービスとしてのインフラストラクチャ (IaaS) 仮想マシン (VM)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-116">Infrastructure as a Service (IaaS) Virtual Machine (VM).</span></span>  
  
- <span data-ttu-id="cae9d-117">ボットを Azure Web アプリとして展開することはできません。</span><span class="sxs-lookup"><span data-stu-id="cae9d-117">The bot cannot be deployed as an Azure web app.</span></span>

- <span data-ttu-id="cae9d-118">ボットは、.NET ライブラリの最新バージョンで実行されている `Microsoft.Graph.Communications.Calls.Media` 必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-118">The bot must be running on a recent version of the `Microsoft.Graph.Communications.Calls.Media` .NET library.</span></span> <span data-ttu-id="cae9d-119">ボットは、最新のバージョンの NuGet パッケージ、または 3 か[月以内](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)のバージョンを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-119">The bot must use either the newest available version of the [NuGet package](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), or a version that is not more than three months old.</span></span> <span data-ttu-id="cae9d-120">古いバージョンのライブラリは廃止され、数か月後には機能しません。</span><span class="sxs-lookup"><span data-stu-id="cae9d-120">Older versions of the library are deprecated and do not work after a few months.</span></span> <span data-ttu-id="cae9d-121">ライブラリを `Microsoft.Graph.Communications.Calls.Media` 最新の状態に保つことで、ボットとサーバー間の最適な相互運用性がMicrosoft Teams。</span><span class="sxs-lookup"><span data-stu-id="cae9d-121">Keeping the `Microsoft.Graph.Communications.Calls.Media` library up-to-date ensures the best interoperability between the bot and Microsoft Teams.</span></span>

<span data-ttu-id="cae9d-122">次のセクションでは、リアルタイム メディア通話の場所の詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-122">The next section provides details on where real-time media calls are located.</span></span>

## <a name="real-time-media-calls-stay-where-they-are-created"></a><span data-ttu-id="cae9d-123">リアルタイム のメディア通話は、作成された場所にとどまる</span><span class="sxs-lookup"><span data-stu-id="cae9d-123">Real-time media calls stay where they are created</span></span>

<span data-ttu-id="cae9d-124">リアルタイムのメディア通話は、作成されたコンピューターに残っています。</span><span class="sxs-lookup"><span data-stu-id="cae9d-124">Real-time media calls stay on the computer where they were created.</span></span> <span data-ttu-id="cae9d-125">リアルタイムのメディア通話は、呼び出しを受け入れるか開始した仮想マシン (VM) インスタンスにピン留めされます。</span><span class="sxs-lookup"><span data-stu-id="cae9d-125">A real-time media call is pinned to the virtual machine (VM) instance that accepted or started the call.</span></span> <span data-ttu-id="cae9d-126">その VM インスタンスMicrosoft Teams呼び出しまたは会議フローからのメディア、およびボットが送信するメディアは、Microsoft Teams VM から発信する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-126">Media from a Microsoft Teams call or meeting flows to that VM instance, and media the bot sends back to Microsoft Teams must also originate from that VM.</span></span> <span data-ttu-id="cae9d-127">VM の停止時にリアルタイムのメディア呼び出しが進行中の場合、これらの呼び出しは突然終了します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-127">If there are any real-time media calls in progress when the VM is stopped, those calls are abruptly terminated.</span></span> <span data-ttu-id="cae9d-128">ボットが保留中の VM シャットダウンに関する事前知識を持っている場合は、呼び出しを終了できます。</span><span class="sxs-lookup"><span data-stu-id="cae9d-128">If the bot has prior knowledge of the pending VM shutdown, it can end the calls.</span></span>

<span data-ttu-id="cae9d-129">次のセクションでは、アプリケーションホスト型メディア ボットのアクセシビリティの詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-129">The next section provides details on accessibility of application-hosted media bots.</span></span>

## <a name="application-hosted-media-bots-accessible-on-the-internet"></a><span data-ttu-id="cae9d-130">インターネット上でアクセス可能なアプリケーションホスト型メディア ボット</span><span class="sxs-lookup"><span data-stu-id="cae9d-130">Application-hosted media bots accessible on the internet</span></span>

<span data-ttu-id="cae9d-131">アプリケーションホスト型メディア ボットは、インターネット上で直接アクセスできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-131">Application-hosted media bots must be directly accessible on the internet.</span></span> <span data-ttu-id="cae9d-132">これらのボットには、次の機能が含まれる必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-132">These bots must include the following features:</span></span>

- <span data-ttu-id="cae9d-133">Azure でアプリケーションホスト型メディア ボットをホストする各 VM インスタンスは、インスタンス レベルのパブリック IP アドレス (ILPIP) を使用してインターネットから直接アクセスできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-133">Each VM instance hosting an application-hosted media bot in Azure must be directly accessible from the internet using an instance-level public IP address (ILPIP).</span></span>
    - <span data-ttu-id="cae9d-134">Azure Cloud Service の ILPIP を取得および構成するには、「インスタンス レベルのパブリック IP クラシックの概要 [」を参照してください](/azure/virtual-network/virtual-networks-instance-level-public-ip)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-134">For obtaining and configuring an ILPIP for an Azure Cloud Service, see [instance level public IP classic overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span></span>
    - <span data-ttu-id="cae9d-135">VM スケール セットの ILPIP を構成するには、「仮想マシンごとの [パブリック IPv4」を参照してください](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-135">For configuring an ILPIP for a VM Scale Set, see [public IPv4 per virtual machine](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span></span>
- <span data-ttu-id="cae9d-136">アプリケーションホスト型メディア ボットをホストするサービスでは、特定のインスタンスにマップされるパブリック向けポートを使用して各 VM インスタンスを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-136">The service hosting an application-hosted media bot must also configure each VM instance with a public-facing port which maps to the specific instance.</span></span>
    - <span data-ttu-id="cae9d-137">Azure Cloud Service の場合、これにはインスタンス入力エンドポイントが必要です。</span><span class="sxs-lookup"><span data-stu-id="cae9d-137">For an Azure Cloud Service, this requires an instance input endpoint.</span></span> <span data-ttu-id="cae9d-138">詳細については [、「Azure でロール インスタンスの通信を有効にする」を参照してください](/azure/cloud-services/cloud-services-enable-communication-role-instances)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-138">For more information, see [enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span></span>
    - <span data-ttu-id="cae9d-139">VM スケール セットの場合、ロード バランサーの NAT ルールを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-139">For a VM Scale Set, a NAT rule on the load balancer must be configured.</span></span> <span data-ttu-id="cae9d-140">詳細については [、「Azure の仮想ネットワークと仮想マシン」を参照してください](/azure/virtual-machines/windows/network-overview)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-140">For more information, see [virtual networks and virtual machines in Azure](/azure/virtual-machines/windows/network-overview).</span></span>
- <span data-ttu-id="cae9d-141">アプリケーションホスト型メディア ボットは、アプリケーション ホスト型メディア ボットBot Framework Emulator。</span><span class="sxs-lookup"><span data-stu-id="cae9d-141">Application-hosted media bots are not supported by the Bot Framework Emulator.</span></span>

<span data-ttu-id="cae9d-142">次のセクションでは、アプリケーションホスト型メディア ボットのスケーラビリティとパフォーマンスに関する考慮事項の詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-142">The next section provides details on scalability and performance considerations of application-hosted media bots.</span></span>

## <a name="scalability-and-performance-considerations"></a><span data-ttu-id="cae9d-143">スケーラビリティとパフォーマンスに関する検討事項</span><span class="sxs-lookup"><span data-stu-id="cae9d-143">Scalability and performance considerations</span></span>

<span data-ttu-id="cae9d-144">アプリケーションホスト型メディア ボットには、次のスケーラビリティとパフォーマンスに関する考慮事項が必要です。</span><span class="sxs-lookup"><span data-stu-id="cae9d-144">Application-hosted media bots require the following scalability and performance considerations:</span></span>

## <a name="code-sample"></a><span data-ttu-id="cae9d-145">コード サンプル</span><span class="sxs-lookup"><span data-stu-id="cae9d-145">Code sample</span></span>

<span data-ttu-id="cae9d-146">アプリケーションホスト型メディア ボットのサンプルは次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="cae9d-146">Application-hosted media bots samples are as follows:</span></span>

| <span data-ttu-id="cae9d-147">**サンプル名**</span><span class="sxs-lookup"><span data-stu-id="cae9d-147">**Sample name**</span></span> | <span data-ttu-id="cae9d-148">**説明**</span><span class="sxs-lookup"><span data-stu-id="cae9d-148">**Description**</span></span> | <span data-ttu-id="cae9d-149">**Graph**</span><span class="sxs-lookup"><span data-stu-id="cae9d-149">**Graph**</span></span> |
|------------|-------------|-----------|
| <span data-ttu-id="cae9d-150">ローカル メディアのサンプル</span><span class="sxs-lookup"><span data-stu-id="cae9d-150">Local media sample</span></span> | <span data-ttu-id="cae9d-151">さまざまなローカル メディア シナリオを示すサンプル。</span><span class="sxs-lookup"><span data-stu-id="cae9d-151">Samples that illustrates different local media scenarios.</span></span> | [<span data-ttu-id="cae9d-152">View</span><span class="sxs-lookup"><span data-stu-id="cae9d-152">View</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples) |
| <span data-ttu-id="cae9d-153">リモート メディアのサンプル</span><span class="sxs-lookup"><span data-stu-id="cae9d-153">Remote media sample</span></span> | <span data-ttu-id="cae9d-154">さまざまなリモート メディア シナリオを示すサンプル。</span><span class="sxs-lookup"><span data-stu-id="cae9d-154">Samples that illustrates different remote media scenarios.</span></span> | [<span data-ttu-id="cae9d-155">View</span><span class="sxs-lookup"><span data-stu-id="cae9d-155">View</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/RemoteMediaSamples) |

## <a name="see-also"></a><span data-ttu-id="cae9d-156">関連項目</span><span class="sxs-lookup"><span data-stu-id="cae9d-156">See also</span></span>

- [<span data-ttu-id="cae9d-157">GraphSDK ドキュメントの呼び出し</span><span class="sxs-lookup"><span data-stu-id="cae9d-157">Graph Calling SDK Documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)
- <span data-ttu-id="cae9d-158">ボットでは、メッセージング ボットよりも多くのコンピューティングとネットワーク帯域幅の容量が必要であり、運用コストが大幅に高くなります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-158">The bots require more compute and network bandwidth capacity than messaging bots and incur significantly higher operational costs.</span></span> <span data-ttu-id="cae9d-159">リアルタイムのメディア ボット開発者は、ボットのスケーラビリティを慎重に測定し、ボットが管理できる以上の同時呼び出しを受け入れなかねない必要があります。</span><span class="sxs-lookup"><span data-stu-id="cae9d-159">A real-time media bot developer must carefully measure the bot's scalability, and ensure the bot does not accept more simultaneous calls than it can manage.</span></span> <span data-ttu-id="cae9d-160">ビデオが有効なボットは、RAW RGB24 または NV12 ビデオ形式を使用する場合、CPU コアごとに 1 つまたは 2 つの同時メディア セッションのみを維持できます。</span><span class="sxs-lookup"><span data-stu-id="cae9d-160">A video-enabled bot can sustain only one or two concurrent media sessions per CPU core if using the raw RGB24 or NV12 video formats.</span></span>
- <span data-ttu-id="cae9d-161">リアルタイム メディア プラットフォームでは、現在、VM で使用できるグラフィックス処理ユニット (GPU) を利用して H.264 ビデオ エンコードまたはデコードをオフロードできません。</span><span class="sxs-lookup"><span data-stu-id="cae9d-161">The Real-time Media Platform does not currently take advantage of any Graphics Processing Units (GPU) available on the VM to off-load H.264 video encoding or decoding.</span></span> <span data-ttu-id="cae9d-162">代わりに、ビデオエンコードとデコードは CPU 上のソフトウェアで行われます。</span><span class="sxs-lookup"><span data-stu-id="cae9d-162">Instead, video encode and decode are done in software on the CPU.</span></span> <span data-ttu-id="cae9d-163">GPU が使用可能な場合、ボットが 3D グラフィックス エンジンを使用している場合など、ボットは独自のグラフィックス レンダリングで GPU を利用します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-163">If a GPU is available, the bot takes advantage of it for its own graphics rendering, for example, if the bot is using a 3D graphics engine.</span></span>
- <span data-ttu-id="cae9d-164">リアルタイム メディア ボットをホストする VM インスタンスには、少なくとも 2 つの CPU コアが必要です。</span><span class="sxs-lookup"><span data-stu-id="cae9d-164">The VM instance hosting the real-time media bot must have at least 2 CPU cores.</span></span> <span data-ttu-id="cae9d-165">Azure では、Dv2 シリーズ仮想マシンをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="cae9d-165">For Azure, a Dv2-series virtual machine is recommended.</span></span> <span data-ttu-id="cae9d-166">他の Azure VM の種類では、4 つの仮想 CPU (vCPU) を持つシステムが必要な最小サイズです。</span><span class="sxs-lookup"><span data-stu-id="cae9d-166">For other Azure VM types, a system with 4 virtual CPUs (vCPU) is the minimum size required.</span></span> <span data-ttu-id="cae9d-167">Azure VM の種類の詳細については、「Azure のドキュメント」 [を参照してください](/azure/virtual-machines/windows/sizes-general)。</span><span class="sxs-lookup"><span data-stu-id="cae9d-167">For more information about Azure VM types, see [Azure documentation](/azure/virtual-machines/windows/sizes-general).</span></span>

<span data-ttu-id="cae9d-168">次のセクションでは、さまざまなローカル メディア シナリオを示すサンプルを示します。</span><span class="sxs-lookup"><span data-stu-id="cae9d-168">The next section provides samples that illustrate different local media scenarios.</span></span>

## <a name="samples-and-additional-resources"></a><span data-ttu-id="cae9d-169">サンプルと追加のリソース</span><span class="sxs-lookup"><span data-stu-id="cae9d-169">Samples and additional resources</span></span>

- [<span data-ttu-id="cae9d-170">サンプル アプリケーション</span><span class="sxs-lookup"><span data-stu-id="cae9d-170">Sample applications</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [<span data-ttu-id="cae9d-171">Graph SDK ドキュメントの呼び出し</span><span class="sxs-lookup"><span data-stu-id="cae9d-171">Graph calling SDK documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)

## <a name="next-step"></a><span data-ttu-id="cae9d-172">次の手順</span><span class="sxs-lookup"><span data-stu-id="cae9d-172">Next step</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="cae9d-173">サポートされているメディア形式</span><span class="sxs-lookup"><span data-stu-id="cae9d-173">Supported media formats</span></span>](~/resources/media-formats.md)
