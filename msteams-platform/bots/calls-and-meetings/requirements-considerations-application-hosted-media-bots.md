---
title: アプリケーションホスト型メディア ボットの要件と考慮事項
description: Microsoft Teams のアプリケーション ホスト型メディア ボットの作成に関連する重要な要件と考慮事項について説明します。
ms.topic: conceptual
keywords: アプリケーションホスト型メディア Windows サーバー Azure vm
ms.date: 11/16/2018
ms.openlocfilehash: bf75b7f689713f16cb3ff9ff4313ab829b5cc2d6
ms.sourcegitcommit: 976e870cc925f61b76c3830ec04ba6e4bdfde32f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 01/27/2021
ms.locfileid: "50014489"
---
# <a name="requirements-and-considerations-for-application-hosted-media-bots"></a><span data-ttu-id="0c43b-104">アプリケーションホスト型メディア ボットの要件と考慮事項</span><span class="sxs-lookup"><span data-stu-id="0c43b-104">Requirements and considerations for application-hosted media bots</span></span>

<span data-ttu-id="0c43b-105">メッセージングおよび対話型音声応答 (IVR) ボットを開発するためのガイダンスのすべてが、アプリケーションホスト型メディア ボットの構築にも同じように適用されるわけではありません。</span><span class="sxs-lookup"><span data-stu-id="0c43b-105">Not all guidance for developing messaging and Interactive Voice Response (IVR) bots applies equally to building application-hosted media bots.</span></span> <span data-ttu-id="0c43b-106">この記事では、アプリケーションホスト型メディア ボットの開発と実行に関する重要な要件と考慮事項について説明します。</span><span class="sxs-lookup"><span data-stu-id="0c43b-106">This article describes some of the important requirements and considerations for developing and running an application-hosted media bot.</span></span>

> [!NOTE]
> <span data-ttu-id="0c43b-107">Microsoft Real-time Media Platform for Bots は開発者プレビューに含まれるため、この記事のガイダンスは変更される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-107">Because the Microsoft Real-time Media Platform for Bots is in developer preview, the guidance in this article is subject to change.</span></span>

## <a name="application-hosted-media-bot-development-requires-cnet-and-windows-server"></a><span data-ttu-id="0c43b-108">アプリケーションホスト型メディア ボット開発には C#/.NET と Windows Server が必要</span><span class="sxs-lookup"><span data-stu-id="0c43b-108">Application-hosted media bot development requires C#/.NET and Windows Server</span></span>

- <span data-ttu-id="0c43b-109">アプリケーションでホストされるメディア ボットには.NET ライブラリ (オーディオとビデオのメディア ストリームにアクセスするためにここで利用できます)、ボットは Windows Server コンピューター (または Azure の Windows Server ゲスト OS) に展開する必要があります。 `Microsoft.Graph.Communications.Calls.Media` [](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)</span><span class="sxs-lookup"><span data-stu-id="0c43b-109">An application-hosted media bot requires the `Microsoft.Graph.Communications.Calls.Media` .NET library ([available here](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/) to access the audio and video media streams, and the bot must be deployed on a Windows Server machine (or Windows Server guest OS in Azure).</span></span> <span data-ttu-id="0c43b-110">したがって、ボットは C# と標準の .NET Framework で開発し、Microsoft Azure に展開する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-110">Therefore, the bot must be developed in C# and the standard .NET Framework and deployed in Microsoft Azure.</span></span> <span data-ttu-id="0c43b-111">C++ または Node.js API を使用してリアルタイム メディアにアクセスすることはできません。また、アプリケーションホスト型メディア ボットでは .NET Core はサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="0c43b-111">You can't use C++ or Node.js APIs to access real-time media and .NET Core is not supported for an application-hosted media bot.</span></span>

- <span data-ttu-id="0c43b-112">アプリケーションホスト型メディア ボットは、次のいずれかの Azure サービス環境内でホストできます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-112">An application-hosted media bot can be hosted within one of the following Azure service environments:</span></span>
  - <span data-ttu-id="0c43b-113">クラウド サービス。</span><span class="sxs-lookup"><span data-stu-id="0c43b-113">Cloud Service.</span></span>
  - <span data-ttu-id="0c43b-114">仮想マシン スケール セット (VMSS) を含む Service Fabric。</span><span class="sxs-lookup"><span data-stu-id="0c43b-114">Service Fabric with Virtual Machine Scale Sets (VMSS).</span></span>
  - <span data-ttu-id="0c43b-115">サービスとしてのインフラストラクチャ (IaaS) 仮想マシン (VM)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-115">Infrastructure as a Service (IaaS) Virtual Machine (VM).</span></span>  
  
- <span data-ttu-id="0c43b-116">アプリケーションホスト型メディア ボットは、Azure Web App として展開できない。</span><span class="sxs-lookup"><span data-stu-id="0c43b-116">An application-hosted media bot can't be deployed as an Azure Web App.</span></span>

- <span data-ttu-id="0c43b-117">アプリケーションホスト型メディア ボットは、最新バージョンの .NET ライブラリで実行されている `Microsoft.Graph.Communications.Calls.Media` 必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-117">An application-hosted media bot must be running on a recent version of the `Microsoft.Graph.Communications.Calls.Media` .NET library.</span></span> <span data-ttu-id="0c43b-118">ボットは [、NuGet](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/)パッケージの最新の利用可能なバージョン、または 3 か月以上前のバージョンを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-118">The bot should use either the newest available version of the [NuGet package](https://www.nuget.org/packages/Microsoft.Graph.Communications.Calls.Media/), or a version that is not more than three months old.</span></span> <span data-ttu-id="0c43b-119">古いバージョンのライブラリは廃止され、数か月後には機能しない可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-119">Older versions of the library will be deprecated and may not work after a few months.</span></span> <span data-ttu-id="0c43b-120">ライブラリを `Microsoft.Graph.Communications.Calls.Media` 最新の状態に保つことで、ボットと Microsoft Teams の間の最適な相互運用性が確保されます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-120">Keeping the `Microsoft.Graph.Communications.Calls.Media` library up-to-date will ensure the best interoperability between the bot and Microsoft Teams.</span></span>

## <a name="real-time-media-calls-stay-on-the-machine-where-they-were-created"></a><span data-ttu-id="0c43b-121">リアルタイム メディア通話は、作成されたコンピューター上に残る</span><span class="sxs-lookup"><span data-stu-id="0c43b-121">Real-time media calls stay on the machine where they were created</span></span>

- <span data-ttu-id="0c43b-122">リアルタイムメディア通話は、通話を受け付けまたは開始した仮想マシン (VM) インスタンスにピン留めされます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-122">A real-time media call is pinned to the virtual machine (VM) instance that accepted or started the call.</span></span> <span data-ttu-id="0c43b-123">Microsoft Teams の通話または会議からのメディアは、その VM インスタンスに流れ、ボットが Microsoft Teams に送り返すメディアもその VM から発信される必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-123">Media from a Microsoft Teams call or meeting will flow to that VM instance, and media the bot sends back to Microsoft Teams must also originate from that VM.</span></span>
- <span data-ttu-id="0c43b-124">VM の停止時に進行中のリアルタイム メディア呼び出しがある場合、それらの呼び出しは突然終了されます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-124">If there are any real-time media calls in progress when the VM is stopped, those calls will be abruptly terminated.</span></span> <span data-ttu-id="0c43b-125">保留中の VM シャットダウンに関する事前の知識があるボットは、呼び出しを "正常に" 終了しようとすることができます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-125">If the bot has prior knowledge of the pending VM shutdown, it can try to "gracefully" end the calls.</span></span>

## <a name="application-hosted-media-bots-must-be-directly-accessible-on-the-internet"></a><span data-ttu-id="0c43b-126">アプリケーションホスト型メディア ボットは、インターネット上で直接アクセスできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-126">Application-hosted media bots must be directly accessible on the internet</span></span>

- <span data-ttu-id="0c43b-127">Azure でアプリケーションホスト型メディア ボットをホストする各 VM インスタンスは、インスタンス レベルのパブリック IP アドレス (ILPIP) を使用してインターネットから直接アクセスできる必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-127">Each VM instance hosting an application-hosted media bot in Azure must be directly accessible from the internet using an instance-level public IP address (ILPIP).</span></span>
  - <span data-ttu-id="0c43b-128">Azure クラウド サービスの ILPIP を取得および構成するには、「インスタンス レベルのパブリック [IP (クラシック) の概要」を参照してください](/azure/virtual-network/virtual-networks-instance-level-public-ip)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-128">For obtaining and configuring an ILPIP for an Azure Cloud Service, see [Instance level public IP (Classic) overview](/azure/virtual-network/virtual-networks-instance-level-public-ip).</span></span>
  - <span data-ttu-id="0c43b-129">VM スケール セットの ILPIP を構成するには、仮想マシンごとの [パブリック IPv4 を参照してください](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-129">For configuring an ILPIP for a VM Scale Set, see [Public IPv4 per virtual machine](/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-networking#public-ipv4-per-virtual-machine).</span></span>
- <span data-ttu-id="0c43b-130">また、アプリケーションホスト型メディア ボットをホストするサービスは、特定のインスタンスにマップされる公開ポートを使用して各 VM インスタンスを構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-130">The service hosting an application-hosted media bot must also configure each VM instance with a public-facing port which maps to the specific instance.</span></span>
  - <span data-ttu-id="0c43b-131">Azure クラウド サービスの場合、これにはインスタンス入力エンドポイントが必要です。「Azure [でロール インスタンスの通信を有効にする」を参照してください](/azure/cloud-services/cloud-services-enable-communication-role-instances)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-131">For an Azure Cloud Service, this requires an instance input endpoint; see [Enable communication for role instances in Azure](/azure/cloud-services/cloud-services-enable-communication-role-instances).</span></span>
  - <span data-ttu-id="0c43b-132">VM スケール セットの場合、ロード バランサーの NAT ルールを構成する必要があります。 [Azure の仮想ネットワークと仮想マシンを参照してください](/azure/virtual-machines/windows/network-overview)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-132">For a VM Scale Set, a NAT rule on the load balancer must be configured; see [Virtual networks and virtual machines in Azure](/azure/virtual-machines/windows/network-overview).</span></span>
- <span data-ttu-id="0c43b-133">アプリケーションホスト型メディア ボットは、Bot Framework エミュレーターではサポートされていません。</span><span class="sxs-lookup"><span data-stu-id="0c43b-133">Application-hosted media bots aren't supported by the Bot Framework Emulator.</span></span>

## <a name="scalability-and-performance-considerations"></a><span data-ttu-id="0c43b-134">スケーラビリティとパフォーマンスに関する検討事項</span><span class="sxs-lookup"><span data-stu-id="0c43b-134">Scalability and performance considerations</span></span>

- <span data-ttu-id="0c43b-135">アプリケーションホスト型メディア ボットは、メッセージング ボットよりも多くのコンピューティングおよびネットワーク (帯域幅) 容量を必要とし、運用コストが大幅に高くなる可能性があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-135">Application-hosted media bots require more compute and network (bandwidth) capacity than messaging bots and may incur significantly higher operational costs.</span></span> <span data-ttu-id="0c43b-136">リアルタイム メディア ボットの開発者は、ボットのスケーラビリティを慎重に測定し、ボットが管理できる数を超える同時呼び出しを受け付けずにいなければならない。</span><span class="sxs-lookup"><span data-stu-id="0c43b-136">A real-time media bot developer must carefully measure the bot's scalability, and ensure the bot doesn't accept more simultaneous calls than it can manage.</span></span> <span data-ttu-id="0c43b-137">ビデオ対応ボットは、CPU コアごとに 1 つまたは 2 つの同時メディア セッションのみを維持できる場合があります ("raw" RGB24 または NV12 ビデオ形式を使用する場合)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-137">A video-enabled bot may be able to sustain only one or two concurrent media sessions per CPU core (if using the "raw" RGB24 or NV12 video formats).</span></span>
- <span data-ttu-id="0c43b-138">現在、リアルタイム メディア プラットフォームでは、VM で利用可能なグラフィックス処理ユニット (GPU) を利用して H.264 ビデオ エンコード/デコードをオフロードしている必要があります。</span><span class="sxs-lookup"><span data-stu-id="0c43b-138">The Real-time Media Platform doesn't currently take advantage of any Graphics Processing Units (GPU) available on the VM to off-load H.264 video encoding/decoding.</span></span> <span data-ttu-id="0c43b-139">代わりに、ビデオエンコードとデコードは CPU 上のソフトウェアで行われます。</span><span class="sxs-lookup"><span data-stu-id="0c43b-139">Instead, video encode and decode are done in software on the CPU.</span></span> <span data-ttu-id="0c43b-140">GPU が利用可能な場合、ボットは独自のグラフィックス レンダリングで GPU を利用できます (ボットが 3D グラフィックス エンジンを使用している場合など)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-140">If a GPU is available, the bot may take advantage of it for its own graphics rendering (e.g. if the bot is using a 3D graphics engine).</span></span>
- <span data-ttu-id="0c43b-141">リアルタイム メディア ボットをホストする VM インスタンスには、少なくとも 2 つの CPU コアが必要です。</span><span class="sxs-lookup"><span data-stu-id="0c43b-141">The VM instance hosting the real-time media bot must have at least 2 CPU cores.</span></span> <span data-ttu-id="0c43b-142">Azure では、Dv2 シリーズ仮想マシンをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="0c43b-142">For Azure, a Dv2-series virtual machine is recommended.</span></span> <span data-ttu-id="0c43b-143">その他の Azure VM の種類では、4 つの仮想 CPU (vCPU) を備えるシステムが必要な最小サイズです。</span><span class="sxs-lookup"><span data-stu-id="0c43b-143">For other Azure VM types, a system with 4 virtual CPUs (vCPU) is the minimum size required.</span></span> <span data-ttu-id="0c43b-144">Azure VM の種類の詳細については、Azure のドキュメントを [参照してください](/azure/virtual-machines/windows/sizes-general)。</span><span class="sxs-lookup"><span data-stu-id="0c43b-144">Detailed information about Azure VM types is available in the [Azure documentation](/azure/virtual-machines/windows/sizes-general).</span></span>

## <a name="samples-and-additional-resources"></a><span data-ttu-id="0c43b-145">サンプルとその他のリソース</span><span class="sxs-lookup"><span data-stu-id="0c43b-145">Samples and Additional Resources</span></span>

- [<span data-ttu-id="0c43b-146">サンプル アプリケーション</span><span class="sxs-lookup"><span data-stu-id="0c43b-146">Sample applications</span></span>](https://github.com/microsoftgraph/microsoft-graph-comms-samples/tree/master/Samples/V1.0Samples/LocalMediaSamples)
- [<span data-ttu-id="0c43b-147">Graph Calling SDK ドキュメント</span><span class="sxs-lookup"><span data-stu-id="0c43b-147">Graph Calling SDK Documentation</span></span>](https://microsoftgraph.github.io/microsoft-graph-comms-samples/docs/)
