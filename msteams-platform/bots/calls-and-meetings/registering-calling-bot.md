---
title: Microsoft Teams での通話と会議のボットの登録
description: Microsoft Teams 用の新しい音声ビデオを呼び出すボットを登録する方法について説明します。
keywords: ボット音声/ビデオ音声ビデオメディアの呼び出し
ms.openlocfilehash: 5a832646d4fa622f746f88a3a969ae4ad3ce69a6
ms.sourcegitcommit: bfdcd122b6b4ffc52d92320d4741f870c07f0542
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/02/2020
ms.locfileid: "49552445"
---
# <a name="register-a-calling-bot-for-microsoft-teams"></a><span data-ttu-id="786df-104">Microsoft Teams 用の呼び出しボットを登録する</span><span class="sxs-lookup"><span data-stu-id="786df-104">Register a calling bot for Microsoft Teams</span></span>

<span data-ttu-id="786df-105">音声ビデオ通話やオンライン会議に参加する bot は、次のようないくつかの機能を備えた通常の Microsoft Teams bot です。</span><span class="sxs-lookup"><span data-stu-id="786df-105">A bot that participates in audio/video calls and online meetings is an ordinary Microsoft Teams bot with a few extra features:</span></span>

* <span data-ttu-id="786df-106">Teams アプリマニフェストの新バージョンとして、2つの追加設定とが用意さ `supportsCalling` `supportsVideo` れています。</span><span class="sxs-lookup"><span data-stu-id="786df-106">There's a new version of the Teams app manifest with two additional settings, `supportsCalling` and `supportsVideo`.</span></span> <span data-ttu-id="786df-107">これらの設定は、Microsoft Teams アプリマニフェストの [開発者プレビュー](../../resources/dev-preview/developer-preview-intro.md) バージョンに含まれています。</span><span class="sxs-lookup"><span data-stu-id="786df-107">These settings are included in the [Developer Preview](../../resources/dev-preview/developer-preview-intro.md) version of the Microsoft Teams app manifest.</span></span>
* <span data-ttu-id="786df-108">[Microsoft Graph のアクセス許可](./registering-calling-bot.md#add-microsoft-graph-permissions) は、ボットの MICROSOFT アプリ ID に対して構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="786df-108">[Microsoft Graph permissions](./registering-calling-bot.md#add-microsoft-graph-permissions) must be configured for your bot's Microsoft App ID.</span></span>
* <span data-ttu-id="786df-109">Microsoft Graph の呼び出しとオンライン会議の Api のアクセス許可には、テナント管理者の同意が必要です。</span><span class="sxs-lookup"><span data-stu-id="786df-109">The Microsoft Graph calls and online meetings APIs permissions require tenant admin consent.</span></span>

<span data-ttu-id="786df-110">詳細について説明します。</span><span class="sxs-lookup"><span data-stu-id="786df-110">Let's discuss the above in more detail.</span></span>

## <a name="new-manifest-settings"></a><span data-ttu-id="786df-111">新しいマニフェスト設定</span><span class="sxs-lookup"><span data-stu-id="786df-111">New manifest settings</span></span>

<span data-ttu-id="786df-112">通話とオンライン会議のボットには、Teams のボットに対して音声/ビデオを有効にするための manifest.jsに、次の2つの追加設定があります。</span><span class="sxs-lookup"><span data-stu-id="786df-112">Calling and online meetings bots have two additional settings in the manifest.json that enable audio/video for your bot in Teams.</span></span>

* <span data-ttu-id="786df-113">`bots[0].supportsCalling`.</span><span class="sxs-lookup"><span data-stu-id="786df-113">`bots[0].supportsCalling`.</span></span> <span data-ttu-id="786df-114">が存在し、に設定されている場合 `true` 、チームは、お客様が bot に通話とオンライン会議への参加を許可します。</span><span class="sxs-lookup"><span data-stu-id="786df-114">If present and set to `true`, Teams will allow your bot to participate in calls and online meetings.</span></span>
* <span data-ttu-id="786df-115">`bots[0].supportsVideo`.</span><span class="sxs-lookup"><span data-stu-id="786df-115">`bots[0].supportsVideo`.</span></span> <span data-ttu-id="786df-116">が存在し、に設定されている場合 `true` 、Teams は、ボットがビデオをサポートしていることを認識します。</span><span class="sxs-lookup"><span data-stu-id="786df-116">If present and set to `true`, Teams knows that your bot supports video.</span></span>

<span data-ttu-id="786df-117">このような値について、IDE で、呼び出し側と会議のスキーマの manifest.jsを適切に検証するには、次のように属性を変更し `$schema` ます。</span><span class="sxs-lookup"><span data-stu-id="786df-117">If you want your IDE to properly validate the manifest.json schema for your calling and meeting bot for these values, you can change the `$schema` attribute as follows:</span></span>

```json
"$schema": "https://raw.githubusercontent.com/OfficeDev/microsoft-teams-app-schema/preview/DevPreview/MicrosoftTeams.schema.json",
```

## <a name="creating-a-new-bot-or-adding-calling-capabilities-to-an-existing-bot"></a><span data-ttu-id="786df-118">新しい bot を作成するか、既存の bot に呼び出し機能を追加する</span><span class="sxs-lookup"><span data-stu-id="786df-118">Creating a new bot or adding calling capabilities to an existing bot</span></span>

<span data-ttu-id="786df-119">新しい bot を作成する方法については、「 [Microsoft Teams の bot を作成する](../how-to/create-a-bot-for-teams.md) 」トピックで詳しく説明されていますが、ここではその一部を繰り返します。</span><span class="sxs-lookup"><span data-stu-id="786df-119">Creating a new bot is covered in more detail in the [Create a bot for Microsoft Teams](../how-to/create-a-bot-for-teams.md) topic, but we'll repeat some of it here:</span></span>

1. <span data-ttu-id="786df-120">新しい bot を作成するには、このリンクを使用します。 `https://dev.botframework.com/bots/new`</span><span class="sxs-lookup"><span data-stu-id="786df-120">Use this link to create a new bot: `https://dev.botframework.com/bots/new`.</span></span> <span data-ttu-id="786df-121">代わりに、Bot フレームワークポータルで [ *bot を作成* する] ボタンを選択すると、Microsoft azure に bot が作成され、azure アカウントが必要になります。</span><span class="sxs-lookup"><span data-stu-id="786df-121">If, instead,  you select the *Create a bot* button in the Bot Framework portal, you will create your bot in Microsoft Azure, for which you'll need an Azure account.</span></span>
1. <span data-ttu-id="786df-122">Microsoft Teams チャネルを追加します。</span><span class="sxs-lookup"><span data-stu-id="786df-122">Add the Microsoft Teams channel.</span></span> <span data-ttu-id="786df-123">Microsoft Teams channel ページの [通話中] タブをクリックし、[ **通話を有効にする**] を選択してから、受信通知を受け取る HTTPS URL で **Webhook (通話用)** を更新します。たとえば、次のように `https://contoso.com/teamsapp/api/calling` します。</span><span class="sxs-lookup"><span data-stu-id="786df-123">Click on the "Calling" tab on the Microsoft Teams channel page and select **Enable calling**, and then update **Webhook (for calling)** with your HTTPS URL where you will receive incoming notifications, e.g.`https://contoso.com/teamsapp/api/calling`.</span></span> <span data-ttu-id="786df-124">チャネルを構成する方法の詳細については、「 [チャネルの構成](/bot-framework/portal-configure-channels) 」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="786df-124">Refer to [Configuring Channels](/bot-framework/portal-configure-channels) for more information on how to configure channels.</span></span>
  <span data-ttu-id="786df-125">![Microsoft Teams のチャネル情報を構成する](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span><span class="sxs-lookup"><span data-stu-id="786df-125">![Configure Microsoft Teams channel information](~/assets/images/calls-and-meetings/configure-msteams-channel.png)</span></span>

## <a name="add-microsoft-graph-permissions"></a><span data-ttu-id="786df-126">Microsoft Graph のアクセス許可を追加する</span><span class="sxs-lookup"><span data-stu-id="786df-126">Add Microsoft Graph permissions</span></span>

<span data-ttu-id="786df-127">Microsoft Graph では、アプリがリソースに対して持つアクセス権を制御する詳細なアクセス許可を公開しています。</span><span class="sxs-lookup"><span data-stu-id="786df-127">Microsoft Graph exposes granular permissions controlling the access that apps have to resources.</span></span> <span data-ttu-id="786df-128">開発者は、アプリが要求する Microsoft Graph のアクセス許可を決定します。</span><span class="sxs-lookup"><span data-stu-id="786df-128">As a developer, you decide which permissions for Microsoft Graph your app requests.</span></span>  <span data-ttu-id="786df-129">Microsoft Graph の呼び出し元の Api は、サインインしているユーザーなしで実行されるアプリで使用される _アプリケーションのアクセス許可_ をサポートします。</span><span class="sxs-lookup"><span data-stu-id="786df-129">The Microsoft Graph Calling APIs support _Application permissions_, which are used by apps that run without a signed-in user present.</span></span>  <span data-ttu-id="786df-130">テナント管理者は、アプリケーションのアクセス許可に同意を付与する必要があります。</span><span class="sxs-lookup"><span data-stu-id="786df-130">A tenant administrator must grant consent to application permissions.</span></span> <span data-ttu-id="786df-131">これらのアクセス許可の一覧を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="786df-131">Below is a list of those permissions:</span></span>

### <a name="application-permissions-calls"></a><span data-ttu-id="786df-132">アプリケーションのアクセス許可: 呼び出し</span><span class="sxs-lookup"><span data-stu-id="786df-132">Application permissions: calls</span></span>

|<span data-ttu-id="786df-133">アクセス許可</span><span class="sxs-lookup"><span data-stu-id="786df-133">Permission</span></span>    |<span data-ttu-id="786df-134">表示文字列</span><span class="sxs-lookup"><span data-stu-id="786df-134">Display String</span></span>   |<span data-ttu-id="786df-135">説明</span><span class="sxs-lookup"><span data-stu-id="786df-135">Description</span></span> |<span data-ttu-id="786df-136">管理者の同意が必要</span><span class="sxs-lookup"><span data-stu-id="786df-136">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="786df-137">_Calls.Initiate.All_</span><span class="sxs-lookup"><span data-stu-id="786df-137">_Calls.Initiate.All_</span></span>|<span data-ttu-id="786df-138">アプリからの発信 1 対 1 通話の開始 (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-138">Initiate outgoing 1:1 calls from the app (preview)</span></span>|<span data-ttu-id="786df-139">アプリで、サインインしているユーザーがいなくても、1 人のユーザーに発信し、組織のディレクトリ内のユーザーに通話を転送することができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-139">Allows the app to place outbound calls to a single user and transfer calls to users in your organization’s directory, without a signed-in user.</span></span>|<span data-ttu-id="786df-140">はい</span><span class="sxs-lookup"><span data-stu-id="786df-140">Yes</span></span>|
|<span data-ttu-id="786df-141">_Calls.InitiateGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="786df-141">_Calls.InitiateGroupCall.All_</span></span>|<span data-ttu-id="786df-142">アプリからの発信グループ通話の開始 (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-142">Initiate outgoing group calls from the app (preview)</span></span>|<span data-ttu-id="786df-143">アプリで、サインインしているユーザーがいなくても、複数のユーザーに発信し、組織内の会議に参加者を追加することができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-143">Allows the app to place outbound calls to multiple users and add participants to meetings in your organization, without a signed-in user.</span></span>|<span data-ttu-id="786df-144">はい</span><span class="sxs-lookup"><span data-stu-id="786df-144">Yes</span></span>|
|<span data-ttu-id="786df-145">_Calls.JoinGroupCall.All_</span><span class="sxs-lookup"><span data-stu-id="786df-145">_Calls.JoinGroupCall.All_</span></span>|<span data-ttu-id="786df-146">グループ通話と会議にアプリとして参加する (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-146">Join Group Calls and Meetings as an app (preview)</span></span>|<span data-ttu-id="786df-147">アプリで、サインインしているユーザーがいなくても、組織のグループ通話やスケジュールされた会議に参加することができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-147">Allows the app to join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="786df-148">このアプリは、ディレクトリ ユーザーの特権を使用してテナントの会議に参加します。</span><span class="sxs-lookup"><span data-stu-id="786df-148">The app will be joined with the privileges of a directory user to meetings in your tenant.</span></span>|<span data-ttu-id="786df-149">はい</span><span class="sxs-lookup"><span data-stu-id="786df-149">Yes</span></span>|
|<span data-ttu-id="786df-150">_Calls.JoinGroupCallasGuest.All_</span><span class="sxs-lookup"><span data-stu-id="786df-150">_Calls.JoinGroupCallasGuest.All_</span></span>|<span data-ttu-id="786df-151">グループ通話と会議にゲストとして参加する (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-151">Join Group Calls and Meetings as a guest (preview)</span></span>|<span data-ttu-id="786df-152">アプリで、サインインしているユーザーがいなくても、組織のグループ通話とスケジュールされた会議に匿名で参加することができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-152">Allows the app to anonymously join group calls and scheduled meetings in your organization, without a signed-in user.</span></span> <span data-ttu-id="786df-153">このアプリは、テナントの会議にゲストとして参加します。</span><span class="sxs-lookup"><span data-stu-id="786df-153">The app will be joined as a guest to meetings in your tenant.</span></span>|<span data-ttu-id="786df-154">はい</span><span class="sxs-lookup"><span data-stu-id="786df-154">Yes</span></span>|
|<span data-ttu-id="786df-155">_通話メディアを呼び出します。_ <sup>_以下を参照_</sup></span><span class="sxs-lookup"><span data-stu-id="786df-155">_Calls.AccessMedia.All_ <sup>_see below_</sup></span></span>|<span data-ttu-id="786df-156">通話内のメディア ストリームにアプリとしてアクセスする (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-156">Access media streams in a call as an app (preview)</span></span>|<span data-ttu-id="786df-157">アプリで、サインインしているユーザーがいなくても、通話内のメディア ストリームに直接アクセスすることができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-157">Allows the app to get direct access to media streams in a call, without a signed-in user.</span></span>|<span data-ttu-id="786df-158">はい</span><span class="sxs-lookup"><span data-stu-id="786df-158">Yes</span></span>|

> [!IMPORTANT]
> <span data-ttu-id="786df-159">メディアアクセス API を使用して、アプリケーションがアクセスする通話または会議のメディアコンテンツを記録または保存する **ことはできません**。また、そのメディアコンテンツ ("record" または "レコーディング") から派生したデータは、最初にその api を呼び出してレコーディングが開始されたことを示し、その api から成功応答を受け取ることもあり [ `updateRecordingStatus`](/graph/api/call-updaterecordingstatus)</span><span class="sxs-lookup"><span data-stu-id="786df-159">You **cannot** use the Media Access API to record or otherwise persist media content from calls or meetings that your application accesses, or data derived from that media content ("record" or "recording"), without first calling the [`updateRecordingStatus` API](/graph/api/call-updaterecordingstatus) to indicate that recording has begun, and receiving a success reply from that API.</span></span> <span data-ttu-id="786df-160">アプリケーションで会議または通話の記録を開始する場合、API を呼び出す前にレコーディングを終了して、 `updateRecordingStatus` レコーディングが終了したことを示す必要があります。</span><span class="sxs-lookup"><span data-stu-id="786df-160">If your application begins recording any meeting/call, it must end the recording prior to calling the `updateRecordingStatus` API to indicate that the recording has ended.</span></span>

### <a name="application-permissions-online-meetings"></a><span data-ttu-id="786df-161">アプリケーションのアクセス許可: オンライン会議</span><span class="sxs-lookup"><span data-stu-id="786df-161">Application permissions: online meetings</span></span>

|<span data-ttu-id="786df-162">アクセス許可</span><span class="sxs-lookup"><span data-stu-id="786df-162">Permission</span></span>    |<span data-ttu-id="786df-163">表示文字列</span><span class="sxs-lookup"><span data-stu-id="786df-163">Display String</span></span>   |<span data-ttu-id="786df-164">説明</span><span class="sxs-lookup"><span data-stu-id="786df-164">Description</span></span> |<span data-ttu-id="786df-165">管理者の同意が必要</span><span class="sxs-lookup"><span data-stu-id="786df-165">Admin Consent Required</span></span> |
|:-----------------------------|:-----------------------------------------|:-----------------|:-----------------|
|<span data-ttu-id="786df-166">_OnlineMeetings.Read.All_</span><span class="sxs-lookup"><span data-stu-id="786df-166">_OnlineMeetings.Read.All_</span></span>|<span data-ttu-id="786df-167">アプリからオンライン会議の詳細を読み取る (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-167">Read Online Meeting details from the app (preview)</span></span>|<span data-ttu-id="786df-168">アプリで、サインインしているユーザーがいなくても、組織内のすべてのオンライン会議を読み取ることができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-168">Allows the app to read Online Meeting details in your organization, without a signed-in user.</span></span>|<span data-ttu-id="786df-169">はい</span><span class="sxs-lookup"><span data-stu-id="786df-169">Yes</span></span>|
|<span data-ttu-id="786df-170">_OnlineMeetings.ReadWrite.All_</span><span class="sxs-lookup"><span data-stu-id="786df-170">_OnlineMeetings.ReadWrite.All_</span></span>|<span data-ttu-id="786df-171">サインインしているユーザーの代わりにアプリが行うオンライン会議の読み取りと作成 (プレビュー)</span><span class="sxs-lookup"><span data-stu-id="786df-171">Read and Create Online Meetings from the app (preview) on behalf of a user</span></span>|<span data-ttu-id="786df-172">アプリで、サインインしているユーザーがいなくても、ユーザーの代わりに、組織内のオンライン会議を作成することができるようにします。</span><span class="sxs-lookup"><span data-stu-id="786df-172">Allows the app to create Online Meetings in your organization on behalf of a user, without a signed-in user.</span></span>|<span data-ttu-id="786df-173">はい</span><span class="sxs-lookup"><span data-stu-id="786df-173">Yes</span></span>|

### <a name="assigning-permissions"></a><span data-ttu-id="786df-174">権限を割り当てる</span><span class="sxs-lookup"><span data-stu-id="786df-174">Assigning permissions</span></span>

<span data-ttu-id="786df-175">[AZURE AD V1 エンドポイント](/azure/active-directory/develop/azure-ad-endpoint-comparison)を使用する場合は、 [azure ポータル](https://aka.ms/aadapplist)を使用して、ボットのアプリケーション権限を事前に構成する必要があります。</span><span class="sxs-lookup"><span data-stu-id="786df-175">You must configure the application permissions for your bot in advance by using the [Azure portal](https://aka.ms/aadapplist) if you prefer to use the [Azure AD V1 endpoint](/azure/active-directory/develop/azure-ad-endpoint-comparison).</span></span>

### <a name="getting-tenant-administrator-consent"></a><span data-ttu-id="786df-176">テナント管理者の同意を取得する</span><span class="sxs-lookup"><span data-stu-id="786df-176">Getting tenant administrator consent</span></span>

<span data-ttu-id="786df-177">Azure AD V1 エンドポイントを使用するアプリの場合、テナント管理者は、アプリが組織にインストールされているときに、 [azure portal](https://portal.azure.com) を使用してアプリケーションのアクセス許可に同意することができます。または、構成したアクセス許可を管理者が承認できるようにするためのサインアップの機能をアプリで提供することができます。</span><span class="sxs-lookup"><span data-stu-id="786df-177">For apps using the Azure AD V1 endpoint, a tenant administrator can consent to the application permissions using the [Azure portal](https://portal.azure.com) when your app is installed in their organization, or you can provide a sign-up experience in your app through which administrators can consent to the permissions you configured.</span></span> <span data-ttu-id="786df-178">管理者の同意が Azure AD によって記録されると、アプリは同意を要求せずにトークンを要求できます。</span><span class="sxs-lookup"><span data-stu-id="786df-178">Once administrator consent is recorded by Azure AD, your app can request tokens without having to request consent again.</span></span>

<span data-ttu-id="786df-179">[Azure ポータル](https://portal.azure.com)でアプリに必要なアクセス許可を管理者に付与することができます。ただし、多くの場合、Azure AD V2 エンドポイントを使用して管理者にサインアップのための機能を提供することをお勧め `/adminconsent` します。</span><span class="sxs-lookup"><span data-stu-id="786df-179">You can rely on an administrator to grant the permissions your app needs at the [Azure portal](https://portal.azure.com); though, often a better option is to provide a sign-up experience for administrators by using the Azure AD V2 `/adminconsent` endpoint.</span></span>  <span data-ttu-id="786df-180">詳細については、「 [管理者の同意の URL](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) を作成する」の手順を参照してください。</span><span class="sxs-lookup"><span data-stu-id="786df-180">Please refer to the [instructions on constructing an Admin Consent URL](https://developer.microsoft.com/graph/docs/concepts/auth_v2_service#3-get-administrator-consent) for more information.</span></span>

> [!NOTE]
> <span data-ttu-id="786df-181">テナント管理者の同意 URL を作成するには、 [アプリ登録ポータル](https://apps.dev.microsoft.com/)に構成されたリダイレクト URI/応答 url が必要です。</span><span class="sxs-lookup"><span data-stu-id="786df-181">Constructing the Tenant Admin Consent URL requires a configured Redirect URI/Reply URL in the [App Registration Portal](https://apps.dev.microsoft.com/).</span></span> <span data-ttu-id="786df-182">Bot の応答 Url を追加するには、ボット登録にアクセスし、[Advanced Options-> 編集アプリケーションマニフェスト] を選択します。</span><span class="sxs-lookup"><span data-stu-id="786df-182">To add reply URLs for your bot, access your bot registration, choose Advanced Options -> Edit Application Manifest.</span></span>  <span data-ttu-id="786df-183">リダイレクト URL をコレクションに追加 `replyUrls` します。</span><span class="sxs-lookup"><span data-stu-id="786df-183">Add your Redirect URL to the `replyUrls` collection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="786df-184">アプリケーションのアクセス許可を変更するときは常に、管理者の同意プロセスも繰り返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="786df-184">Anytime you make a change to your application's permissions, you must also repeat the Admin Consent process.</span></span> <span data-ttu-id="786df-185">アプリ登録ポータルで行われた変更は、テナント管理者が同意を再適用するまで反映されません。</span><span class="sxs-lookup"><span data-stu-id="786df-185">Changes made in the app registration portal will not be reflected until consent has been reapplied by the tenant's administrator.</span></span>
