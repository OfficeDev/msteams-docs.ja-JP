---
title: Bot の基本
author: clearab
description: Teams でのボットの基本事項について説明します。
ms.topic: conceptual
ms.author: anclear
ms.openlocfilehash: e1b0c79b73ae89c8ab76ba0a1ff045603ab0b932
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674790"
---
# <a name="bot-basics"></a><span data-ttu-id="86d1d-103">Bot の基本</span><span class="sxs-lookup"><span data-stu-id="86d1d-103">Bot basics</span></span>

<span data-ttu-id="86d1d-104">この記事では、「core [Bot Framework」ドキュメント](https://aka.ms/azure-bot-service-docs)での[ボットの機能](https://aka.ms/how-bots-work)について説明します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-104">This is an introduction that builds on the article [How bots work](https://aka.ms/how-bots-work) in the core [Bot Framework documentation](https://aka.ms/azure-bot-service-docs).</span></span> <span data-ttu-id="86d1d-105">この記事やその他の記事については、「*概念*」の「役に立つ場合があります。</span><span class="sxs-lookup"><span data-stu-id="86d1d-105">You may find that article, and the other articles in the *Concepts* section, useful.</span></span>

<span data-ttu-id="86d1d-106">Microsoft Teams 向けに開発された bot の主な違いは、アクティビティの処理方法です。</span><span class="sxs-lookup"><span data-stu-id="86d1d-106">The primary difference in bots developed for Microsoft Teams is in how activities are handled.</span></span> <span data-ttu-id="86d1d-107">Microsoft Teams アクティビティハンドラーは、ボットフレームワークのアクティビティハンドラーから派生して、teams 以外のすべてのアクティビティを処理できるようにする前に、すべての Teams アクティビティをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-107">The Microsoft Teams activity handler derives from the Bot Framework's activity handler to route all Teams activities before allowing any non-Teams specific activities to be handled.</span></span>

## <a name="teams-activity-handlers"></a><span data-ttu-id="86d1d-108">Teams アクティビティハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-108">Teams Activity handlers</span></span>

<span data-ttu-id="86d1d-109">Microsoft Teams の bot がアクティビティを受信すると、そのアクティビティは*アクティビティハンドラー*に渡されます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-109">When a bot for Microsoft Teams receives an activity, it passes it on to its *activity handlers*.</span></span> <span data-ttu-id="86d1d-110">この記事では、 *turn ハンドラー*と呼ばれる基本的なハンドラーが1つあります。これには、すべてのアクティビティがルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-110">Under the covers, there's one base handler called the *turn handler*, that all activities are routed through.</span></span> <span data-ttu-id="86d1d-111">*Turn ハンドラー*は、どの種類のアクティビティを受信したかを処理するために必要なアクティビティハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-111">The *turn handler* calls the required activity handler to handle whatever type of activity was received.</span></span> <span data-ttu-id="86d1d-112">Microsoft Teams 向けに設計された bot は、ボットフレームワークの`TeamsActivityHandler` `ActivityHandler`クラスから派生したクラスから派生したものであるという点が異なります。</span><span class="sxs-lookup"><span data-stu-id="86d1d-112">Where a bot designed for Microsoft Teams differs is that it is derived from `TeamsActivityHandler` class that is derived from the Bot Framework's `ActivityHandler` class.</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="86d1d-113">C#</span><span class="sxs-lookup"><span data-stu-id="86d1d-113">C#</span></span>](#tab/csharp)

<span data-ttu-id="86d1d-114">Microsoft Bot フレームワークを使用して作成された bot と同様に、bot がメッセージアクティビティを受信すると、turn ハンドラーはその受信アクティビティ`OnMessageActivityAsync`を認識し、アクティビティハンドラーに送信します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-114">As with any bot created using the Microsoft Bot Framework, if the bot receives a message activity, the turn handler sees that incoming activity and sends it to the `OnMessageActivityAsync` activity handler.</span></span> <span data-ttu-id="86d1d-115">Teams では、この機能は変わりません。</span><span class="sxs-lookup"><span data-stu-id="86d1d-115">In Teams, this functionality remains the same.</span></span> <span data-ttu-id="86d1d-116">Bot が会話更新アクティビティを受信した場合、turn ハンドラーはその受信アクティビティを認識して`OnConversationUpdateActivityAsync` *teams*アクティビティハンドラーに送信します。これにより、チーム固有のイベントがあるかどうかが最初にチェックされ、見つからない場合は bot フレームワークのアクティビティハンドラーに渡されます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-116">If the bot receives a conversation update activity, the turn handler sees that incoming activity and sends it to the `OnConversationUpdateActivityAsync` *Teams* activity handler that will first check for any Teams specific events and pass it along to the Bot Framework's activity handler if none are found.</span></span>

<span data-ttu-id="86d1d-117">Teams activity handler クラスには、2つの主な Teams アクティビティハンドラー `OnConversationUpdateActivityAsync`があります。これは、すべて`OnInvokeActivityAsync`の会話更新アクティビティをルーティングし、すべてのチーム呼び出しアクティビティをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-117">In the Teams activity handler class, there are two primary Teams activity handlers, `OnConversationUpdateActivityAsync` that routes all conversation update activities, and `OnInvokeActivityAsync` that routes all Teams invoke activities.</span></span>

<span data-ttu-id="86d1d-118">Teams 固有のアクティビティハンドラーのロジックを実装するには、以下の「 [bot ロジック](#bot-logic)」セクションで示されているように、bot でこれらのメソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-118">To implement your logic for Teams specific activity handlers, you'll override these methods in your bot as shown in the [Bot logic](#bot-logic) section below.</span></span> <span data-ttu-id="86d1d-119">これらの各ハンドラーには基本実装はありません。そのため、オーバーライドに必要なロジックを追加するだけです。</span><span class="sxs-lookup"><span data-stu-id="86d1d-119">For each of these handlers, there is no base implementation, so just add the logic that you want in your override.</span></span>

# <a name="javascripttabjavascript"></a>[<span data-ttu-id="86d1d-120">JavaScript</span><span class="sxs-lookup"><span data-stu-id="86d1d-120">JavaScript</span></span>](#tab/javascript)

<span data-ttu-id="86d1d-121">Microsoft Bot フレームワークを使用して作成された bot と同様に、bot がメッセージアクティビティを受信すると、turn ハンドラーはその受信アクティビティ`onMessage`を認識し、アクティビティハンドラーに送信します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-121">As with any bot created using the Microsoft Bot Framework, if the bot receives a message activity, the turn handler sees that incoming activity and sends it to the `onMessage` activity handler.</span></span> <span data-ttu-id="86d1d-122">Teams では、この機能は変わりません。</span><span class="sxs-lookup"><span data-stu-id="86d1d-122">In Teams, this functionality remains the same.</span></span> <span data-ttu-id="86d1d-123">Bot が会話更新アクティビティを受信した場合、turn ハンドラーはその受信アクティビティを認識して`dispatchConversationUpdateActivity` *teams*アクティビティハンドラーに送信します。これにより、チーム固有のイベントがあるかどうかが最初にチェックされ、見つからない場合は bot フレームワークアクティビティハンドラーに渡されます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-123">If the bot receives a conversation update activity, the turn handler sees that incoming activity and sends it to the `dispatchConversationUpdateActivity` *Teams* activity handler that will first check for any Teams specific events and pass it along to the bot frameworks activity handler if none are found.</span></span>

<span data-ttu-id="86d1d-124">Teams activity handler クラスには、2つの主な Teams アクティビティハンドラー `dispatchConversationUpdateActivity`があります。これは、すべて`onInvokeActivity`の会話更新アクティビティをルーティングし、すべてのチーム呼び出しアクティビティをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-124">In the Teams activity handler class, there are two primary Teams activity handlers, `dispatchConversationUpdateActivity` that routes all conversation update Activities, and `onInvokeActivity` that routes all Teams invoke activities.</span></span>

<span data-ttu-id="86d1d-125">Teams 固有のアクティビティハンドラーのロジックを実装するには、以下の「 [bot ロジック](#bot-logic)」セクションに示されているように、bot でこれらのメソッドをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-125">To implement your logic for Teams specific activity handlers, you'll override these methods in your bot as seen in the [Bot logic](#bot-logic) section below.</span></span> <span data-ttu-id="86d1d-126">これらの各ハンドラーに対して、bot ロジックを定義してから、\*\*必ず最後にを呼び出し`next()` \*\*ます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-126">For each of these handlers, define your bot logic, then **be sure to call `next()` at the end**.</span></span> <span data-ttu-id="86d1d-127">呼び出し`next()`により、次のハンドラーが実行されることを確認します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-127">By calling `next()` you ensure that the next handler runs.</span></span>

---

## <a name="bot-logic"></a><span data-ttu-id="86d1d-128">Bot ロジック</span><span class="sxs-lookup"><span data-stu-id="86d1d-128">Bot logic</span></span>

<span data-ttu-id="86d1d-129">Bot ロジックは、1つ以上の bot チャネルからの受信アクティビティを処理し、応答で送信アクティビティを生成します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-129">The bot logic processes incoming activities from one or more of your bot channels and generates outgoing activities in response.</span></span>  <span data-ttu-id="86d1d-130">Teams アクティビティハンドラクラスから派生したボットの場合もあります。これは、最初に Teams アクティビティをチェックし、その他のすべてのアクティビティを bot フレームワークアクティビティハンドラーに渡します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-130">This is still true of bots derived from the Teams activity handler class, which first checks for Teams activities, then passes all other activities to the bot frameworks activity handler.</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="86d1d-131">C#</span><span class="sxs-lookup"><span data-stu-id="86d1d-131">C#</span></span>](#tab/csharp)

#### <a name="core-bot-framework-handlers"></a><span data-ttu-id="86d1d-132">コアボットフレームワークハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-132">Core Bot Framework handlers</span></span>

<span data-ttu-id="86d1d-133">以下で説明するすべてのアクティビティハンドラーは、Teams 以外の bot を使用した場合と同じように機能します。ただし、メンバーを*追加*したり、メンバーを*削除*したりすることは例外で、これらはチームのコンテキストでは異なり、メッセージスレッドではなくチームに新しいメンバーが追加されます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-133">All of the activity handlers described below will continue to work as they do with a non-Teams bot, with the exception of handling members *added* and members *removed* activities, these will be different in the context of a team, where the new member is added to the team as opposed to a message thread.</span></span>

<span data-ttu-id="86d1d-134">で`ActivityHandler`定義されているハンドラの概要を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-134">The handlers defined in `ActivityHandler` are outlined below.</span></span>

| <span data-ttu-id="86d1d-135">イベント</span><span class="sxs-lookup"><span data-stu-id="86d1d-135">Event</span></span> | <span data-ttu-id="86d1d-136">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-136">Handler</span></span> | <span data-ttu-id="86d1d-137">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-137">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="86d1d-138">受信したすべてのアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-138">Any activity type received</span></span> | `OnTurnAsync` | <span data-ttu-id="86d1d-139">受信したアクティビティの種類に基づいて、他のいずれかのハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-139">Calls one of the other handlers, based on the type of activity received.</span></span> |
| <span data-ttu-id="86d1d-140">受信したメッセージアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-140">Message activity received</span></span> | `OnMessageActivityAsync` | <span data-ttu-id="86d1d-141">アクティビティを`Message`処理するためにオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-141">Override this to handle a `Message` activity.</span></span> |
| <span data-ttu-id="86d1d-142">受信した会話の更新アクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-142">Conversation update activity received</span></span> | `OnConversationUpdateActivityAsync` | <span data-ttu-id="86d1d-143">`ConversationUpdate`アクティビティで、会話に参加または残された bot 以外のメンバーがいる場合は、ハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-143">On a `ConversationUpdate` activity, calls a handler if members other than the bot joined or left the conversation.</span></span> |
| <span data-ttu-id="86d1d-144">Bot 以外のメンバーが会話に参加した</span><span class="sxs-lookup"><span data-stu-id="86d1d-144">Non-bot members joined the conversation</span></span> | `OnMembersAddedAsync` | <span data-ttu-id="86d1d-145">会話に参加しているメンバーを処理するには、このをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-145">Override this to handle members joining a conversation.</span></span> |
| <span data-ttu-id="86d1d-146">Bot 以外のメンバーが会話に出た</span><span class="sxs-lookup"><span data-stu-id="86d1d-146">Non-bot members left the conversation</span></span> | `OnMembersRemovedAsync` | <span data-ttu-id="86d1d-147">会話を残しているメンバーを処理するには、このをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-147">Override this to handle members leaving a conversation.</span></span> |
| <span data-ttu-id="86d1d-148">受信したイベントアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-148">Event activity received</span></span> | `OnEventActivityAsync` | <span data-ttu-id="86d1d-149">`Event`アクティビティで、はイベントの種類に固有のハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-149">On an `Event` activity, calls a handler specific to the event type.</span></span> |
| <span data-ttu-id="86d1d-150">受信したトークン応答イベントアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-150">Token-response event activity received</span></span> | `OnTokenResponseEventAsync` | <span data-ttu-id="86d1d-151">トークン応答イベントを処理するためにオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-151">Override this to handle token response events.</span></span> |
| <span data-ttu-id="86d1d-152">トークンに応答しないイベントの処理</span><span class="sxs-lookup"><span data-stu-id="86d1d-152">Non-token-response event activity received</span></span> | `OnEventAsync` | <span data-ttu-id="86d1d-153">これをオーバーライドして、他の種類のイベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-153">Override this to handle other types of events.</span></span> |
| <span data-ttu-id="86d1d-154">受信したその他のアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-154">Other activity type received</span></span> | `OnUnrecognizedActivityTypeAsync` | <span data-ttu-id="86d1d-155">それ以外の処理の種類を処理するには、このオプションを無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-155">Override this to handle any activity type otherwise unhandled.</span></span> |

#### <a name="teams-specific-handlers"></a><span data-ttu-id="86d1d-156">Teams 固有のハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-156">Teams-specific handlers</span></span>

<span data-ttu-id="86d1d-157">で`TeamsActivityHandler`は、上のハンドラーの一覧を拡張して、次のものを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-157">The `TeamsActivityHandler` extends the list of handlers above to include the following:</span></span>

| <span data-ttu-id="86d1d-158">イベント</span><span class="sxs-lookup"><span data-stu-id="86d1d-158">Event</span></span> | <span data-ttu-id="86d1d-159">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-159">Handler</span></span> | <span data-ttu-id="86d1d-160">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-160">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="86d1d-161">channelCreated</span><span class="sxs-lookup"><span data-stu-id="86d1d-161">channelCreated</span></span> | `OnTeamsChannelCreatedAsync` | <span data-ttu-id="86d1d-162">作成する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-162">Override this to handle a Teams channel being created.</span></span> <span data-ttu-id="86d1d-163">詳細については、「[スレッド更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)で[作成されるチャネル](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-163">For more information see [Channel created](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="86d1d-164">channelDeleted</span><span class="sxs-lookup"><span data-stu-id="86d1d-164">channelDeleted</span></span> | `OnTeamsChannelDeletedAsync` | <span data-ttu-id="86d1d-165">削除する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-165">Override this to handle a Teams channel being deleted.</span></span> <span data-ttu-id="86d1d-166">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)で[削除されるチャネル](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-166">For more information see [Channel deleted](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="86d1d-167">channelRenamed 名前変更</span><span class="sxs-lookup"><span data-stu-id="86d1d-167">channelRenamed</span></span> | `OnTeamsChannelRenamedAsync` | <span data-ttu-id="86d1d-168">名前を変更する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-168">Override this to handle a Teams channel being renamed.</span></span> <span data-ttu-id="86d1d-169">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チャネル名の変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-169">For more information see [Channel renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="86d1d-170">teamRenamed 名前変更</span><span class="sxs-lookup"><span data-stu-id="86d1d-170">teamRenamed</span></span> | `OnTeamsTeamRenamedAsync` | <span data-ttu-id="86d1d-171">`return Task.CompletedTask;`名前を変更する Teams チームを処理するには、この操作を上書きします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-171">`return Task.CompletedTask;` Override this to handle a Teams Team being Renamed.</span></span> <span data-ttu-id="86d1d-172">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チーム名の変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-172">For more information see [Team renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="86d1d-173">メンバーが追加されました</span><span class="sxs-lookup"><span data-stu-id="86d1d-173">MembersAdded</span></span> | `OnTeamsMembersAddedAsync` | <span data-ttu-id="86d1d-174">で`ActivityHandler`メソッド`OnMembersAddedAsync`を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-174">Calls the `OnMembersAddedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="86d1d-175">チームに参加するメンバーを処理するには、これをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-175">Override this to handle members joining a team.</span></span> <span data-ttu-id="86d1d-176">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)に[チームメンバーが追加されました](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-176">For more information see [Team member added](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="86d1d-177">メンバーの削除</span><span class="sxs-lookup"><span data-stu-id="86d1d-177">MembersRemoved</span></span> | `OnTeamsMembersRemovedAsync` | <span data-ttu-id="86d1d-178">で`ActivityHandler`メソッド`OnMembersRemovedAsync`を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-178">Calls the `OnMembersRemovedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="86d1d-179">チームを離れるメンバーを処理するためにオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-179">Override this to handle members leaving a team.</span></span> <span data-ttu-id="86d1d-180">詳細については、「[スレッド更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チームメンバーの削除](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-180">For more information see [Team member removed](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|

#### <a name="teams-invoke--activities"></a><span data-ttu-id="86d1d-181">Teams がアクティビティを呼び出す</span><span class="sxs-lookup"><span data-stu-id="86d1d-181">Teams invoke  activities</span></span>

<span data-ttu-id="86d1d-182">`OnInvokeActivityAsync` _Teams_アクティビティハンドラーから呼び出されたすべての teams アクティビティハンドラーのリストを次に示します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-182">Here is a list of all of the Teams activity handlers called from the `OnInvokeActivityAsync` _Teams_ activity handler:</span></span>

| <span data-ttu-id="86d1d-183">呼び出しの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-183">Invoke types</span></span>                    | <span data-ttu-id="86d1d-184">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-184">Handler</span></span>                              | <span data-ttu-id="86d1d-185">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-185">Description</span></span>                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| <span data-ttu-id="86d1d-186">CardAction. Invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-186">CardAction.Invoke</span></span>               | `OnTeamsCardActionInvokeAsync`       | <span data-ttu-id="86d1d-187">Teams カードアクションの呼び出し。</span><span class="sxs-lookup"><span data-stu-id="86d1d-187">Teams Card Action Invoke.</span></span> |
| <span data-ttu-id="86d1d-188">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-188">fileConsent/invoke</span></span>              | `OnTeamsFileConsentAcceptAsync`      | <span data-ttu-id="86d1d-189">Teams ファイルの同意を承諾します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-189">Teams File Consent Accept.</span></span> |
| <span data-ttu-id="86d1d-190">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-190">fileConsent/invoke</span></span>              | `OnTeamsFileConsentAsync`            | <span data-ttu-id="86d1d-191">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="86d1d-191">Teams File Consent.</span></span> |
| <span data-ttu-id="86d1d-192">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-192">fileConsent/invoke</span></span>              | `OnTeamsFileConsentDeclineAsync`     | <span data-ttu-id="86d1d-193">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="86d1d-193">Teams File Consent.</span></span> |
| <span data-ttu-id="86d1d-194">actionableMessage/executeAction</span><span class="sxs-lookup"><span data-stu-id="86d1d-194">actionableMessage/executeAction</span></span> | `OnTeamsO365ConnectorCardActionAsync` | <span data-ttu-id="86d1d-195">Teams O365 コネクタカードアクション。</span><span class="sxs-lookup"><span data-stu-id="86d1d-195">Teams O365 Connector Card Action.</span></span> |
| <span data-ttu-id="86d1d-196">サインイン/verifyState</span><span class="sxs-lookup"><span data-stu-id="86d1d-196">signin/verifyState</span></span>              | `OnTeamsSigninVerifyStateAsync`      | <span data-ttu-id="86d1d-197">Teams サインイン状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-197">Teams Sign in Verify State.</span></span> |
| <span data-ttu-id="86d1d-198">タスク/フェッチ</span><span class="sxs-lookup"><span data-stu-id="86d1d-198">task/fetch</span></span>                      | `OnTeamsTaskModuleFetchAsync`        | <span data-ttu-id="86d1d-199">Teams タスクモジュールのフェッチ。</span><span class="sxs-lookup"><span data-stu-id="86d1d-199">Teams Task Module Fetch.</span></span> |
| <span data-ttu-id="86d1d-200">タスク/提出</span><span class="sxs-lookup"><span data-stu-id="86d1d-200">task/submit</span></span>                     | `OnTeamsTaskModuleSubmitAsync`       | <span data-ttu-id="86d1d-201">Teams タスクモジュール提出。</span><span class="sxs-lookup"><span data-stu-id="86d1d-201">Teams Task Module Submit.</span></span> |

<span data-ttu-id="86d1d-202">上記の呼び出しアクティビティは Teams の会話のボットに対応しています。</span><span class="sxs-lookup"><span data-stu-id="86d1d-202">The invoke activities listed above are for conversational bots in Teams.</span></span> <span data-ttu-id="86d1d-203">Bot フレームワーク SDK は、メッセージング拡張機能に固有の呼び出しもサポートしています。</span><span class="sxs-lookup"><span data-stu-id="86d1d-203">The Bot Framework SDK also supports invokes specific to messaging extensions.</span></span> <span data-ttu-id="86d1d-204">詳細について[は、「メッセージング拡張機能に](https://aka.ms/azure-bot-what-are-messaging-extensions)ついて」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-204">For more information see [What are messaging extensions](https://aka.ms/azure-bot-what-are-messaging-extensions)</span></span>

# <a name="javascripttabjavascript"></a>[<span data-ttu-id="86d1d-205">JavaScript</span><span class="sxs-lookup"><span data-stu-id="86d1d-205">JavaScript</span></span>](#tab/javascript)

<span data-ttu-id="86d1d-206">以下で説明するすべてのアクティビティハンドラーは、Teams 以外の bot を使用した場合と同じように動作します。ただし、メンバーを*追加*したり、メンバーを*削除*したりすることは例外です。これらは、メッセージスレッドではなくチームに新しいメンバーが追加されるチームのコンテキストでは異なります。</span><span class="sxs-lookup"><span data-stu-id="86d1d-206">All of the activity handlers described below will continue to work as they do with a non-Teams bot, with the exception of handling the members *added* and members *removed* activities, these will be different in the context of a team, where the new member is added to the team as opposed to a message thread.</span></span>

#### <a name="core-bot-framework-handlers"></a><span data-ttu-id="86d1d-207">コアボットフレームワークハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-207">Core Bot Framework handlers</span></span>

<span data-ttu-id="86d1d-208">で`ActivityHandler`定義されているハンドラの概要を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-208">The handlers defined in `ActivityHandler` are outlined below.</span></span>

| <span data-ttu-id="86d1d-209">イベント</span><span class="sxs-lookup"><span data-stu-id="86d1d-209">Event</span></span> | <span data-ttu-id="86d1d-210">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-210">Handler</span></span> | <span data-ttu-id="86d1d-211">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-211">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="86d1d-212">受信したすべてのアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-212">Any activity type received</span></span> | `onTurn` | <span data-ttu-id="86d1d-213">受信したアクティビティの種類に基づいて、他のいずれかのハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-213">Calls one of the other handlers, based on the type of activity received.</span></span> |
| <span data-ttu-id="86d1d-214">受信したメッセージアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-214">Message activity received</span></span> | `onMessage` | <span data-ttu-id="86d1d-215">`Message`アクティビティを処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-215">Provide a function for this to handle a `Message` activity.</span></span> |
| <span data-ttu-id="86d1d-216">受信した会話の更新アクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-216">Conversation update activity received</span></span> | `onConversationUpdate` | <span data-ttu-id="86d1d-217">`ConversationUpdate`アクティビティで、会話に参加または残された bot 以外のメンバーがいる場合は、ハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-217">On a `ConversationUpdate` activity, calls a handler if members other than the bot joined or left the conversation.</span></span> |
| <span data-ttu-id="86d1d-218">Bot 以外のメンバーが会話に参加した</span><span class="sxs-lookup"><span data-stu-id="86d1d-218">Non-bot members joined the conversation</span></span> | `onMembersAdded` | <span data-ttu-id="86d1d-219">会話に参加するメンバーを処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-219">Provide a function for this to handle members joining a conversation.</span></span> |
| <span data-ttu-id="86d1d-220">Bot 以外のメンバーが会話に出た</span><span class="sxs-lookup"><span data-stu-id="86d1d-220">Non-bot members left the conversation</span></span> | `onMembersRemoved` | <span data-ttu-id="86d1d-221">会話を残しているメンバーを処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-221">Provide a function for this to handle members leaving a conversation.</span></span> |
| <span data-ttu-id="86d1d-222">受信したイベントアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-222">Event activity received</span></span> | `onEvent` | <span data-ttu-id="86d1d-223">`Event`アクティビティで、はイベントの種類に固有のハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-223">On an `Event` activity, calls a handler specific to the event type.</span></span> |
| <span data-ttu-id="86d1d-224">受信したトークン応答イベントアクティビティ</span><span class="sxs-lookup"><span data-stu-id="86d1d-224">Token-response event activity received</span></span> | `onTokenResponseEvent` | <span data-ttu-id="86d1d-225">トークン応答イベントを処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-225">Provide a function for this to handle token response events.</span></span> |
| <span data-ttu-id="86d1d-226">受信したその他のアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-226">Other activity type received</span></span> | `onUnrecognizedActivityType` | <span data-ttu-id="86d1d-227">それ以外の処理の種類を処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-227">Provide a function for this to handle any activity type otherwise unhandled.</span></span> |
| <span data-ttu-id="86d1d-228">アクティビティハンドラーが完了しました</span><span class="sxs-lookup"><span data-stu-id="86d1d-228">Activity handlers have completed</span></span> | `onDialog` | <span data-ttu-id="86d1d-229">アクティビティハンドラーの残りの処理が完了した後で、ターンの最後に実行する必要がある処理を処理するための関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-229">Provide a function for this to handle any processing that should be done at the end of a turn, after the rest of your activity handlers have completed.</span></span> |

#### <a name="teams-specific-handlers"></a><span data-ttu-id="86d1d-230">Teams 固有のハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-230">Teams-specific handlers</span></span>

<span data-ttu-id="86d1d-231">で`TeamsActivityHandler`は、上のハンドラーの一覧を拡張して、次のものを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="86d1d-231">The `TeamsActivityHandler` extends the list of handlers above to include the following:</span></span>

| <span data-ttu-id="86d1d-232">イベント</span><span class="sxs-lookup"><span data-stu-id="86d1d-232">Event</span></span> | <span data-ttu-id="86d1d-233">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-233">Handler</span></span> | <span data-ttu-id="86d1d-234">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-234">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="86d1d-235">channelCreated</span><span class="sxs-lookup"><span data-stu-id="86d1d-235">channelCreated</span></span> | `OnTeamsChannelCreatedAsync` | <span data-ttu-id="86d1d-236">作成する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-236">Override this to handle a Teams channel being created.</span></span> <span data-ttu-id="86d1d-237">詳細については、「[スレッド更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)で[作成されるチャネル](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-237">For more information see [Channel created](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="86d1d-238">channelDeleted</span><span class="sxs-lookup"><span data-stu-id="86d1d-238">channelDeleted</span></span> | `OnTeamsChannelDeletedAsync` | <span data-ttu-id="86d1d-239">削除する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-239">Override this to handle a Teams channel being deleted.</span></span> <span data-ttu-id="86d1d-240">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)で[削除されるチャネル](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-240">For more information see [Channel deleted](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="86d1d-241">channelRenamed 名前変更</span><span class="sxs-lookup"><span data-stu-id="86d1d-241">channelRenamed</span></span> | `OnTeamsChannelRenamedAsync` | <span data-ttu-id="86d1d-242">名前を変更する Teams チャネルを処理するには、この機能を無効にします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-242">Override this to handle a Teams channel being renamed.</span></span> <span data-ttu-id="86d1d-243">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チャネル名の変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-243">For more information see [Channel renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="86d1d-244">teamRenamed 名前変更</span><span class="sxs-lookup"><span data-stu-id="86d1d-244">teamRenamed</span></span> | `OnTeamsTeamRenamedAsync` | <span data-ttu-id="86d1d-245">`return Task.CompletedTask;`名前を変更する Teams チームを処理するには、この操作を上書きします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-245">`return Task.CompletedTask;` Override this to handle a Teams Team being Renamed.</span></span> <span data-ttu-id="86d1d-246">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チーム名の変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-246">For more information see [Team renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="86d1d-247">メンバーが追加されました</span><span class="sxs-lookup"><span data-stu-id="86d1d-247">MembersAdded</span></span> | `OnTeamsMembersAddedAsync` | <span data-ttu-id="86d1d-248">で`ActivityHandler`メソッド`OnMembersAddedAsync`を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-248">Calls the `OnMembersAddedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="86d1d-249">チームに参加するメンバーを処理するには、これをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-249">Override this to handle members joining a team.</span></span> <span data-ttu-id="86d1d-250">詳細については、「[スレッドの更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)に[チームメンバーが追加されました](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-250">For more information see [Team member added](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Added) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="86d1d-251">メンバーの削除</span><span class="sxs-lookup"><span data-stu-id="86d1d-251">MembersRemoved</span></span> | `OnTeamsMembersRemovedAsync` | <span data-ttu-id="86d1d-252">で`ActivityHandler`メソッド`OnMembersRemovedAsync`を呼び出します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-252">Calls the `OnMembersRemovedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="86d1d-253">チームを離れるメンバーを処理するためにオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="86d1d-253">Override this to handle members leaving a team.</span></span> <span data-ttu-id="86d1d-254">詳細については、「[スレッド更新イベント](https://aka.ms/azure-bot-subscribe-to-conversation-events)での[チームメンバーの削除](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-254">For more information see [Team member removed](https://aka.ms/azure-bot-subscribe-to-conversation-events#Team-Member-Removed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |

#### <a name="teams-invoke-activities"></a><span data-ttu-id="86d1d-255">Teams がアクティビティを呼び出す</span><span class="sxs-lookup"><span data-stu-id="86d1d-255">Teams invoke activities</span></span>

<span data-ttu-id="86d1d-256">`onInvokeActivity` _Teams_アクティビティハンドラーから呼び出されたすべての teams アクティビティハンドラーのリストを次に示します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-256">Here is a list of all of the Teams activity handlers called from the `onInvokeActivity` _Teams_ activity handler:</span></span>

| <span data-ttu-id="86d1d-257">呼び出しの種類</span><span class="sxs-lookup"><span data-stu-id="86d1d-257">Invoke types</span></span>                    | <span data-ttu-id="86d1d-258">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="86d1d-258">Handler</span></span>                              | <span data-ttu-id="86d1d-259">説明</span><span class="sxs-lookup"><span data-stu-id="86d1d-259">Description</span></span>                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| <span data-ttu-id="86d1d-260">CardAction. Invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-260">CardAction.Invoke</span></span>               | `handleTeamsCardActionInvoke`       | <span data-ttu-id="86d1d-261">Teams カードアクションの呼び出し。</span><span class="sxs-lookup"><span data-stu-id="86d1d-261">Teams Card Action Invoke.</span></span> |
| <span data-ttu-id="86d1d-262">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-262">fileConsent/invoke</span></span>              | `handleTeamsFileConsentAccept`      | <span data-ttu-id="86d1d-263">Teams ファイルの同意を承諾します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-263">Teams File Consent Accept.</span></span> |
| <span data-ttu-id="86d1d-264">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-264">fileConsent/invoke</span></span>              | `handleTeamsFileConsent`            | <span data-ttu-id="86d1d-265">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="86d1d-265">Teams File Consent.</span></span> |
| <span data-ttu-id="86d1d-266">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="86d1d-266">fileConsent/invoke</span></span>              | `handleTeamsFileConsentDecline`     | <span data-ttu-id="86d1d-267">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="86d1d-267">Teams File Consent.</span></span> |
| <span data-ttu-id="86d1d-268">actionableMessage/executeAction</span><span class="sxs-lookup"><span data-stu-id="86d1d-268">actionableMessage/executeAction</span></span> | `handleTeamsO365ConnectorCardAction` | <span data-ttu-id="86d1d-269">Teams O365 コネクタカードアクション。</span><span class="sxs-lookup"><span data-stu-id="86d1d-269">Teams O365 Connector Card Action.</span></span> |
| <span data-ttu-id="86d1d-270">サインイン/verifyState</span><span class="sxs-lookup"><span data-stu-id="86d1d-270">signin/verifyState</span></span>              | `handleTeamsSigninVerifyState`      | <span data-ttu-id="86d1d-271">Teams サインイン状態を確認します。</span><span class="sxs-lookup"><span data-stu-id="86d1d-271">Teams Sign in Verify State.</span></span> |
| <span data-ttu-id="86d1d-272">タスク/フェッチ</span><span class="sxs-lookup"><span data-stu-id="86d1d-272">task/fetch</span></span>                      | `handleTeamsTaskModuleFetch`        | <span data-ttu-id="86d1d-273">Teams タスクモジュールのフェッチ。</span><span class="sxs-lookup"><span data-stu-id="86d1d-273">Teams Task Module Fetch.</span></span> |
| <span data-ttu-id="86d1d-274">タスク/提出</span><span class="sxs-lookup"><span data-stu-id="86d1d-274">task/submit</span></span>                     | `handleTeamsTaskModuleSubmit`       | <span data-ttu-id="86d1d-275">Teams タスクモジュール提出。</span><span class="sxs-lookup"><span data-stu-id="86d1d-275">Teams Task Module Submit.</span></span> |

<span data-ttu-id="86d1d-276">上記の呼び出しアクティビティは Teams の会話のボットに対応しています。</span><span class="sxs-lookup"><span data-stu-id="86d1d-276">The invoke activities listed above are for conversational bots in Teams.</span></span> <span data-ttu-id="86d1d-277">Bot フレームワーク SDK は、メッセージング拡張機能に固有の呼び出しもサポートしています。</span><span class="sxs-lookup"><span data-stu-id="86d1d-277">The Bot Framework SDK also supports invocations specific to messaging extensions.</span></span> <span data-ttu-id="86d1d-278">詳細について[は、「メッセージング拡張機能に](https://aka.ms/azure-bot-what-are-messaging-extensions)ついて」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="86d1d-278">For more information see [What are messaging extensions](https://aka.ms/azure-bot-what-are-messaging-extensions)</span></span>

---
