---
title: ボットの基本
author: clearab
description: Teams のボットの基本について理解します。
ms.topic: conceptual
ms.author: anclear
ms.openlocfilehash: 43dd351b30fdba3435d39aca43aae0f2de00ed24
ms.sourcegitcommit: d0e71ea63af2f67eba75ba283ec46cc7cdf87d75
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/24/2020
ms.locfileid: "49731959"
---
# <a name="bot-basics"></a><span data-ttu-id="b917f-103">ボットの基本</span><span class="sxs-lookup"><span data-stu-id="b917f-103">Bot basics</span></span>

<span data-ttu-id="b917f-104">これは、Bot Framework のコア ドキュメント[](https://aka.ms/how-bots-work)でのボットの動作に関する記事を基にした[概要です](https://aka.ms/azure-bot-service-docs)。</span><span class="sxs-lookup"><span data-stu-id="b917f-104">This is an introduction that builds on the article [How bots work](https://aka.ms/how-bots-work) in the core [Bot Framework documentation](https://aka.ms/azure-bot-service-docs).</span></span> <span data-ttu-id="b917f-105">その記事と、その他の記事については、「概念」 *セクションを参照* してください。</span><span class="sxs-lookup"><span data-stu-id="b917f-105">You may find that article, and the other articles in the *Concepts* section, useful.</span></span>

<span data-ttu-id="b917f-106">Microsoft Teams 用に開発されたボットの主な違いは、アクティビティの処理方法です。</span><span class="sxs-lookup"><span data-stu-id="b917f-106">The primary difference in bots developed for Microsoft Teams is in how the activities are handled.</span></span> <span data-ttu-id="b917f-107">Microsoft Teams アクティビティ ハンドラーは、Bot Framework のアクティビティ ハンドラーから派生し、Teams 以外のアクティビティの処理を許可する前に、すべての Teams アクティビティをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b917f-107">The Microsoft Teams activity handler derives from the Bot Framework's activity handler to route  all Teams activities before allowing any non-Teams specific activities to be handled.</span></span>

## <a name="teams-activity-handlers"></a><span data-ttu-id="b917f-108">Teams アクティビティ ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-108">Teams Activity handlers</span></span>

<span data-ttu-id="b917f-109">Microsoft Teams 向けのボットは、受信したアクティビティを *アクティビティ ハンドラー* に渡します。</span><span class="sxs-lookup"><span data-stu-id="b917f-109">When a bot for Microsoft Teams receives an activity, it passes it on to its *activity handlers*.</span></span> <span data-ttu-id="b917f-110">内部には *ターン ハンドラー* と呼ばれる 1 つの基本ハンドラーがあり、すべてのアクティビティがルーティングされます。</span><span class="sxs-lookup"><span data-stu-id="b917f-110">Under the covers, there's one base handler called the *turn handler*, that all activities are routed through.</span></span> <span data-ttu-id="b917f-111">ターン *ハンドラーは、* 受信したアクティビティの種類を処理するために必要なアクティビティ ハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-111">The *turn handler* calls the required activity handler to handle whatever type of activity was received.</span></span> <span data-ttu-id="b917f-112">Microsoft Teams 用に設計されたボットが異なるのは、Bot Framework のクラスから派生したクラスから `TeamsActivityHandler` 派生 `ActivityHandler` する点です。</span><span class="sxs-lookup"><span data-stu-id="b917f-112">Where a bot designed for Microsoft Teams differs is that it is derived from `TeamsActivityHandler` class that is derived from the Bot Framework's `ActivityHandler` class.</span></span>

# <a name="c"></a>[<span data-ttu-id="b917f-113">C#</span><span class="sxs-lookup"><span data-stu-id="b917f-113">C#</span></span>](#tab/csharp)

<span data-ttu-id="b917f-114">Microsoft Bot Framework を使用して作成されたボットと同様に、ボットがメッセージ アクティビティを受信すると、ターン ハンドラーは受信アクティビティを確認し、それをアクティビティ ハンドラーに `OnMessageActivityAsync` 送信します。</span><span class="sxs-lookup"><span data-stu-id="b917f-114">As with any bot created using the Microsoft Bot Framework, if the bot receives a message activity, the turn handler sees that incoming activity and sends it to the `OnMessageActivityAsync` activity handler.</span></span> <span data-ttu-id="b917f-115">Teams では、この機能は変わりません。</span><span class="sxs-lookup"><span data-stu-id="b917f-115">In Teams, this functionality remains the same.</span></span> <span data-ttu-id="b917f-116">ボットが会話の更新アクティビティを受け取った場合、ターン ハンドラーは受信アクティビティを確認し、それを次のアクティビティに送信します `OnConversationUpdateActivityAsync` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-116">If the bot receives a conversation update activity, the turn handler sees that incoming activity and sends it to the `OnConversationUpdateActivityAsync`.</span></span> <span data-ttu-id="b917f-117">*Teams* のアクティビティ ハンドラー。最初に Teams 固有のイベントをチェックし、見つからない場合は Bot Framework のアクティビティ ハンドラーに渡します。</span><span class="sxs-lookup"><span data-stu-id="b917f-117">*Teams* activity handler that will first check for any Teams specific events and pass it along to the Bot Framework's activity handler if none are found.</span></span>

<span data-ttu-id="b917f-118">Teams アクティビティ ハンドラー クラスには、2 つの主要な Teams アクティビティ ハンドラーがあります。このハンドラーは、すべての会話更新アクティビティをルーティングし、すべての Teams 呼び出しアクティビティを `OnConversationUpdateActivityAsync` `OnInvokeActivityAsync` ルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b917f-118">In the Teams activity handler class, there are two primary Teams activity handlers, `OnConversationUpdateActivityAsync` that routes all conversation update activities, and `OnInvokeActivityAsync` that routes all Teams invoke activities.</span></span>

<span data-ttu-id="b917f-119">Teams 固有のアクティビティ ハンドラーのロジックを実装するには、以下のボット ロジック セクションに示すように、ボットでこれらのメソッド [を](#bot-logic) オーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-119">To implement your logic for Teams specific activity handlers, you'll override these methods in your bot as shown in the [Bot logic](#bot-logic) section below.</span></span> <span data-ttu-id="b917f-120">これらの各ハンドラーに基本実装はないので、オーバーライドで必要なロジックを追加します。</span><span class="sxs-lookup"><span data-stu-id="b917f-120">For each of these handlers, there is no base implementation, so just add the logic that you want in your override.</span></span>

# <a name="javascript"></a>[<span data-ttu-id="b917f-121">JavaScript</span><span class="sxs-lookup"><span data-stu-id="b917f-121">JavaScript</span></span>](#tab/javascript)

<span data-ttu-id="b917f-122">Microsoft Bot Framework を使用して作成されたボットと同様に、ボットがメッセージ アクティビティを受信すると、ターン ハンドラーは受信アクティビティを確認し、それをアクティビティ ハンドラーに `onMessage` 送信します。</span><span class="sxs-lookup"><span data-stu-id="b917f-122">As with any bot created using the Microsoft Bot Framework, if the bot receives a message activity, the turn handler sees that incoming activity and sends it to the `onMessage` activity handler.</span></span> <span data-ttu-id="b917f-123">Teams では、この機能は変わりません。</span><span class="sxs-lookup"><span data-stu-id="b917f-123">In Teams, this functionality remains the same.</span></span> <span data-ttu-id="b917f-124">ボットが会話の更新アクティビティを受け取った場合、ターン ハンドラーは受信アクティビティを確認し、それを次のアクティビティに送信します `dispatchConversationUpdateActivity` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-124">If the bot receives a conversation update activity, the turn handler sees that incoming activity and sends it to the `dispatchConversationUpdateActivity`.</span></span> <span data-ttu-id="b917f-125">*Teams* のアクティビティ ハンドラー。最初に Teams 固有のイベントをチェックし、見つからない場合はボット フレームワーク アクティビティ ハンドラーに渡します。</span><span class="sxs-lookup"><span data-stu-id="b917f-125">*Teams* activity handler that will first check for any Teams specific events and pass it along to the bot frameworks activity handler if none are found.</span></span>

<span data-ttu-id="b917f-126">Teams アクティビティ ハンドラー クラスには、2 つの主要な Teams アクティビティ ハンドラーがあります。このハンドラーは、すべての会話更新アクティビティをルーティングし、すべての Teams 呼び出しアクティビティを `dispatchConversationUpdateActivity` `onInvokeActivity` ルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b917f-126">In the Teams activity handler class, there are two primary Teams activity handlers, `dispatchConversationUpdateActivity` that routes all conversation update Activities, and `onInvokeActivity` that routes all Teams invoke activities.</span></span>

<span data-ttu-id="b917f-127">Teams 固有のアクティビティ ハンドラーのロジックを実装するには、ボットのロジック セクションに示されているボットでこれらのメソッド [をオーバーライド](#bot-logic) します。</span><span class="sxs-lookup"><span data-stu-id="b917f-127">To implement your logic for Teams specific activity handlers, you'll override these methods in your bot as seen in the [Bot logic](#bot-logic) section.</span></span> <span data-ttu-id="b917f-128">これらの各ハンドラーについて、ボットロジックを定義し、 **最後に `next()` 必ず呼び出してください**。</span><span class="sxs-lookup"><span data-stu-id="b917f-128">For each of these handlers, define your bot logic, then **be sure to call `next()` at the end**.</span></span> <span data-ttu-id="b917f-129">呼び `next()` 出すことによって、次のハンドラーが実行されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-129">By calling `next()` you ensure that the next handler runs.</span></span>

# <a name="python"></a>[<span data-ttu-id="b917f-130">Python</span><span class="sxs-lookup"><span data-stu-id="b917f-130">Python</span></span>](#tab/python)

<span data-ttu-id="b917f-131">ボットは Microsoft Bot Framework を使用して作成され、ボットがメッセージ アクティビティを受信すると、ターン ハンドラーはその受信アクティビティの通知を受信します。</span><span class="sxs-lookup"><span data-stu-id="b917f-131">Bots are created using the Microsoft Bot Framework, if these bot receive a message activity, then the turn handler receives a notification of that incoming activity.</span></span> <span data-ttu-id="b917f-132">その後、ターン ハンドラーは受信アクティビティをアクティビティ ハンドラーに `on_message_activity` 送信します。</span><span class="sxs-lookup"><span data-stu-id="b917f-132">The turn handler then sends the incoming activity to the `on_message_activity` activity handler.</span></span> <span data-ttu-id="b917f-133">Teams では、この機能は変わりません。</span><span class="sxs-lookup"><span data-stu-id="b917f-133">In Teams, this functionality remains the same.</span></span> <span data-ttu-id="b917f-134">ボットが会話更新アクティビティを受け取った場合、ターン ハンドラーはその受信アクティビティの通知を受け取り、着信アクティビティを次に送信します `on_conversation_update_activity` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-134">If the bot receives a conversation update activity, then the turn handler receives a notification of that incoming activity and sends the incoming activity to `on_conversation_update_activity`.</span></span> <span data-ttu-id="b917f-135">Teams アクティビティ ハンドラーは、最初に Teams 固有のイベントをチェックします。</span><span class="sxs-lookup"><span data-stu-id="b917f-135">The Teams activity handler will first check for any Teams specific events.</span></span> <span data-ttu-id="b917f-136">イベントが見つからない場合は、Bot Framework のアクティビティ ハンドラーに渡されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-136">If no events are found, it will then pass them along to the Bot Framework's activity handler.</span></span>

<span data-ttu-id="b917f-137">Teams アクティビティ ハンドラー クラスには、2 つの主要な Teams アクティビティ ハンドラーと `on_conversation_update_activity` `on_invoke_activity` .</span><span class="sxs-lookup"><span data-stu-id="b917f-137">In the Teams activity handler class, there are two primary Teams activity handlers, `on_conversation_update_activity` and `on_invoke_activity`.</span></span> <span data-ttu-id="b917f-138">`on_conversation_update_activity` すべての会話更新アクティビティをルーティングし、 `on_invoke_activity` すべての Teams 呼び出しアクティビティをルーティングします。</span><span class="sxs-lookup"><span data-stu-id="b917f-138">`on_conversation_update_activity` routes all conversation update activities and `on_invoke_activity` routes all Teams invoke activities.</span></span>

<span data-ttu-id="b917f-139">Teams 固有のアクティビティ ハンドラーのロジックを実装するには、ボットのロジック セクションに示すように、ボットでこれらのメソッドを [オーバーライドする必要](#bot-logic) があります。</span><span class="sxs-lookup"><span data-stu-id="b917f-139">To implement your logic for Teams specific activity handlers, you need to override these methods in your bot as shown in the [Bot logic](#bot-logic) section.</span></span> <span data-ttu-id="b917f-140">これらのハンドラーの基本実装はありません。そのため、オーバーライドで必要なロジックを追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="b917f-140">There is no base implementation for these handlers, therefore, you need to add the logic that you want in your override.</span></span>

---

## <a name="bot-logic"></a><span data-ttu-id="b917f-141">ボット ロジック</span><span class="sxs-lookup"><span data-stu-id="b917f-141">Bot logic</span></span>

<span data-ttu-id="b917f-142">ボット ロジックは、1 つ以上のボット チャネルからの受信アクティビティを処理し、応答で送信アクティビティを生成します。</span><span class="sxs-lookup"><span data-stu-id="b917f-142">The bot logic processes incoming activities from one or more of your bot channels and generates outgoing activities in response.</span></span>  <span data-ttu-id="b917f-143">これは、Teams アクティビティ ハンドラー クラスから派生したボットの場合にも当てはまるので、最初に Teams アクティビティをチェックし、次に他のすべてのアクティビティをボット フレームワークアクティビティ ハンドラーに渡します。</span><span class="sxs-lookup"><span data-stu-id="b917f-143">This is still true of bots derived from the Teams activity handler class, which first checks for Teams activities, then passes all other activities to the bot frameworks activity handler.</span></span>

# <a name="c"></a>[<span data-ttu-id="b917f-144">C#</span><span class="sxs-lookup"><span data-stu-id="b917f-144">C#</span></span>](#tab/csharp)

#### <a name="core-bot-framework-handlers"></a><span data-ttu-id="b917f-145">コア Bot Framework ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-145">Core Bot Framework handlers</span></span>

<span data-ttu-id="b917f-146">以下に説明するアクティビティ ハンドラーはすべて、Teams ボット以外のボットの場合と同様に引き続き動作します。ただし、追加されたメンバーとメンバーがアクティビティを削除する場合を除き、これらはチームのコンテキストでは異なります。チームでは、メッセージ スレッドではなく、新しいメンバーがチームに追加されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-146">All of the activity handlers described below will continue to work as they do with a non-Teams bot, with the exception of handling members *added* and members *removed* activities, these will be different in the context of a team, where the new member is added to the team as opposed to a message thread.</span></span>

<span data-ttu-id="b917f-147">定義されているハンドラーの `ActivityHandler` 概要を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="b917f-147">The handlers defined in `ActivityHandler` are outlined below:</span></span>

| <span data-ttu-id="b917f-148">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-148">Event</span></span> | <span data-ttu-id="b917f-149">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-149">Handler</span></span> | <span data-ttu-id="b917f-150">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-150">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-151">受信したアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-151">Any activity type received</span></span> | `OnTurnAsync` | <span data-ttu-id="b917f-152">受信したアクティビティの種類に基づいて、他のハンドラーのいずれかを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-152">Calls one of the other handlers, based on the type of activity received.</span></span> |
| <span data-ttu-id="b917f-153">受信したメッセージ アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-153">Message activity received</span></span> | `OnMessageActivityAsync` | <span data-ttu-id="b917f-154">これをオーバーライドしてアクティビティを処理 `Message` します。</span><span class="sxs-lookup"><span data-stu-id="b917f-154">Override this to handle a `Message` activity.</span></span> |
| <span data-ttu-id="b917f-155">受信した会話の更新アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-155">Conversation update activity received</span></span> | `OnConversationUpdateActivityAsync` | <span data-ttu-id="b917f-156">アクティビティで、ボット以外のメンバーが会話に参加または会話を離えた場合に `ConversationUpdate` ハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-156">On a `ConversationUpdate` activity, calls a handler if members other than the bot joined or left the conversation.</span></span> |
| <span data-ttu-id="b917f-157">ボット以外のメンバーが会話に参加しました</span><span class="sxs-lookup"><span data-stu-id="b917f-157">Non-bot members joined the conversation</span></span> | `OnMembersAddedAsync` | <span data-ttu-id="b917f-158">これをオーバーライドして、会話に参加するメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-158">Override this to handle members joining a conversation.</span></span> |
| <span data-ttu-id="b917f-159">ボット以外のメンバーが会話を離した</span><span class="sxs-lookup"><span data-stu-id="b917f-159">Non-bot members left the conversation</span></span> | `OnMembersRemovedAsync` | <span data-ttu-id="b917f-160">メンバーが会話を離れる処理を行う場合は、これをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-160">Override this to handle members leaving a conversation.</span></span> |
| <span data-ttu-id="b917f-161">受信したイベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-161">Event activity received</span></span> | `OnEventActivityAsync` | <span data-ttu-id="b917f-162">アクティビティでは `Event` 、イベントの種類に固有のハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-162">On an `Event` activity, calls a handler specific to the event type.</span></span> |
| <span data-ttu-id="b917f-163">受信したトークン応答イベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-163">Token-response event activity received</span></span> | `OnTokenResponseEventAsync` | <span data-ttu-id="b917f-164">トークン応答イベントを処理するには、これをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-164">Override this to handle token response events.</span></span> |
| <span data-ttu-id="b917f-165">受信した非トークン応答イベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-165">Non-token-response event activity received</span></span> | `OnEventAsync` | <span data-ttu-id="b917f-166">これをオーバーライドして、他の種類のイベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-166">Override this to handle other types of events.</span></span> |
| <span data-ttu-id="b917f-167">受信したその他のアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-167">Other activity type received</span></span> | `OnUnrecognizedActivityTypeAsync` | <span data-ttu-id="b917f-168">それ以外の場合は処理されないアクティビティの種類を処理するには、これをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-168">Override this to handle any activity type otherwise unhandled.</span></span> |

#### <a name="teams-specific-handlers"></a><span data-ttu-id="b917f-169">Teams 固有のハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-169">Teams-specific handlers</span></span>

<span data-ttu-id="b917f-170">上記 `TeamsActivityHandler` のハンドラーの一覧を拡張して、以下を含める。</span><span class="sxs-lookup"><span data-stu-id="b917f-170">The `TeamsActivityHandler` extends the list of handlers above to include the following:</span></span>

| <span data-ttu-id="b917f-171">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-171">Event</span></span> | <span data-ttu-id="b917f-172">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-172">Handler</span></span> | <span data-ttu-id="b917f-173">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-173">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-174">channelCreated</span><span class="sxs-lookup"><span data-stu-id="b917f-174">channelCreated</span></span> | `OnTeamsChannelCreatedAsync` | <span data-ttu-id="b917f-175">これをオーバーライドして、作成中の Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-175">Override this to handle a Teams channel being created.</span></span> <span data-ttu-id="b917f-176">詳細については、会話の[更新イベントで作成された](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created)[チャネルを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-176">For more information see [Channel created](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-177">channelDeleted</span><span class="sxs-lookup"><span data-stu-id="b917f-177">channelDeleted</span></span> | `OnTeamsChannelDeletedAsync` | <span data-ttu-id="b917f-178">これを上書きして、削除される Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-178">Override this to handle a Teams channel being deleted.</span></span> <span data-ttu-id="b917f-179">詳細については、会話の[更新イベントで削除された](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted)[チャネルを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-179">For more information see [Channel deleted](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-180">channelRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-180">channelRenamed</span></span> | `OnTeamsChannelRenamedAsync` | <span data-ttu-id="b917f-181">これをオーバーライドして、名前を変更する Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-181">Override this to handle a Teams channel being renamed.</span></span> <span data-ttu-id="b917f-182">詳細については、会話の更新[イベントでチャネルの名前が](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed)[変更されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-182">For more information see [Channel renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-183">teamRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-183">teamRenamed</span></span> | `OnTeamsTeamRenamedAsync` | <span data-ttu-id="b917f-184">`return Task.CompletedTask;` これをオーバーライドして、名前を変更する Teams チームを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-184">`return Task.CompletedTask;` Override this to handle a Teams Team being Renamed.</span></span> <span data-ttu-id="b917f-185">詳細については、会話の更新[イベントでチームの名前が](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed)[変更されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-185">For more information see [Team renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-186">MembersAdded</span><span class="sxs-lookup"><span data-stu-id="b917f-186">MembersAdded</span></span> | `OnTeamsMembersAddedAsync` | <span data-ttu-id="b917f-187">でメソッドを `OnMembersAddedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-187">Calls the `OnMembersAddedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-188">これをオーバーライドして、チームに参加するメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-188">Override this to handle members joining a team.</span></span> <span data-ttu-id="b917f-189">詳細については、会話の[更新イベントで追加された](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added)[チーム メンバーを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-189">For more information see [Team members added](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-190">MembersRemoved</span><span class="sxs-lookup"><span data-stu-id="b917f-190">MembersRemoved</span></span> | `OnTeamsMembersRemovedAsync` | <span data-ttu-id="b917f-191">でメソッドを `OnMembersRemovedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-191">Calls the `OnMembersRemovedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-192">これをオーバーライドして、チームから離れるメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-192">Override this to handle members leaving a team.</span></span> <span data-ttu-id="b917f-193">詳細については、会話の更新[イベントで削除された](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed)[チーム メンバーを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-193">For more information see [Team members removed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|

#### <a name="teams-invoke-activities"></a><span data-ttu-id="b917f-194">Teams がアクティビティを呼び出す</span><span class="sxs-lookup"><span data-stu-id="b917f-194">Teams invoke activities</span></span>

<span data-ttu-id="b917f-195">Teams アクティビティ ハンドラーから呼び出される Teams アクティビティ ハンドラーの一覧を `OnInvokeActivityAsync` 次に示します。</span><span class="sxs-lookup"><span data-stu-id="b917f-195">Here is a list of all of the Teams activity handlers called from the `OnInvokeActivityAsync` _Teams_ activity handler:</span></span>

| <span data-ttu-id="b917f-196">呼び出しの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-196">Invoke types</span></span>                    | <span data-ttu-id="b917f-197">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-197">Handler</span></span>                              | <span data-ttu-id="b917f-198">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-198">Description</span></span>                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| <span data-ttu-id="b917f-199">CardAction.Invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-199">CardAction.Invoke</span></span>               | `OnTeamsCardActionInvokeAsync`       | <span data-ttu-id="b917f-200">Teams カード アクションの呼び出し。</span><span class="sxs-lookup"><span data-stu-id="b917f-200">Teams Card Action Invoke.</span></span> |
| <span data-ttu-id="b917f-201">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-201">fileConsent/invoke</span></span>              | `OnTeamsFileConsentAcceptAsync`      | <span data-ttu-id="b917f-202">Teams ファイルの同意に同意します。</span><span class="sxs-lookup"><span data-stu-id="b917f-202">Teams File Consent Accept.</span></span> |
| <span data-ttu-id="b917f-203">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-203">fileConsent/invoke</span></span>              | `OnTeamsFileConsentAsync`            | <span data-ttu-id="b917f-204">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="b917f-204">Teams File Consent.</span></span> |
| <span data-ttu-id="b917f-205">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-205">fileConsent/invoke</span></span>              | `OnTeamsFileConsentDeclineAsync`     | <span data-ttu-id="b917f-206">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="b917f-206">Teams File Consent.</span></span> |
| <span data-ttu-id="b917f-207">actionableMessage/executeAction</span><span class="sxs-lookup"><span data-stu-id="b917f-207">actionableMessage/executeAction</span></span> | `OnTeamsO365ConnectorCardActionAsync` | <span data-ttu-id="b917f-208">Teams O365 コネクタ カード アクション。</span><span class="sxs-lookup"><span data-stu-id="b917f-208">Teams O365 connector Card Action.</span></span> |
| <span data-ttu-id="b917f-209">signin/verifyState</span><span class="sxs-lookup"><span data-stu-id="b917f-209">signin/verifyState</span></span>              | `OnTeamsSigninVerifyStateAsync`      | <span data-ttu-id="b917f-210">Teams サインインの確認状態。</span><span class="sxs-lookup"><span data-stu-id="b917f-210">Teams Sign in Verify State.</span></span> |
| <span data-ttu-id="b917f-211">task/fetch</span><span class="sxs-lookup"><span data-stu-id="b917f-211">task/fetch</span></span>                      | `OnTeamsTaskModuleFetchAsync`        | <span data-ttu-id="b917f-212">Teams タスク モジュールのフェッチ。</span><span class="sxs-lookup"><span data-stu-id="b917f-212">Teams Task Module Fetch.</span></span> |
| <span data-ttu-id="b917f-213">task/submit</span><span class="sxs-lookup"><span data-stu-id="b917f-213">task/submit</span></span>                     | `OnTeamsTaskModuleSubmitAsync`       | <span data-ttu-id="b917f-214">Teams タスク モジュール提出。</span><span class="sxs-lookup"><span data-stu-id="b917f-214">Teams Task Module Submit.</span></span> |

<span data-ttu-id="b917f-215">上記の起動アクティビティは、Teams の会話ボット用です。</span><span class="sxs-lookup"><span data-stu-id="b917f-215">The invoke activities listed above are for conversational bots in Teams.</span></span> <span data-ttu-id="b917f-216">Bot Framework SDK は、メッセージング拡張機能に固有の呼び出しもサポートします。</span><span class="sxs-lookup"><span data-stu-id="b917f-216">The Bot Framework SDK also supports invokes specific to messaging extensions.</span></span> <span data-ttu-id="b917f-217">詳細については、「 [メッセージング拡張機能について」を参照してください。](https://aka.ms/azure-bot-what-are-messaging-extensions)</span><span class="sxs-lookup"><span data-stu-id="b917f-217">For more information see [What are messaging extensions](https://aka.ms/azure-bot-what-are-messaging-extensions)</span></span>

# <a name="javascript"></a>[<span data-ttu-id="b917f-218">JavaScript</span><span class="sxs-lookup"><span data-stu-id="b917f-218">JavaScript</span></span>](#tab/javascript)

<span data-ttu-id="b917f-219">以下で説明するアクティビティ ハンドラーはすべて、Teams ボット以外のボットと同様に引き続き動作します。ただし、追加されたメンバーと削除されたアクティビティを処理する場合を除き、これらはチームのコンテキストでは異なります。チームでは、メッセージ スレッドではなく、新しいメンバーがチームに追加されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-219">All of the activity handlers described below will continue to work as they do with a non-Teams bot, with the exception of handling the members *added* and members *removed* activities, these will be different in the context of a team, where the new member is added to the team as opposed to a message thread.</span></span>

#### <a name="core-bot-framework-handlers"></a><span data-ttu-id="b917f-220">コア Bot Framework ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-220">Core Bot Framework handlers</span></span>

<span data-ttu-id="b917f-221">定義されているハンドラーの `ActivityHandler` 概要を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="b917f-221">The handlers defined in `ActivityHandler` are outlined below.</span></span>

| <span data-ttu-id="b917f-222">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-222">Event</span></span> | <span data-ttu-id="b917f-223">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-223">Handler</span></span> | <span data-ttu-id="b917f-224">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-224">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-225">受信したアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-225">Any activity type received</span></span> | `onTurn` | <span data-ttu-id="b917f-226">受信したアクティビティの種類に基づいて、他のハンドラーのいずれかを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-226">Calls one of the other handlers, based on the type of activity received.</span></span> |
| <span data-ttu-id="b917f-227">受信したメッセージ アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-227">Message activity received</span></span> | `onMessage` | <span data-ttu-id="b917f-228">アクティビティを処理する関数を提供 `Message` します。</span><span class="sxs-lookup"><span data-stu-id="b917f-228">Provide a function for this to handle a `Message` activity.</span></span> |
| <span data-ttu-id="b917f-229">受信した会話の更新アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-229">Conversation update activity received</span></span> | `onConversationUpdate` | <span data-ttu-id="b917f-230">アクティビティで、ボット以外のメンバーが会話に参加または会話を離えた場合に `ConversationUpdate` ハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-230">On a `ConversationUpdate` activity, calls a handler if members other than the bot joined or left the conversation.</span></span> |
| <span data-ttu-id="b917f-231">ボット以外のメンバーが会話に参加しました</span><span class="sxs-lookup"><span data-stu-id="b917f-231">Non-bot members joined the conversation</span></span> | `onMembersAdded` | <span data-ttu-id="b917f-232">会話に参加するメンバーを処理する関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="b917f-232">Provide a function for this to handle members joining a conversation.</span></span> |
| <span data-ttu-id="b917f-233">ボット以外のメンバーが会話を離した</span><span class="sxs-lookup"><span data-stu-id="b917f-233">Non-bot members left the conversation</span></span> | `onMembersRemoved` | <span data-ttu-id="b917f-234">会話を離れるメンバーを処理する関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="b917f-234">Provide a function for this to handle members leaving a conversation.</span></span> |
| <span data-ttu-id="b917f-235">受信したイベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-235">Event activity received</span></span> | `onEvent` | <span data-ttu-id="b917f-236">アクティビティでは `Event` 、イベントの種類に固有のハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-236">On an `Event` activity, calls a handler specific to the event type.</span></span> |
| <span data-ttu-id="b917f-237">受信したトークン応答イベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-237">Token-response event activity received</span></span> | `onTokenResponseEvent` | <span data-ttu-id="b917f-238">トークン応答イベントを処理する関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="b917f-238">Provide a function for this to handle token response events.</span></span> |
| <span data-ttu-id="b917f-239">受信したその他のアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-239">Other activity type received</span></span> | `onUnrecognizedActivityType` | <span data-ttu-id="b917f-240">それ以外の場合は未処理のアクティビティの種類を処理する関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="b917f-240">Provide a function for this to handle any activity type otherwise unhandled.</span></span> |
| <span data-ttu-id="b917f-241">アクティビティ ハンドラーが完了しました</span><span class="sxs-lookup"><span data-stu-id="b917f-241">Activity handlers have completed</span></span> | `onDialog` | <span data-ttu-id="b917f-242">残りのアクティビティ ハンドラーが完了した後、ターンの最後に実行する必要がある処理を処理する関数を提供します。</span><span class="sxs-lookup"><span data-stu-id="b917f-242">Provide a function for this to handle any processing that should be done at the end of a turn after the rest of your activity handlers have completed.</span></span> |

#### <a name="teams-specific-handlers"></a><span data-ttu-id="b917f-243">Teams 固有のハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-243">Teams-specific handlers</span></span>

<span data-ttu-id="b917f-244">コア Bot Framework ハンドラー セクションのハンドラーの一覧を `TeamsActivityHandler` 拡張し、次の項目を含める。</span><span class="sxs-lookup"><span data-stu-id="b917f-244">The `TeamsActivityHandler` extends the list of handlers in the Core Bot Framework handlers section to include the following:</span></span>

| <span data-ttu-id="b917f-245">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-245">Event</span></span> | <span data-ttu-id="b917f-246">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-246">Handler</span></span> | <span data-ttu-id="b917f-247">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-247">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-248">channelCreated</span><span class="sxs-lookup"><span data-stu-id="b917f-248">channelCreated</span></span> | `OnTeamsChannelCreatedAsync` | <span data-ttu-id="b917f-249">これをオーバーライドして、作成中の Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-249">Override this to handle a Teams channel being created.</span></span> <span data-ttu-id="b917f-250">詳細については、会話の[更新イベントで作成された](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created)[チャネルを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-250">For more information see [Channel created](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-251">channelDeleted</span><span class="sxs-lookup"><span data-stu-id="b917f-251">channelDeleted</span></span> | `OnTeamsChannelDeletedAsync` | <span data-ttu-id="b917f-252">これを上書きして、削除される Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-252">Override this to handle a Teams channel being deleted.</span></span> <span data-ttu-id="b917f-253">詳細については、会話の[更新イベントで削除された](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted)[チャネルを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-253">For more information see [Channel deleted](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-254">channelRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-254">channelRenamed</span></span> | `OnTeamsChannelRenamedAsync` | <span data-ttu-id="b917f-255">これをオーバーライドして、名前を変更する Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-255">Override this to handle a Teams channel being renamed.</span></span> <span data-ttu-id="b917f-256">詳細については、会話の更新[イベントでチャネルの名前が](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed)[変更されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-256">For more information see [Channel renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-257">teamRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-257">teamRenamed</span></span> | `OnTeamsTeamRenamedAsync` | <span data-ttu-id="b917f-258">`return Task.CompletedTask;` これを上書きして、名前を変更する Teams チームを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-258">`return Task.CompletedTask;` Override this to handle a Teams team being renamed.</span></span> <span data-ttu-id="b917f-259">詳細については、会話の更新[イベントでチームの名前が](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed)[変更されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-259">For more information see [Team renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-260">MembersAdded</span><span class="sxs-lookup"><span data-stu-id="b917f-260">MembersAdded</span></span> | `OnTeamsMembersAddedAsync` | <span data-ttu-id="b917f-261">でメソッドを `OnMembersAddedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-261">Calls the `OnMembersAddedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-262">これをオーバーライドして、チームに参加するメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-262">Override this to handle members joining a team.</span></span> <span data-ttu-id="b917f-263">詳細については、会話の[更新イベントで追加された](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added)[チーム メンバーを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-263">For more information see [Team members added](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-264">MembersRemoved</span><span class="sxs-lookup"><span data-stu-id="b917f-264">MembersRemoved</span></span> | `OnTeamsMembersRemovedAsync` | <span data-ttu-id="b917f-265">でメソッドを `OnMembersRemovedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-265">Calls the `OnMembersRemovedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-266">これをオーバーライドして、チームから離れるメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-266">Override this to handle members leaving a team.</span></span> <span data-ttu-id="b917f-267">詳細については、会話の更新[イベントで削除された](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed)[チーム メンバーを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-267">For more information see [Team members removed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |

#### <a name="teams-invoke-activities"></a><span data-ttu-id="b917f-268">Teams がアクティビティを呼び出す</span><span class="sxs-lookup"><span data-stu-id="b917f-268">Teams invoke activities</span></span>

<span data-ttu-id="b917f-269">Teams アクティビティ ハンドラーから呼び出される Teams アクティビティ ハンドラーの一覧を `onInvokeActivity` 次に示します。</span><span class="sxs-lookup"><span data-stu-id="b917f-269">Here is a list of all of the Teams activity handlers called from the `onInvokeActivity` Teams activity handler:</span></span>

| <span data-ttu-id="b917f-270">呼び出しの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-270">Invoke types</span></span>                    | <span data-ttu-id="b917f-271">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-271">Handler</span></span>                              | <span data-ttu-id="b917f-272">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-272">Description</span></span>                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| <span data-ttu-id="b917f-273">CardAction.Invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-273">CardAction.Invoke</span></span>               | `handleTeamsCardActionInvoke`       | <span data-ttu-id="b917f-274">Teams カード アクションが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-274">Teams card action invoke.</span></span> |
| <span data-ttu-id="b917f-275">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-275">fileConsent/invoke</span></span>              | `handleTeamsFileConsentAccept`      | <span data-ttu-id="b917f-276">Teams ファイルの同意に同意します。</span><span class="sxs-lookup"><span data-stu-id="b917f-276">Teams file consent accept.</span></span> |
| <span data-ttu-id="b917f-277">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-277">fileConsent/invoke</span></span>              | `handleTeamsFileConsent`            | <span data-ttu-id="b917f-278">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="b917f-278">Teams file consent.</span></span> |
| <span data-ttu-id="b917f-279">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-279">fileConsent/invoke</span></span>              | `handleTeamsFileConsentDecline`     | <span data-ttu-id="b917f-280">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="b917f-280">Teams file consent.</span></span> |
| <span data-ttu-id="b917f-281">actionableMessage/executeAction</span><span class="sxs-lookup"><span data-stu-id="b917f-281">actionableMessage/executeAction</span></span> | `handleTeamsO365ConnectorCardAction` | <span data-ttu-id="b917f-282">Teams O365 コネクタ カードアクション。</span><span class="sxs-lookup"><span data-stu-id="b917f-282">Teams O365 connector card action.</span></span> |
| <span data-ttu-id="b917f-283">signin/verifyState</span><span class="sxs-lookup"><span data-stu-id="b917f-283">signin/verifyState</span></span>              | `handleTeamsSigninVerifyState`      | <span data-ttu-id="b917f-284">Teams サインインの確認状態。</span><span class="sxs-lookup"><span data-stu-id="b917f-284">Teams sign in verify state.</span></span> |
| <span data-ttu-id="b917f-285">task/fetch</span><span class="sxs-lookup"><span data-stu-id="b917f-285">task/fetch</span></span>                      | `handleTeamsTaskModuleFetch`        | <span data-ttu-id="b917f-286">Teams タスク モジュールのフェッチ。</span><span class="sxs-lookup"><span data-stu-id="b917f-286">Teams task module fetch.</span></span> |
| <span data-ttu-id="b917f-287">task/submit</span><span class="sxs-lookup"><span data-stu-id="b917f-287">task/submit</span></span>                     | `handleTeamsTaskModuleSubmit`       | <span data-ttu-id="b917f-288">Teams タスク モジュール送信。</span><span class="sxs-lookup"><span data-stu-id="b917f-288">Teams task module submit.</span></span> |

<span data-ttu-id="b917f-289">Teams の呼び出しアクティビティ セクションにリストされている起動アクティビティは、Teams の会話ボット用です。</span><span class="sxs-lookup"><span data-stu-id="b917f-289">The invoke activities listed in the Teams invoke activities section are for conversational bots in Teams.</span></span> <span data-ttu-id="b917f-290">Bot Framework SDK は、メッセージング拡張機能に固有の呼び出しアクティビティもサポートします。</span><span class="sxs-lookup"><span data-stu-id="b917f-290">The Bot Framework SDK also supports invoke activities specific to messaging extensions.</span></span> <span data-ttu-id="b917f-291">詳細については、「メッセージング拡張機能について [」を参照してください](https://aka.ms/azure-bot-what-are-messaging-extensions)。</span><span class="sxs-lookup"><span data-stu-id="b917f-291">For more information, see [What are messaging extensions](https://aka.ms/azure-bot-what-are-messaging-extensions).</span></span>

# <a name="python"></a>[<span data-ttu-id="b917f-292">Python</span><span class="sxs-lookup"><span data-stu-id="b917f-292">Python</span></span>](#tab/python)

#### <a name="core-bot-framework-handlers"></a><span data-ttu-id="b917f-293">コア Bot Framework ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-293">Core Bot Framework handlers</span></span>

>[!NOTE]
> <span data-ttu-id="b917f-294">追加および削除されたメンバーのアクティビティを除き、このセクションで説明するアクティビティ ハンドラーはすべて、Teams 以外のボットと同様に引き続き動作します。</span><span class="sxs-lookup"><span data-stu-id="b917f-294">Except for the added and removed members' activities, all of the activity handlers described in this section continue to work as they do with a non-Teams bot.</span></span>

<span data-ttu-id="b917f-295">アクティビティ ハンドラーは、メッセージ スレッドの代わりに新しいメンバーがチームに追加されるチームのコンテキストでは異なります。</span><span class="sxs-lookup"><span data-stu-id="b917f-295">Activity handlers are different in context of a team, where the new member is added to the team instead of a message thread.</span></span>

<span data-ttu-id="b917f-296">定義されているハンドラーの一覧は `ActivityHandler` 次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b917f-296">The list of handlers defined in `ActivityHandler` include the following:</span></span>

| <span data-ttu-id="b917f-297">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-297">Event</span></span> | <span data-ttu-id="b917f-298">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-298">Handler</span></span> | <span data-ttu-id="b917f-299">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-299">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-300">受信したアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-300">Any activity type received</span></span> | `on_turn` | <span data-ttu-id="b917f-301">受信したアクティビティの種類に基づいて、他のハンドラーのいずれかを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-301">Calls one of the other handlers, based on the type of activity received.</span></span> |
| <span data-ttu-id="b917f-302">受信したメッセージ アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-302">Message activity received</span></span> | `on_message_activity` | <span data-ttu-id="b917f-303">アクティビティを処理するためにこれをオーバーライド `Message` します。</span><span class="sxs-lookup"><span data-stu-id="b917f-303">Overrides this to handle a `Message` activity.</span></span> |
| <span data-ttu-id="b917f-304">受信した会話の更新アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-304">Conversation update activity received</span></span> | `on_conversation_update_activity` | <span data-ttu-id="b917f-305">ボット以外のメンバーが会話に参加または会話を離れた場合にハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-305">Calls a handler if members other than the bot join or leave the conversation.</span></span> |
| <span data-ttu-id="b917f-306">ボット以外のメンバーが会話に参加しました</span><span class="sxs-lookup"><span data-stu-id="b917f-306">Non-bot members joined the conversation</span></span> | `on_members_added_activity` | <span data-ttu-id="b917f-307">これをオーバーライドして、会話に参加するメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-307">Overrides this to handle members joining a conversation.</span></span> |
| <span data-ttu-id="b917f-308">ボット以外のメンバーが会話を離した</span><span class="sxs-lookup"><span data-stu-id="b917f-308">Non-bot members left the conversation</span></span> | `on_members_removed_activity` | <span data-ttu-id="b917f-309">会話から退出するメンバーを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-309">Overrides this to handle members leaving a conversation.</span></span> |
| <span data-ttu-id="b917f-310">受信したイベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-310">Event activity received</span></span> | `on_event_activity` | <span data-ttu-id="b917f-311">イベントの種類に固有のハンドラーを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="b917f-311">Calls a handler specific to the type of event.</span></span> |
| <span data-ttu-id="b917f-312">受信したトークン応答イベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-312">Token-response event activity received</span></span> | `on_token_response_event` | <span data-ttu-id="b917f-313">トークン応答イベントを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-313">Overrides this to handle token response events.</span></span> |
| <span data-ttu-id="b917f-314">受信した非トークン応答イベント アクティビティ</span><span class="sxs-lookup"><span data-stu-id="b917f-314">Non-token-response event activity received</span></span> | `on_event` | <span data-ttu-id="b917f-315">他の種類のイベントを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-315">Overrides this to handle other types of events.</span></span> |
| <span data-ttu-id="b917f-316">受信したその他のアクティビティの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-316">Other activity types received</span></span> | `on_unrecognized_activity_type` | <span data-ttu-id="b917f-317">これをオーバーライドして、処理されない種類のアクティビティを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-317">Overrides this to handle any type of activity that is not handled.</span></span> |

#### <a name="teams-specific-handlers"></a><span data-ttu-id="b917f-318">Teams 固有のハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-318">Teams-specific handlers</span></span>

<span data-ttu-id="b917f-319">コア Bot Framework ハンドラー セクションのハンドラーの一覧 `TeamsActivityHandler` を拡張して、次のものが含まれます。</span><span class="sxs-lookup"><span data-stu-id="b917f-319">The `TeamsActivityHandler` extends the list of handlers from the Core Bot Framework handlers section to include the following:</span></span>

| <span data-ttu-id="b917f-320">イベント</span><span class="sxs-lookup"><span data-stu-id="b917f-320">Event</span></span> | <span data-ttu-id="b917f-321">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-321">Handler</span></span> | <span data-ttu-id="b917f-322">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-322">Description</span></span> |
| :-- | :-- | :-- |
| <span data-ttu-id="b917f-323">channelCreated</span><span class="sxs-lookup"><span data-stu-id="b917f-323">channelCreated</span></span> | `on_teams_channel_created` | <span data-ttu-id="b917f-324">作成中の Teams チャネルを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-324">Overrides this to handle a Teams channel being created.</span></span> <span data-ttu-id="b917f-325">詳細については、「会話の更新[イベントで作成された](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created)[チャネル」を参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-325">For more information, see [Channel created](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-created) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span> |
| <span data-ttu-id="b917f-326">channelDeleted</span><span class="sxs-lookup"><span data-stu-id="b917f-326">channelDeleted</span></span> | `on_teams_channel_deleted` | <span data-ttu-id="b917f-327">削除する Teams チャネルを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-327">Overrides this to handle a Teams channel being deleted.</span></span> <span data-ttu-id="b917f-328">詳細については、「会話の更新[イベントで削除されたチャネル](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted)[」を参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-328">For more information, see [Channel deleted](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-deleted) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-329">channelRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-329">channelRenamed</span></span> | `on_teams_channel_renamed` | <span data-ttu-id="b917f-330">これをオーバーライドして、名前を変更する Teams チャネルを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-330">Overrides this to handle a Teams channel being renamed.</span></span> <span data-ttu-id="b917f-331">詳細については、会話の更新[イベントでチャネルの名前が変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed)[されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-331">For more information, see [Channel renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#channel-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-332">teamRenamed</span><span class="sxs-lookup"><span data-stu-id="b917f-332">teamRenamed</span></span> | `on_teams_team_renamed` | <span data-ttu-id="b917f-333">`return Task.CompletedTask;` これを上書きして、名前を変更する Teams チームを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-333">`return Task.CompletedTask;` Overrides this to handle a Teams team being renamed.</span></span> <span data-ttu-id="b917f-334">詳細については、会話の更新[イベントでチームの名前が変更](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed)[されたを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-334">For more information, see [Team renamed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-renamed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-335">MembersAdded</span><span class="sxs-lookup"><span data-stu-id="b917f-335">MembersAdded</span></span> | `on_teams_members_added` | <span data-ttu-id="b917f-336">でメソッドを `OnMembersAddedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-336">Calls the `OnMembersAddedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-337">これをオーバーライドして、チームに参加するメンバーを処理します。</span><span class="sxs-lookup"><span data-stu-id="b917f-337">Overrides this to handle members joining a team.</span></span> <span data-ttu-id="b917f-338">詳細については、「会話の更新 [イベントで追加された](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added) チーム メンバー [」を参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-338">For more information, see [Team members added](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-added) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|
| <span data-ttu-id="b917f-339">MembersRemoved</span><span class="sxs-lookup"><span data-stu-id="b917f-339">MembersRemoved</span></span> | `on_teams_members_removed` | <span data-ttu-id="b917f-340">でメソッドを `OnMembersRemovedAsync` 呼び出します `ActivityHandler` 。</span><span class="sxs-lookup"><span data-stu-id="b917f-340">Calls the `OnMembersRemovedAsync` method in `ActivityHandler`.</span></span> <span data-ttu-id="b917f-341">チームから退出するメンバーを処理するためにこれをオーバーライドします。</span><span class="sxs-lookup"><span data-stu-id="b917f-341">Overrides this to handle members leaving a team.</span></span> <span data-ttu-id="b917f-342">詳細については、会話の更新[イベントで削除されたチーム](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed)[メンバーを参照してください](https://aka.ms/azure-bot-subscribe-to-conversation-events)。</span><span class="sxs-lookup"><span data-stu-id="b917f-342">For more information, see [Team members removed](https://aka.ms/azure-bot-subscribe-to-conversation-events#team-members-removed) in [Conversation update events](https://aka.ms/azure-bot-subscribe-to-conversation-events).</span></span>|

#### <a name="teams-invoke-activities"></a><span data-ttu-id="b917f-343">Teams がアクティビティを呼び出す</span><span class="sxs-lookup"><span data-stu-id="b917f-343">Teams invoke activities</span></span>

<span data-ttu-id="b917f-344">Teams アクティビティ ハンドラーから呼び出される Teams アクティビティ ハンドラーの `on_invoke_activity` 一覧は、次のとおりです。</span><span class="sxs-lookup"><span data-stu-id="b917f-344">The list of Teams activity handlers called from the `on_invoke_activity` Teams activity handler include the following:</span></span>

| <span data-ttu-id="b917f-345">呼び出しの種類</span><span class="sxs-lookup"><span data-stu-id="b917f-345">Invoke types</span></span>                    | <span data-ttu-id="b917f-346">ハンドラー</span><span class="sxs-lookup"><span data-stu-id="b917f-346">Handler</span></span>                              | <span data-ttu-id="b917f-347">説明</span><span class="sxs-lookup"><span data-stu-id="b917f-347">Description</span></span>                                                  |
| :-----------------------------  | :----------------------------------- | :----------------------------------------------------------- |
| <span data-ttu-id="b917f-348">CardAction.Invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-348">CardAction.Invoke</span></span>               | `on_teams_card_action_invoke`       | <span data-ttu-id="b917f-349">Teams カード アクションが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-349">Teams card action invoke.</span></span> |
| <span data-ttu-id="b917f-350">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-350">fileConsent/invoke</span></span>              | `on_teams_file_consent_accept`      | <span data-ttu-id="b917f-351">Teams ファイルの同意に同意します。</span><span class="sxs-lookup"><span data-stu-id="b917f-351">Teams file consent accept.</span></span> |
| <span data-ttu-id="b917f-352">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-352">fileConsent/invoke</span></span>              | `on_teams_file_consent`            | <span data-ttu-id="b917f-353">Teams ファイルの同意。</span><span class="sxs-lookup"><span data-stu-id="b917f-353">Teams file consent.</span></span> |
| <span data-ttu-id="b917f-354">fileConsent/invoke</span><span class="sxs-lookup"><span data-stu-id="b917f-354">fileConsent/invoke</span></span>              | `on_teams_file_consent_decline`     | <span data-ttu-id="b917f-355">Teams ファイルの同意が拒否されます。</span><span class="sxs-lookup"><span data-stu-id="b917f-355">Teams file consent decline.</span></span> |
| <span data-ttu-id="b917f-356">actionableMessage/executeAction</span><span class="sxs-lookup"><span data-stu-id="b917f-356">actionableMessage/executeAction</span></span> | `on_teams_o365_connector_card_action` | <span data-ttu-id="b917f-357">Teams O365 コネクタ カードアクション。</span><span class="sxs-lookup"><span data-stu-id="b917f-357">Teams O365 connector card action.</span></span> |
| <span data-ttu-id="b917f-358">signin/verifyState</span><span class="sxs-lookup"><span data-stu-id="b917f-358">signin/verifyState</span></span>              | `on_teams_signin_verify_state`      | <span data-ttu-id="b917f-359">Teams サインインの確認状態。</span><span class="sxs-lookup"><span data-stu-id="b917f-359">Teams sign in verify state.</span></span> |
| <span data-ttu-id="b917f-360">task/fetch</span><span class="sxs-lookup"><span data-stu-id="b917f-360">task/fetch</span></span>                      | `on_teams_task_module_fetch`        | <span data-ttu-id="b917f-361">Teams タスク モジュールのフェッチ。</span><span class="sxs-lookup"><span data-stu-id="b917f-361">Teams task module fetch.</span></span> |
| <span data-ttu-id="b917f-362">task/submit</span><span class="sxs-lookup"><span data-stu-id="b917f-362">task/submit</span></span>                     | `on_teams_task_module_submit`       | <span data-ttu-id="b917f-363">Teams タスク モジュール送信。</span><span class="sxs-lookup"><span data-stu-id="b917f-363">Teams task module submit.</span></span> |

<span data-ttu-id="b917f-364">Teams の呼び出しアクティビティ セクションにリストされている起動アクティビティは、Teams の会話ボット用です。</span><span class="sxs-lookup"><span data-stu-id="b917f-364">The invoke activities listed in the Teams invoke activities section are for conversational bots in Teams.</span></span> <span data-ttu-id="b917f-365">Bot Framework SDK は、メッセージング拡張機能に固有の呼び出しアクティビティもサポートします。</span><span class="sxs-lookup"><span data-stu-id="b917f-365">The Bot Framework SDK also supports invoke activities specific to messaging extensions.</span></span> <span data-ttu-id="b917f-366">詳細については、「メッセージング拡張機能について [」を参照してください](https://aka.ms/azure-bot-what-are-messaging-extensions)。</span><span class="sxs-lookup"><span data-stu-id="b917f-366">For more information, see [What are messaging extensions](https://aka.ms/azure-bot-what-are-messaging-extensions).</span></span>

---
