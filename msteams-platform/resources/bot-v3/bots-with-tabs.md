---
title: ボットをタブに結合する
description: タブとボットを一緒に使用する方法について説明します。
keywords: チームボットタブ開発
ms.topic: conceptual
localization_priority: Normal
ms.date: 03/15/2018
ms.openlocfilehash: 3273369ad1122355b792dc3d429c3a4eff7e1d47
ms.sourcegitcommit: 51e4a1464ea58c254ad6bd0317aca03ebf6bf1f6
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 05/19/2021
ms.locfileid: "52566454"
---
# <a name="combine-bots-with-tabs"></a>ボットをタブに結合する

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

ボットとタブはうまく連携し、多くの場合、1 つのバックエンド サービスに結合されます。 このセクションでは、タブとボットを一緒に使用するためのベスト プラクティスと一般的なパターンについて説明します。

## <a name="associating-user-identities-across-bot-and-tab"></a>ボットとタブ間でのユーザー ID の関連付け

例: タブアプリケーションが独自の ID システムを使用してコンテンツを保護しているとします。 ユーザーと対話できるボットも持っているとします。 通常は、表示ユーザーに固有のコンテンツをタブに表示します。 この問題は、システム内のユーザー ID が Microsoft Teams ユーザー ID と異なる可能性が高いということです。 では、この 2 つの ID をどのように関連付けるのでしょうか。
一般に、推奨されるアプローチは、タブコンテンツの認証を提供するために使用したのと同じ ID システムを使用して、ボットでユーザーにサインインすることです。 これは、通常 OAuth フローを介してユーザーにログインするサインインアクションを使用して実装できます。

このフローは、ID プロバイダーが OAuth 2.0 プロトコルを実装している場合に最適です。 その後、Teamsユーザー ID を、独自の ID サービスからユーザーの資格情報に関連付けることができます。

   ![ID の関連付け](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>ボットからのメッセージのタブへのディープリンクの作成

タブを使用して、カード内に収まらないコンテンツを表示したり、タブキャンバスを使用して複雑なフォーム入力タスクを実行する方法を提供したりできます。 たとえば、ユーザーがボットからカードをクリックしたときに、そのタブに移動することを検討してください。 これを実現するには、ボットのメッセージをエンコードして、マークアップまたは openUrl アクションのターゲットとして [ディープリンク](~/concepts/build-and-test/deep-links.md) URL を含める必要があります。

ディープ リンクは、システム内の一意のエンティティにマップされる不透明な値である entityId に依存します。 タブが作成されたら、チャネル内に作成されたことを示すフラグなど、いくつかの単純な状態を保存することをお客様が理想的です。 ボットがメッセージを作成するときに、そのタブに関連付けられている entityId をターゲットにすることができます。

> [!NOTE]
> 個人的なチャットでは、タブは「静的」であり、アプリと一緒にインストールされているので、あなたは常にそれらの存在を仮定し、それに応じて深いリンクを構築することができます。

## <a name="sending-notifications-for-tab-updates"></a>タブ更新の通知を送信する

多くの場合、タブで更新またはユーザーの操作が発生したときに、エンド ユーザーに通知する必要があります。たとえば、チーム メンバーにタスクまたはチケットを割り当てて、そのチーム メンバーに通知するシナリオがあります。

このシナリオを実現するには、次の 2 つの方法があります。

1. チャネル全体に通知する場合、ボットはメッセージをチャネルに非同期的に投稿できます。 ボットがタブで作成されていない場合、ボットがタブ会話をプロアクティブに作成する方法はありません。

2. アクションに関連する受信者または関係者にのみ通知する場合、ボットはユーザーに個人用のチャット メッセージを送信できます。 最初に、ボットとユーザーの間に個人的な会話が存在するかどうかを確認する必要があります。 ない場合は、 `CreateConversation` 個人チャットを開始するために呼び出すことができます。

どちらの場合も、イベント通知を賢明に使用し、不必要な更新でユーザーをスパムすることはありません。
