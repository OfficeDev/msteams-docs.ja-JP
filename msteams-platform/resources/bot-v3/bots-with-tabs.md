---
title: ボットとタブを組み合わせる
description: タブとボットを一緒に使用する方法について説明します。
keywords: teams ボットのタブ開発
ms.topic: conceptual
localization_priority: Normal
ms.date: 03/15/2018
ms.openlocfilehash: b33d0bfcae4b522fc9e0c7d17b3d082979a62647
ms.sourcegitcommit: 825abed2f8784d2bab7407ba7a4455ae17bbd28f
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/26/2021
ms.locfileid: "52020626"
---
# <a name="combine-bots-with-tabs"></a>ボットとタブを組み合わせる

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

ボットとタブはうまく機能し、多くの場合、単一のバック エンド サービスに組み合わされます。 このセクションでは、タブとボットを一緒に使用するためのベスト プラクティスと一般的なパターンについて説明します。

## <a name="associating-user-identities-across-bot-and-tab"></a>ボットとタブ間でのユーザー ID の関連付け

たとえば、タブ アプリケーションが独自の ID システムを使用してコンテンツをセキュリティで保護するとします。 また、ユーザーと対話できるボットが用意されているとします。 通常、表示ユーザーに固有のコンテンツをタブに表示します。 課題は、システム内のユーザー ID が Microsoft Teams ユーザー ID と異なる可能性が高いという問題です。 では、これら 2 つの ID を関連付ける方法は?
一般に、推奨される方法は、タブ コンテンツの認証を提供するために使用されるのと同じ ID システムを使用してボットでユーザーにサインインする方法です。 これは、通常、OAuth フローを介してユーザーにログインするサインイン アクションを使用して実装できます。

このフローは、ID プロバイダーが OAuth 2.0 プロトコルを実装している場合に最適です。 その後、Teams ユーザー ID を、自分の ID サービスからユーザーの資格情報に関連付けることができます。

   ![ID の関連付け](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>ボットからのメッセージ内のタブへのディープ リンクの作成

タブを使用して、カード内に収まらないコンテンツを表示したり、タブ キャンバスを使用して複雑なフォーム入力タスクを完了したりすることもできます。 たとえば、ボットからカードをクリックすると、ユーザーをタブに移動できます。 このためには、ボットのメッセージをエンコードして、マークアップまたは openUrl アクションのターゲットとしてディープ リンク [URL](~/concepts/build-and-test/deep-links.md) を含める必要があります。

ディープ リンクは entityId に依存します。これは、システム内の一意のエンティティにマップされる不透明な値です。 タブが作成されると、タブがチャネル内に作成されたことを示す単純な状態 (フラグなど) をバックエンドに保存するのが理想的です。 ボットがメッセージを作成すると、そのタブに関連付けられた entityId をターゲットにできます。

**注:** 個人用チャットでは、タブは "静的" であり、アプリと一緒にインストールされますので、常にそれらの存在を前提として、したがって、必要に応じてディープ リンクを作成できます。

## <a name="sending-notifications-for-tab-updates"></a>タブ更新の通知の送信

多くの場合、タブで更新またはユーザー操作が発生するたびにエンド ユーザーに通知する必要があります。たとえば、タスクまたはチケットを仲間のチーム メンバーに割り当て、そのチーム メンバーに通知します。

このシナリオを実現するには、次の 2 つの方法があります。

1. チャネル全体に通知する場合、ボットはチャネルにメッセージを非同期的に投稿できます。 ボットがタブで作成されなかった場合、ボットが積極的にタブ会話を作成する方法はありません。

2. アクションに関連する受信者または関係者にのみ通知する場合、ボットはユーザーに個人のチャット メッセージを送信できます。 まず、ボットとユーザーの間の個人的な会話が存在するかどうかを確認する必要があります。 設定されていない場合は、電話で `CreateConversation` 個人チャットを開始できます。

どちらの場合も、イベント通知を賢明に使用し、不要な更新プログラムでユーザーに迷惑メールを送信しない。
