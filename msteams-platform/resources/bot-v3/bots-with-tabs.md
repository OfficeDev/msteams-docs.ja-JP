---
title: ボットとタブを組み合わせる
description: この記事では、タブとボットを一緒に使用し、ボットからのメッセージ内のタブへのディープ リンクを構築する方法と、チームボットのタブ開発について説明します。
ms.topic: conceptual
ms.localizationpriority: medium
ms.date: 03/15/2018
ms.openlocfilehash: 47a8ba3081fa629c650dfdf588e4b0c60600561e
ms.sourcegitcommit: 7bbb7caf729a00b267ceb8af7defffc91903d945
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/21/2022
ms.locfileid: "66189740"
---
# <a name="combine-bots-with-tabs"></a>ボットとタブを組み合わせる

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

ボットとタブは連携し、多くの場合、1 つのバックエンド サービスに結合されます。 このセクションでは、タブとボットを一緒に使用するためのベスト プラクティスと一般的なパターンについて説明します。

## <a name="associating-user-identities-across-bot-and-tab"></a>ボットとタブ間でのユーザー ID の関連付け

たとえば、タブ アプリケーションが独自の ID システムを使用してそのコンテンツをセキュリティで保護しているとします。 また、ユーザーと対話できるボットがあるとします。 通常、表示ユーザーに固有のコンテンツをタブに表示します。 課題は、システム内のユーザー ID がMicrosoft Teamsユーザー ID と異なる可能性があるということです。 では、この 2 つの ID をどのように関連付けますか?
一般に、推奨される方法は、タブ コンテンツの認証を提供するために使用されるのと同じ ID システムを使用して、ボットでユーザーにサインインすることです。 通常、OAuth フローを使用してユーザーにログインするサインイン アクションを使用して実装できます。

このフローは、ID プロバイダーが OAuth 2.0 プロトコルを実装している場合に最適です。 その後、Teams ユーザー ID を、独自の ID サービスのユーザーの資格情報に関連付けることができます。

   ![ID の関連付け](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>ボットからのメッセージ内のタブへのディープ リンクの構築

タブを使用して、カード内に収まるコンテンツを表示したり、タブ キャンバスを使用して複雑なフォーム入力タスクを完了したりする方法を提供します。 たとえば、ユーザーがボットからカードを選択したときに、ユーザーをタブに移動することを検討してください。 これを行うには、マークアップまたは openUrl アクションのターゲットとしてディープ [リンク](~/concepts/build-and-test/deep-links.md) URL を含めるために、ボットのメッセージをエンコードする必要があります。

ディープ リンクは entityId に依存します。これは、システム内の一意のエンティティにマップされる不透明な値です。 タブが作成されると、単純な状態が格納されます。 たとえば、チャネルにタブが作成されたことを示すバックエンドのフラグを設定します。 ボットがメッセージを作成するときに、そのタブに関連付けられている entityId をターゲットにすることができます。

> [!NOTE]
> 個人用チャットでは、タブは "静的" であり、アプリと共にインストールされるため、その存在を常に想定し、それに応じてディープ リンクを構築できます。

## <a name="sending-notifications-for-tab-updates"></a>タブの更新に関する通知の送信

多くの場合、更新またはユーザー アクションがタブで発生するたびにエンド ユーザーに通知する必要があります。たとえば、タスクまたはチケットを仲間のチーム メンバーに割り当て、そのチーム メンバーに通知するシナリオの例を示します。

このシナリオを実現するには、次の 2 つの方法があります。

1. チャネル全体に通知する場合、ボットはチャネルにメッセージを非同期的に投稿できます。 ボットがタブを使用して作成されなかった場合、ボットが事前にタブ会話を作成する方法はありません。

2. アクションに関与する受信者または利害関係者にのみ通知する場合は、ボットからユーザーに個人用チャット メッセージを送信できます。 最初に、ボットとユーザー間の個人的な会話が存在するかどうかを確認する必要があります。 そうでない場合は、パーソナル チャットを開始するために呼び出 `CreateConversation` すことができます。

どちらの場合も、イベント通知を賢く使用し、不要な更新でユーザーをスパムすることはありません。
