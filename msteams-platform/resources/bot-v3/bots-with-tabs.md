---
title: ボットとタブの統合
description: タブと bot を一緒に使用する方法について説明します。
keywords: teams の bot タブの開発
ms.date: 03/15/2018
ms.openlocfilehash: 59ae8bc01f82c70dd7ea6869cb870e26acae1293
ms.sourcegitcommit: 4329a94918263c85d6c65ff401f571556b80307b
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/01/2020
ms.locfileid: "41674919"
---
# <a name="combine-bots-with-tabs"></a>ボットとタブの統合

[!include[v3-to-v4-SDK-pointer](~/includes/v3-to-v4-pointer-bots.md)]

Bot とタブはうまく連動しており、多くの場合1つのバックエンドサービスに統合されています。 このセクションでは、タブとボットを一緒に使用するためのベストプラクティスと一般的なパターンについて説明します。

## <a name="associating-user-identities-across-bot-and-tab"></a>Bot とタブの間のユーザー id の関連付け

たとえば、タブアプリケーションが独自の ID システムを使用してそのコンテンツを保護しているとします。 ユーザーとの対話が可能な bot もあるとします。 通常、表示ユーザーに固有のタブにコンテンツを表示する必要があります。 課題は、システム内のユーザー ID が Microsoft Teams のユーザー ID と異なる可能性があるということです。 これら2つの id を関連付けるには、どうすればよいですか。
通常、推奨される方法は、タブのコンテンツに認証を提供するために使用されているものと同じ id システムを使用して、ユーザーを bot で署名することです。 これは、通常、OAuth フローを使用してユーザーにログインする、サインインアクションによって実装できます。

このフローは、id プロバイダーが OAuth 2.0 プロトコルを実装している場合に最適に機能します。 その後、Teams のユーザー ID を、独自の id サービスからのユーザーの資格情報に関連付けることができます。

   ![Id の関連付け](~/assets/images/bots/associating_contexts.png)

## <a name="constructing-deep-links-to-tabs-in-messages-from-your-bot"></a>Bot からのメッセージ内のタブへの詳細なリンクの構築

タブを使用して、カード内に収まる数より多くのコンテンツを表示したり、タブキャンバスを使用して、複雑なフォーム入力タスクを完了する方法を提供したりできます。 たとえば、ユーザーが bot からカードをクリックしたときにタブに移動することを検討します。 これを行うには、ボットのメッセージをエンコードして、マークアップ経由で、または openUrl アクションの対象として[ディープリンク](~/concepts/build-and-test/deep-links.md)URL を含める必要があります。

ディープリンクは、entityId に依存します。この値は、システム内の一意のエンティティにマッピングされる不透明な値です。 タブが作成されると、チャネル内でタブが作成されたことを示す単純な状態 (たとえば、フラグ) をバックエンドに格納するのが理想的です。 Bot がメッセージを作成するとき、そのタブに関連付けられている entityId を対象とすることができます。

**注:** 個人用チャットでは、タブは "静的" であり、アプリと共にインストールされるため、常にその存在を想定して、それに応じて深いリンクを作成できます。

## <a name="sending-notifications-for-tab-updates"></a>タブ更新の通知の送信

タブ内で更新またはユーザー操作が発生するたびに、エンドユーザーに通知する必要があります。シナリオの例としては、チームメンバーにタスクまたはチケットを割り当てて、そのチームメンバーに通知します。

このシナリオを実現するには、次の2つの方法があります。

1. チャネル全体に通知する場合は、ボットがメッセージをチャネルに非同期で送信できるようにする必要があります。 タブを使用して作成されていない場合、ボットが事前にタブの会話を作成する方法はありません。

2. このアクションに関係する受信者または関係者にのみ通知する場合、ボットはユーザーに対して個人のチャットメッセージを送信することができます。 最初に、bot とユーザーの間の個人用会話が存在するかどうかを確認します。 それ以外の場合は、 `CreateConversation`を呼び出して、パーソナルチャットを開始することができます。

どちらの場合も、イベント通知を慎重に使用して、不要な更新をユーザーにスパムしないようにします。
